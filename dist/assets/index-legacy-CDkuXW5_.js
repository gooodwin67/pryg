!function(){function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(t){if(null!=t){var a=t["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],s=0;if(a)return a.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length))return{next:function(){return t&&s>=t.length&&(t=void 0),{value:t&&t[s++],done:!t}}}}throw new TypeError(e(t)+" is not iterable")}function a(e){return function(e){if(Array.isArray(e))return m(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||u(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=a){var s,i,n,o,r=[],l=!0,h=!1;try{if(n=(a=a.call(e)).next,0===t){if(Object(a)!==a)return;l=!1}else for(;!(l=(s=n.call(a)).done)&&(r.push(s.value),r.length!==t);l=!0);}catch(e){h=!0,i=e}finally{try{if(!l&&null!=a.return&&(o=a.return(),Object(o)!==o))return}finally{if(h)throw i}}return r}}(e,t)||u(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var e,t,a="function"==typeof Symbol?Symbol:{},s=a.iterator||"@@iterator",o=a.toStringTag||"@@toStringTag";function r(a,s,i,o){var r=s&&s.prototype instanceof h?s:h,d=Object.create(r.prototype);return n(d,"_invoke",function(a,s,i){var n,o,r,h=0,d=i||[],p=!1,c={p:0,n:0,v:e,a:u,f:u.bind(e,4),d:function(t,a){return n=t,o=0,r=e,c.n=a,l}};function u(a,s){for(o=a,r=s,t=0;!p&&h&&!i&&t<d.length;t++){var i,n=d[t],u=c.p,m=n[2];a>3?(i=m===s)&&(r=n[(o=n[4])?5:(o=3,3)],n[4]=n[5]=e):n[0]<=u&&((i=a<2&&u<n[1])?(o=0,c.v=s,c.n=n[1]):u<m&&(i=a<3||n[0]>s||s>m)&&(n[4]=a,n[5]=s,c.n=m,o=0))}if(i||a>1)return l;throw p=!0,s}return function(i,d,m){if(h>1)throw TypeError("Generator is already running");for(p&&1===d&&u(d,m),o=d,r=m;(t=o<2?e:r)||!p;){n||(o?o<3?(o>1&&(c.n=-1),u(o,r)):c.n=r:c.v=r);try{if(h=2,n){if(o||(i="next"),t=n[i]){if(!(t=t.call(n,r)))throw TypeError("iterator result is not an object");if(!t.done)return t;r=t.value,o<2&&(o=0)}else 1===o&&(t=n.return)&&t.call(n),o<2&&(r=TypeError("The iterator does not provide a '"+i+"' method"),o=1);n=e}else if((t=(p=c.n<0)?r:a.call(s,c))!==l)break}catch(t){n=e,o=1,r=t}finally{h=1}}return{value:t,done:p}}}(a,i,o),!0),d}var l={};function h(){}function d(){}function p(){}t=Object.getPrototypeOf;var c=[][s]?t(t([][s]())):(n(t={},s,function(){return this}),t),u=p.prototype=h.prototype=Object.create(c);function m(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,p):(e.__proto__=p,n(e,o,"GeneratorFunction")),e.prototype=Object.create(u),e}return d.prototype=p,n(u,"constructor",p),n(p,"constructor",d),d.displayName="GeneratorFunction",n(p,o,"GeneratorFunction"),n(u),n(u,o,"Generator"),n(u,s,function(){return this}),n(u,"toString",function(){return"[object Generator]"}),(i=function(){return{w:r,m:m}})()}function n(e,t,a,s){var i=Object.defineProperty;try{i({},"",{})}catch(e){i=0}n=function(e,t,a,s){function o(t,a){n(e,t,function(e){return this._invoke(t,a,e)})}t?i?i(e,t,{value:a,enumerable:!s,configurable:!s,writable:!s}):e[t]=a:(o("next",0),o("throw",1),o("return",2))},n(e,t,a,s)}function o(e,t,a,s,i,n,o){try{var r=e[n](o),l=r.value}catch(e){return void a(e)}r.done?t(l):Promise.resolve(l).then(s,i)}function r(e){return function(){var t=this,a=arguments;return new Promise(function(s,i){var n=e.apply(t,a);function r(e){o(n,s,i,r,l,"next",e)}function l(e){o(n,s,i,r,l,"throw",e)}r(void 0)})}}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h(e,t){for(var a=0;a<t.length;a++){var s=t[a];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,p(s.key),s)}}function d(e,t,a){return t&&h(e.prototype,t),a&&h(e,a),Object.defineProperty(e,"prototype",{writable:!1}),e}function p(t){var a=function(t,a){if("object"!=e(t)||!t)return t;var s=t[Symbol.toPrimitive];if(void 0!==s){var i=s.call(t,a||"default");if("object"!=e(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===a?String:Number)(t)}(t,"string");return"symbol"==e(a)?a:a+""}function c(e,t){var a="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!a){if(Array.isArray(e)||(a=u(e))||t&&e&&"number"==typeof e.length){a&&(e=a);var s=0,i=function(){};return{s:i,n:function(){return s>=e.length?{done:!0}:{done:!1,value:e[s++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,o=!0,r=!1;return{s:function(){a=a.call(e)},n:function(){var e=a.next();return o=e.done,e},e:function(e){r=!0,n=e},f:function(){try{o||null==a.return||a.return()}finally{if(r)throw n}}}}function u(e,t){if(e){if("string"==typeof e)return m(e,t);var a={}.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?m(e,t):void 0}}function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,s=Array(t);a<t;a++)s[a]=e[a];return s}System.register(["./three-legacy-0xSQkSbl.js"],function(n,o){"use strict";var h,p,u,m,b,g,f,y,v,x,_,w,k,j,P,M,D,C,S,z,L,A,E,T,B,H,R,F,I,N,G,q,U,Y,W,O,V,K,J,X,Q,Z,$,ee,te,ae,se,ie,ne,oe,re,le,he,de,pe,ce,ue,me,be,ge,fe,ye,ve;return{setters:[function(e){h=e.B,p=e.a,u=e.P,m=e.N,b=e.b,g=e.c,f=e.C,y=e.M,v=e.d,x=e.V,_=e.e,w=e.f,k=e.g,j=e.W,P=e.Q,M=e.h,D=e.i,C=e.j,S=e.G,z=e.E,L=e.k,A=e.D,E=e.S,T=e.l,B=e.m,H=e.I,R=e.n,F=e.o,I=e.p,N=e.O,G=e.R,q=e.q,U=e.r,Y=e.s,W=e.A,O=e.t,V=e.u,K=e.v,J=e.w,X=e.x,Q=e.y,Z=e.H,$=e.z,ee=e.F,te=e.L,ae=e.J,se=e.T,ie=e.K,ne=e.U,oe=e.X,re=e.Y,le=e.Z,he=e._,de=e.$,pe=e.a0,ce=e.a1,ue=e.a2,me=e.a3,be=e.a4,ge=e.a5,fe=e.a6,ye=e.a7,ve=e.a8}],execute:function(){var n,xe=document.createElement("style");xe.textContent="@font-face{font-display:swap;font-family:Nunito Sans;font-style:normal;font-weight:400;src:url("+new URL("../fonts/nunito-sans-v18-cyrillic_latin-regular.woff2",o.meta.url).href+') format("woff2")}@font-face{font-display:swap;font-family:Nunito Sans;font-style:normal;font-weight:800;src:url('+new URL("../fonts/nunito-sans-v18-cyrillic_latin-800.woff2",o.meta.url).href+') format("woff2")}@font-face{font-display:swap;font-family:blackberry;font-style:normal;font-weight:400;src:url('+new URL("../fonts/blackberry.woff2",o.meta.url).href+') format("woff2")}:root{--safe-top: env(safe-area-inset-top, 0px);--safe-right: env(safe-area-inset-right, 0px);--safe-bottom: env(safe-area-inset-bottom, 0px);--safe-left: env(safe-area-inset-left, 0px)}html{height:100%;margin:0;padding:0;overflow:hidden;overscroll-behavior:none}body{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-ms-overflow-style:none;scrollbar-width:auto;scrollbar-color:rgba(14,14,24,0) #73747300;-moz-appearance:none!important;scrollbar-width:0px;font-family:Nunito Sans,Tahoma;margin:0;background:#1c1d21;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;-webkit-user-drag:none;width:100%;height:100%;position:relative;overflow:hidden}canvas{position:fixed;top:0;left:0;width:100vw;height:100vh;z-index:-1;object-fit:cover}.players_panels>div{pointer-events:none;padding:3px 10px 6px;border-radius:10px;border:1px solid rgba(255,255,255,.6);background:rgba(0,0,0,.12);backdrop-filter:blur(4px)}.player1_panel{position:absolute;bottom:10px;right:10px}.player2_panel{position:absolute;bottom:10px;left:10px}.player3_panel{position:absolute;top:10px;left:10px}.player1_panel{bottom:max(10px,var(--safe-bottom));right:max(10px,var(--safe-right))}.player2_panel{bottom:max(10px,var(--safe-bottom));left:max(10px,var(--safe-left))}.player3_panel{top:max(10px,var(--safe-top));left:max(10px,var(--safe-left))}.player_panel_out{border:5px solid #fff;background-color:#ccc;width:18px;height:18px;display:flex;align-items:center;justify-content:center;color:#000;padding:6px;text-shadow:none}.player1_panel .player_panel_out{position:absolute;top:50%;transform:translate(-150%,-50%)}.player2_panel .player_panel_out,.player3_panel .player_panel_out{position:absolute;top:50%;right:0;transform:translate(110%,-50%)}.player1_panel .player_panel_top{color:#f2b0b0}.player2_panel .player_panel_top{color:#b0f2b0}.player3_panel .player_panel_top{color:#f4f07a}.player_panel_bottom{display:flex;position:relative}.num_bonus_heart{position:absolute;font-size:10px;left:95%;bottom:12px;color:#e6e6e6}.player_panel_bottom_lives{margin-left:10px;display:flex;align-items:center;min-width:40px}.player_panel_bottom_lives span{width:5px;height:5px;background:red;position:relative;transform:rotate(-45deg) translateY(2px);margin-right:8px;transition:.5s;animation:heart-pop .65s ease-out}.player_panel_bottom_lives span:before,.player_panel_bottom_lives span:after{content:"";position:absolute;width:5px;height:5px;background:red;border-radius:50%}.player_panel_bottom_lives span:before{top:-3.5px;left:0}.player_panel_bottom_lives span:after{left:3.5px;top:0}.mouse_icon_css{width:14px;height:25px;border:2px solid #fff;border-radius:12px;box-shadow:0 0 0 1px #000;background:#fff}.mouse_icon_css:before{content:"";position:absolute;top:3px;left:8px;width:9px;height:13px;background:#2c2c2c;border-radius:9px 1px 1px}@keyframes heart-pop{0%{transform:rotate(-45deg) translateY(2px) scale(0)}60%{transform:rotate(-45deg) translateY(2px) scale(3.3)}to{transform:rotate(-45deg) translateY(2px) scale(1)}}.player_panel_top{font-variant-numeric:tabular-nums;font-weight:800;font-size:22px;text-shadow:0 1px 2px rgba(0,0,0,.8)}.players_panels>div{font-size:14px;font-weight:600;letter-spacing:.02em;color:#fff;text-shadow:0 1px 2px rgba(0,0,0,.8)}.hidden_screen{display:none!important}.main_screen{position:absolute;width:100%;height:100%;background-color:#000;display:flex;flex-direction:column;align-items:center;color:#fff;background:url('+new URL("../images/main.jpg",o.meta.url).href+')no-repeat;background-size:cover;background-position-y:15%;box-sizing:border-box;overflow:auto}.main_screen{position:fixed;top:0;right:0;bottom:0;left:0;display:flex!important;flex-direction:column;justify-content:center;align-items:center;box-sizing:border-box;transform:none!important;left:0!important;top:0!important}.main_screen{overflow-x:hidden;overflow-y:auto;margin-right:.25rem}.main_screen::-webkit-scrollbar-track{border-radius:.125rem;background-color:#d3d3d3}.main_screen::-webkit-scrollbar{width:.25rem;border-radius:.125rem}.main_screen::-webkit-scrollbar-thumb{border-radius:.125rem;background-color:gray}.main_screen h1{font-size:clamp(2.5rem,10vw + 2vh,11.25rem);text-align:center;font-family:blackberry,Tahoma;letter-spacing:-.02em;color:#f76951;line-height:.85;max-width:95vw;margin:max(.5rem,env(safe-area-inset-top,0px) * .5) auto clamp(1rem,4vh,3rem);word-wrap:break-word;text-shadow:.04em .04em .02em rgba(255,255,255,.9),-.03em -.03em .02em rgba(255,255,255,.9)}@media (max-height: 600px){.main_screen{justify-content:flex-start}.main_screen h1{font-size:clamp(1.8rem,8vw + 1vh,3.5rem)}}@media (min-height: 900px){.main_screen h1{margin-top:max(1rem,env(safe-area-inset-top,0px) * .7)}}@media (min-width: 1025px){.main_screen:after{content:"";display:block;width:1px;height:16vh;flex-shrink:0}}@media (max-width: 1024px){.main_screen:after{display:none}}.levels_game_screen_wrap,.free_game_screen_wrap,.levels_game_screen_contest_wrap{position:relative}.levels_game_screen_wrap_top{display:flex;justify-content:space-between;gap:18px}.levels_game_screen_wrap_top_left{flex:1 1 0;max-width:260px;width:auto;display:flex;justify-content:space-between;flex-direction:column}.levels_game_screen_wrap_top_left h3:last-child{justify-self:flex-end}.levels_game_screen_wrap_top_right{flex:1 1 0;max-width:none;width:auto;width:100%;border:1px dotted #1d9585;max-height:90%;color:#666;box-sizing:border-box;font-size:13px;margin-bottom:10px;background:rgba(250,255,212,.5);border:2px solid rgba(255,255,255,.95);border-radius:16px;padding:16px;box-shadow:inset 0 2px rgba(255,255,255,.65)}.levels_game_screen_wrap_top_right span{margin-bottom:10px;display:inline-block}.levels_game_screen_wrap_top_contest{display:flex;justify-content:space-between;gap:18px}.levels_game_screen_wrap_top_left_contest{flex:1 1 0;max-width:260px;width:auto;display:flex;justify-content:space-between;flex-direction:column}.levels_game_screen_wrap_top_left_contest h3:last-child{justify-self:flex-end}.levels_game_screen_wrap_top_right_contest{flex:1 1 0;max-width:none;width:auto;width:100%;border:1px dotted #1d9585;max-height:90%;color:#666;box-sizing:border-box;font-size:13px;margin-bottom:10px;background:rgba(250,255,212,.5);border:2px solid rgba(255,255,255,.95);border-radius:16px;padding:16px;box-shadow:inset 0 2px rgba(255,255,255,.65)}.levels_game_screen_wrap_top_right_contest span{margin-bottom:10px;display:inline-block}.free_game_screen_wrap_top{display:flex;justify-content:space-between;gap:18px}.free_game_screen_wrap_top_left{flex:1 1 0;max-width:none;width:auto;max-width:45%;display:flex;justify-content:space-between;flex-direction:column}.free_game_screen_wrap_top_left h3:last-child{justify-self:flex-end}.free_game_screen_wrap_top_right{flex:1 1 0;max-width:none;width:auto;max-width:47%;width:100%;border:1px dotted #1d9585;max-height:90%;color:#666;box-sizing:border-box;font-size:13px;margin-bottom:10px;background:rgba(250,255,212,.5);border:2px solid rgba(255,255,255,.95);border-radius:16px;padding:16px;box-shadow:inset 0 2px rgba(255,255,255,.65)}.free_game_screen_wrap_top_right span{margin-bottom:10px;display:inline-block}.arrow_back{position:relative;height:5px;width:5px;border:8px solid white;border-color:rgb(255,255,255) rgb(255,255,255) transparent transparent;transform:rotate(-135deg);position:absolute;left:-19px;top:21px}.arrow_back:before,.arrow_back:after{content:"";display:block;position:absolute;height:0;width:0;border:5px solid}.arrow_back:before{border-color:rgb(255,255,255) transparent transparent rgb(255,255,255);display:block;top:-1px;right:0;transform-origin:top right;transform:rotate(45deg)}.arrow_back:after{border-color:transparent rgb(255,255,255) rgb(255,255,255) transparent;top:0;right:-1px;transform-origin:top right;transform:rotate(-45deg)}.main_screen_btns_wrap{display:flex;flex-direction:column;align-items:center;width:100%}.new_game_btn{border:2px solid #6f727d;background:#009aa9;border-radius:15px;max-width:370px;width:100%;height:75px;box-sizing:border-box;margin-bottom:18px;position:relative;cursor:pointer;transition:.3s;align-items:center;justify-content:center;font-size:22px;text-transform:uppercase;font-weight:800;display:flex;flex-direction:column}.new_game_btn span:last-child{font-size:13px;font-weight:400;text-transform:none;opacity:.9}body .blue_btn{background:#009aa9;background:linear-gradient(1deg,#009aa9 1%,#7acad6);border:1px solid #007d8c;box-shadow:0 4px #007d8c}body .yellow_btn{background:#fe9000;background:linear-gradient(1deg,#fe9000 1%,#f7c583);border:1px solid #d96a02;box-shadow:0 4px #d96a02}body .green_btn{background:#4eaf05;background:linear-gradient(1deg,#4eaf05 1%,#95e080);border:1px solid #3d8903;box-shadow:0 4px #3d8903}.new_game_btn:hover{transform:translateY(-2px)}.new_game_btn:active{box-shadow:none;transform:translateY(0)}.free_game_screen{position:absolute;width:100%;height:100%;background-color:#000;display:flex;flex-direction:column;align-items:center;color:#fff;background:url('+new URL("../images/main.jpg",o.meta.url).href+")no-repeat;background-size:cover;background-position-y:15%;box-sizing:border-box}.free_game_screen_wrap{display:flex;align-items:center;flex-direction:column;max-width:550px;width:100%;background:rgba(249,218,180,.95);padding:20px 30px 30px;margin-top:8%;border:2px solid rgba(251,242,227,.9);border-radius:30px}.free_game_screen_wrap .free_game_my_rec span{font-weight:700}.free_game_screen_btns_wrap{display:flex;width:100%}.free_game_btn_wrap{display:flex;flex-direction:column;align-items:flex-start;max-width:47%;width:50%}.free_game_btn_wrap:first-child{padding-right:15px;margin-right:15px;border-right:1px dashed #fff}.free_game_screen h3{font-size:20px;text-transform:uppercase;color:#009aa9;font-family:Nunito Sans;background-color:#009aa9;-webkit-background-clip:text;-webkit-text-fill-color:transparent;-webkit-text-stroke:.2px rgba(255,255,255,1);margin:15px 15px 20px}.free_game_btn{border:2px solid #6f727d;background:#009aa9;border-radius:15px;max-width:300px;width:100%;height:60px;box-sizing:border-box;margin-bottom:15px;position:relative;cursor:pointer;transition:.3s;display:flex;align-items:center;justify-content:center;font-size:19px;text-transform:uppercase;font-weight:800}.free_game_btn:active{box-shadow:none;transform:translateY(0)}.autoriz{display:inline-block;margin:20px 0;line-height:1.3;color:#7a5656}.autoriz>span{border-bottom:1px dotted;font-weight:700}.free_game_chels_wrap{display:flex;justify-content:center;margin-bottom:0}.free_game_chels{width:10px;height:10px;box-shadow:none!important;border:2px solid transparent!important;padding:10px;display:flex;align-items:center;justify-content:center;margin-right:7px;cursor:pointer;border-radius:9px;transition:transform .5s;font-weight:700}body .free_game_chels_active{border:2px solid #ffffff!important;transform:translateY(-2px)}.rec_table_small{width:100%;margin-bottom:5px;background:#fff;border-radius:9px;overflow:hidden}.rec_h_wrap{display:flex;justify-content:center;width:100%;margin-bottom:5px}.rec_h{color:#009aa9;font-size:15px;font-weight:700}.rec_table_small>div>div{display:flex;width:100%;padding:8px 2px;box-sizing:border-box}.rec_table_small span{font-size:14px;color:#686869}.yellow_back{background-color:#fcffc4}.green_back{background-color:#daf9c6}.blue_back{background-color:#f0f8ff}.rec_table_small>div>div>span{display:flex;align-items:center;justify-content:center;padding:0 5px}.rec_table_small_block>div>div{display:flex;align-items:center;justify-content:center;padding:0 3px}.rec_table_small_name{width:100%!important;overflow:hidden;display:inline-block!important;text-overflow:ellipsis;white-space:nowrap}.small_btn{color:#009aa9;font-size:13px;text-decoration:underline;position:relative;top:2px;cursor:pointer}.levels_game_screen{position:absolute;width:100%;height:100%;background-color:#000;display:flex;flex-direction:column;align-items:center;color:#fff;background:url("+new URL("../images/main.jpg",o.meta.url).href+")no-repeat;background-size:cover;background-position-y:15%;box-sizing:border-box}.levels_game_screen_contest{position:absolute;width:100%;height:100%;background-color:#000;display:flex;flex-direction:column;align-items:center;color:#fff;background:url("+new URL("../images/main.jpg",o.meta.url).href+")no-repeat;background-size:cover;background-position-y:15%;box-sizing:border-box}.levels_game_screen_contest .level_player1{background:linear-gradient(180deg,#f57171,#f79d9d);border-color:#f2b0b0;color:#fff}.levels_game_screen_contest .level_player1 .levels_block_number{color:#fff}.levels_game_screen_contest .level_player2{background:linear-gradient(180deg,#6cf46c,#a2f4a2);border-color:#b0f2b0;color:#fff}.levels_game_screen_contest .level_player2 .levels_block_number{color:#fff}.levels_game_screen_contest .level_player3{background:linear-gradient(180deg,#e7e13a,#f3ef82);border-color:#f4f07a;color:#fff}.levels_game_screen_contest .level_player3 .levels_block_number{color:#fff}.contest_game_btn{cursor:pointer;padding:5px 36px;border-radius:8px;border:2px solid rgba(0,0,0,.07)!important;background:linear-gradient(180deg,rgba(255,255,255,.9),rgba(255,255,255,.75))!important;color:#2b4b57;text-shadow:0 1px 0 rgba(255,255,255,.6);transition:transform .15s ease,box-shadow .15s ease;align-self:flex-start;margin-bottom:10px;box-shadow:0 6px rgba(0,0,0,.12),0 6px 22px rgba(0,0,0,.12),inset 0 2px rgba(255,255,255,.55);font-size:14px;color:#777}.levels_game_screen_wrap h3{font-size:20px;text-transform:uppercase;color:#009aa9;font-family:Nunito Sans;background-color:#009aa9;-webkit-background-clip:text;-webkit-text-fill-color:transparent;-webkit-text-stroke:.2px rgba(255,255,255,1);margin:25px 25px 20px;text-align:center}.levels_game_screen_wrap{max-width:550px;width:100%;background:rgba(249,218,180,.95);padding:15px 30px 30px;margin-top:5%;margin-bottom:5%;border:2px solid rgba(251,242,227,.9);border-radius:30px}.level_game_chels_wrap{display:flex;justify-content:center;margin-bottom:20px;border-bottom:1px dashed #fff;padding-bottom:30px}.level_game_chels{width:30px;box-shadow:none!important;border:2px solid transparent!important;padding:10px;display:flex;align-items:center;justify-content:center;margin-right:7px;cursor:pointer;border-radius:9px;transition:transform .5s;font-weight:700}body .level_game_chels_active{border:2px solid #ffffff!important;transform:translateY(-2px)}.level_game_chels_contest{width:30px;box-shadow:none!important;border:2px solid transparent!important;padding:10px;display:flex;align-items:center;justify-content:center;margin-right:7px;cursor:pointer;border-radius:9px;transition:transform .5s;font-weight:700}body .level_game_chels_contest_active{border:2px solid #ffffff!important;transform:translateY(-2px)}.levels_blocks,.levels_blocks_contest{display:grid;grid-template-columns:repeat(auto-fill,minmax(90px,1fr));gap:12px;max-width:480px;margin:0 auto 30px;padding:0 10px 10px}.levels_block{position:relative;border-radius:15px;height:70px;display:flex;flex-direction:column;justify-content:center;align-items:center;user-select:none;cursor:pointer;transition:transform .15s ease,box-shadow .15s ease,filter .15s ease;text-shadow:0 1px 2px rgba(0,0,0,.8);border:1px solid transparent;box-shadow:0 4px 0 transparent}.levels_block_number{font-family:Nunito Sans,Tahoma;font-size:24px;line-height:1;margin-bottom:6px;-webkit-text-stroke:.2px rgba(255,255,255,.9)}.levels_block_status{position:absolute;bottom:6px;left:8px;right:8px;display:flex;justify-content:center;pointer-events:none}.status_chip{font-size:11px;font-weight:800;text-transform:uppercase;padding:4px 8px;border-radius:999px;border:1px solid rgba(255,255,255,.85);backdrop-filter:blur(4px);color:#fff;box-shadow:0 1px 2px rgba(0,0,0,.35)}.status_chip--completed{background:rgba(78,175,5,.75)}.status_chip--available{background:rgba(254,144,0,.75)}.status_chip--locked{background:rgba(60,60,60,.65)}.levels_block--completed{background:linear-gradient(1deg,#4eaf05 1%,#95e080);border:1px solid #3d8903;box-shadow:0 4px #3d8903;color:#fff}.levels_block--available{background:linear-gradient(1deg,#fe9000 1%,#f7c583);border:1px solid #d96a02;box-shadow:0 4px #d96a02;color:#fff}.levels_block--locked{background:linear-gradient(145deg,#3b3b3b,#2a2a2a);border:1px solid #4a4a4a;box-shadow:0 4px #2a2a2a;color:#cfcfcf;cursor:not-allowed;filter:grayscale(.15) saturate(.8)}.levels_block--completed:hover,.levels_block--available:hover{transform:translateY(-2px)}.levels_block--completed:active,.levels_block--available:active{box-shadow:none;transform:translateY(0)}.levels_block.active{outline:2px solid rgba(255,255,255,.9);box-shadow:0 0 10px rgba(255,255,255,.55)}.levels_block{opacity:0;transform:translateY(8px) scale(.96)}.levels_block--enter{animation:level-tile-in .45s cubic-bezier(.2,.8,.2,1) both;animation-delay:var(--show-delay, 0ms)}.levels_block--completed.levels_block--enter,.levels_block--available.levels_block--enter{animation-duration:.42s}.levels_block--locked.levels_block--enter{animation-duration:.5s;filter:grayscale(.2) saturate(.9)}@keyframes level-tile-in{0%{opacity:0;transform:translateY(8px) scale(.96);box-shadow:0 4px 0 transparent}60%{opacity:1;transform:translateY(-2px) scale(1.03)}to{opacity:1;transform:translateY(0) scale(1)}}.levels_blocks--reenter .levels_block,.levels_blocks_contest--reenter .levels_block{opacity:0;transform:translateY(8px) scale(.96)}@media (prefers-reduced-motion: reduce){.levels_block,.levels_block--enter{animation:none!important;opacity:1!important;transform:none!important}}.popup_in_game{position:fixed;top:0;right:0;bottom:0;left:0;width:100%;height:100dvh;display:flex;justify-content:center;align-items:center;padding:max(10px,env(safe-area-inset-top)) 10px max(10px,env(safe-area-inset-bottom));box-sizing:border-box;color:#fff;z-index:900;pointer-events:auto;overflow:hidden}.popup_in_game_wrap{display:flex;flex-direction:column;align-items:center;width:100%;max-width:550px;min-height:225px;max-height:calc(100dvh - 40px);height:auto;overflow-y:auto;overflow-x:hidden;-webkit-overflow-scrolling:touch;overscroll-behavior:contain;background:rgba(249,218,180,.95);padding:30px 30px 24px;border:2px solid rgba(251,242,227,.9);border-radius:30px;background:url("+new URL("../images/back-loose.jpg",o.meta.url).href+") no-repeat;background-size:cover;background-position-y:15%}.popup_in_game_wrap_win{background:url("+new URL("../images/back-win.jpg",o.meta.url).href+')no-repeat!important;background-size:cover!important;background-position-y:15%!important;position:relative}.popup_screen_btns_wrap{display:flex;flex-direction:column;justify-content:center;width:100%;height:100%}.popup_game_btn{border:2px solid #6f727d;background:#009aa9;border-radius:15px;max-width:300px;width:100%;height:60px;box-sizing:border-box;margin-bottom:15px;position:relative;cursor:pointer;transition:.3s;display:flex;align-items:center;justify-content:center;font-size:19px;text-transform:uppercase;font-weight:800}.hud{margin-left:5px;z-index:10;pointer-events:none;font-family:Inter,system-ui,-apple-system,sans-serif}.hud--outline{padding:3px 10px 6px;border-radius:10px;border:1px solid rgba(255,255,255,.6);background:rgba(0,0,0,.12);backdrop-filter:blur(4px)}.hud--stacked{display:flex;flex-direction:column}.hud__top{display:flex;align-items:baseline;gap:6px}.hud__label{font-size:16px;font-weight:600;letter-spacing:.02em;color:#fff;text-shadow:0 1px 2px rgba(0,0,0,.8)}.hud__value{font-variant-numeric:tabular-nums;font-weight:800;font-size:38px;color:#fff;text-shadow:0 1px 2px rgba(0,0,0,.8)}.hud__records{color:#fff;font-size:15px}.hud__record{color:#fff;opacity:.85}.hud__record strong{font-weight:700;color:#fff;min-width:22px;display:inline-block}.hud__record--world strong{color:#e9f082}.hud__records .records_block{display:flex;flex-direction:column}.huds{display:flex;flex-direction:row-reverse;position:fixed;top:20px;right:20px;z-index:10}.huds{position:fixed;top:max(20px,calc(var(--safe-top) + 10px));right:max(20px,calc(var(--safe-right) + 10px));z-index:10}.menu_in_game{padding:5px;border-radius:10px;border:1px solid rgba(255,255,255,.4);display:flex;align-items:flex-start;align-self:flex-start}.sound_btn_wrap{background-color:rgba(255,255,255,.8);padding:5px 10px;border-radius:6px;margin:5px;display:flex;justify-content:center;align-items:center}.pause_btn_wrap{background-color:rgba(255,255,255,.8);padding:5px 10px;border-radius:6px;margin:5px;display:flex;justify-content:center;align-items:center;background:linear-gradient(1deg,#4eaf05 1%,#95e080);border:1px solid #3d8903;box-shadow:0 4px #3d8903;height:100%;cursor:pointer}#nav-icon3{width:30px;height:30px;position:relative;-webkit-transform:rotate(0deg);-moz-transform:rotate(0deg);-o-transform:rotate(0deg);transform:rotate(0);-webkit-transition:.5s ease-in-out;-moz-transition:.5s ease-in-out;-o-transition:.5s ease-in-out;transition:.5s ease-in-out;cursor:pointer;transition:.5s}#nav-icon3 span{display:block;position:absolute;height:5px;width:100%;background:#fff;border-radius:9px;opacity:1;left:0;-webkit-transform:rotate(0deg);-moz-transform:rotate(0deg);-o-transform:rotate(0deg);transform:rotate(0);-webkit-transition:.25s ease-in-out;-moz-transition:.25s ease-in-out;-o-transition:.25s ease-in-out;transition:.25s ease-in-out}#nav-icon3 span:nth-child(1){transition:.5s;top:3px}#nav-icon3 span:nth-child(2){transition:.5s;top:13px}#nav-icon3 span:nth-child(3){transition:.5s;top:23px}#nav-icon3.open span:nth-child(1){transition:.5s;top:18px;width:0%;left:50%}#nav-icon3.open span:nth-child(2){-webkit-transform:rotate(45deg);-moz-transform:rotate(45deg);-o-transform:rotate(45deg);transform:rotate(45deg)}#nav-icon3.open span:nth-child(3){-webkit-transform:rotate(-45deg);-moz-transform:rotate(-45deg);-o-transform:rotate(-45deg);transform:rotate(-45deg)}#nav-icon3.open span:nth-child(4){top:18px;width:0%;left:50%}.sound_btn_wrap{background:linear-gradient(1deg,#009aa9 1%,#7acad6);border:1px solid #007d8c;box-shadow:0 4px #007d8c;cursor:pointer}.volume-icon{position:relative;cursor:pointer;border-radius:60%}.volume-icon__input{display:none}.volume-icon__input+svg{display:block;fill:none;stroke:#fff;stroke-linecap:round;stroke-linejoin:round;stroke-width:9px;width:30px;height:30px}.volume-icon__input+svg path{--duration: .5s;animation:var(--name) var(--duration) ease forwards}.volume-icon__input+svg path:nth-child(2){stroke-dashoffset:1px}.volume-icon__input+svg path:nth-child(3){stroke-dashoffset:1px}.volume-icon__input.volume_off+svg path:nth-child(1){--name: shape}.volume-icon__input.volume_off+svg path:nth-child(2){--name: small}.volume-icon__input.volume_off+svg path:nth-child(3){--name: large}.volume-icon__input+svg path:nth-child(1){--name: shape-r}.volume-icon__input+svg path:nth-child(2){--name: small-r}.volume-icon__input+svg path:nth-child(3){--name: large-r}@keyframes small{0%,30%{stroke-dasharray:0 0 30px 64px}40%{stroke-dashoffset:16px}80%,to{stroke-dashoffset:1px}70%{stroke-dasharray:0 43px 30px 64px}to{stroke-dasharray:0 39px 30px 64px}}@keyframes small-r{0%{stroke-dasharray:0 39px 30px 64px}0%,40%{stroke-dashoffset:1px}70%{stroke-dashoffset:16px}70%,to{stroke-dasharray:0 0 30px 64px}}@keyframes large{0%,30%{stroke-dasharray:0 0 50px 84px}40%{stroke-dashoffset:16px}80%,to{stroke-dashoffset:1px}70%{stroke-dasharray:0 82px 32px 84px}to{stroke-dasharray:0 78px 32px 84px}}@keyframes large-r{0%{stroke-dasharray:0 78px 32px 84px}0%,40%{stroke-dashoffset:1px}70%{stroke-dashoffset:16px}70%,to{stroke-dasharray:0 0 50px 84px}}@keyframes shape{0%{stroke-dasharray:60px 0 184px;stroke-dashoffset:0}70%{stroke-dasharray:63px 51px 184px;stroke-dashoffset:21px}to{stroke-dasharray:59px 47px 184px;stroke-dashoffset:17px}}@keyframes shape-r{0%{stroke-dasharray:59px 47px 184px;stroke-dashoffset:17px}to{stroke-dasharray:60px 0 184px;stroke-dashoffset:0}}.level_hud_wrap{border-radius:6px;margin:5px 5px 0;justify-content:center;align-items:center;background:linear-gradient(1deg,#fe9000 1%,#ffb24d);border:1px solid #d96a02;box-shadow:0 4px #d96a02;height:41px;display:flex;flex-direction:column;padding:0 4px;width:45px}.lev_hud{display:flex;flex-direction:row;align-items:center;justify-content:center;line-height:.9;color:#fff}.lev_hud span{font-weight:400;font-size:12px;line-height:0;font-weight:700;font-size:25px}@media (max-width: 1024px){.level_hud_wrap{margin-top:0;height:30px;padding:0;width:40px}.lev_hud span{font-size:20px}.huds{top:5px;right:5px}.hud{margin-left:5px}.pause_btn_wrap{margin:0}.volume-icon__input+svg{width:20px;height:20px}#nav-icon3{width:20px;height:20px}#nav-icon3 span{height:3px}.menu_in_game{border:none;padding:0}.sound_btn_wrap{margin:0 5px 0 0}#nav-icon3 span:nth-child(1){top:2px}#nav-icon3 span:nth-child(2){top:9px}#nav-icon3 span:nth-child(3){top:16px}.hud{top:5px;right:5px}.menu_in_game{right:110px;top:5px}.player1_panel{bottom:5px;right:5px}.player2_panel{bottom:5px;left:5px}.player3_panel{top:5px;left:5px}.hud__value{font-size:20px}.hud__records{font-size:12px}.hud__label{font-size:13px}.hud--outline{padding:3px 6px}.player_panel_top{font-size:15px}.players_panels>div{font-size:12px}.player1_panel .player_panel_out{background-color:#f2b0b0}.player2_panel .player_panel_out{background-color:#b0f2b0}.player3_panel .player_panel_out{background-color:#f4f07a}.player_panel_out{border-radius:50%}.player_panel_out{width:15px;height:15px}.player_panel_out span{display:none}.main_screen h1{margin-top:4%;margin-bottom:2%;font-size:90px;padding:0}.new_game_btn{height:55px;font-size:16px;max-width:300px}.free_game_btn{height:50px;font-size:17px}.free_game_screen_wrap{padding-top:0;margin:3%}.free_game_chels_wrap{margin-bottom:0}.free_game_chels{padding:5px}.popup_in_game_wrap{max-width:500px;max-height:calc(100dvh - 24px);padding:20px 20px 18px;margin:0}}.free_game_screen_wrap{background:rgba(249,218,180,.92);border:2px solid rgba(251,242,227,.95);border-radius:26px;box-shadow:0 16px 40px rgba(0,0,0,.18),inset 0 2px rgba(255,255,255,.55)}.free_game_screen_wrap h3{position:relative;display:inline-flex;align-items:center;gap:10px;margin:0 0 10px;padding:0;border-radius:999px;font-family:Nunito Sans,Tahoma;font-size:20px;letter-spacing:.06em;text-transform:uppercase;background:linear-gradient(90deg,rgba(24,27,72,.63),#00dca8) text;-webkit-text-fill-color:transparent;-webkit-text-stroke:0px;text-shadow:none;font-weight:800;white-space:nowrap}.free_game_chels_wrap{background:rgba(255,255,255,.55);border:2px solid rgba(255,255,255,.9);border-radius:12px;padding:6px;gap:6px;display:inline-flex;box-shadow:inset 0 2px rgba(255,255,255,.65);width:100%;box-sizing:border-box}.free_game_chels{width:auto;min-width:42px;height:55px;margin:0;padding:0 12px;border-radius:8px;border:2px solid rgba(0,0,0,.07)!important;background:linear-gradient(180deg,rgba(255,255,255,.9),rgba(255,255,255,.75))!important;color:#2b4b57;text-shadow:0 1px 0 rgba(255,255,255,.6);transition:transform .15s ease,box-shadow .15s ease}.free_game_chels:hover{transform:translateY(-1px)}.free_game_chels_active{border-color:#fff!important;background:linear-gradient(180deg,#b7fff1,#7cefe0)!important;box-shadow:0 4px 12px rgba(0,200,180,.25);color:#075f55}.free_game_screen_btns_wrap{gap:18px}.free_game_btn_wrap{flex:1 1 0;max-width:none;width:auto;align-items:stretch;background:rgba(255,255,255,.5);border:2px solid rgba(255,255,255,.85);border-radius:16px;padding:16px;box-shadow:inset 0 2px rgba(255,255,255,.65)}.free_game_btn_wrap:first-child{border-right-color:rgba(255,255,255,.85)}.free_game_btn{height:58px;border-radius:16px;font-size:18px;letter-spacing:.03em;color:#fff;border:2px solid rgba(0,0,0,.08);box-shadow:0 8px rgba(0,0,0,.12),0 8px 18px rgba(0,0,0,.15);text-shadow:0 2px 0 rgba(0,0,0,.18)}.free_game_btn:hover{transform:translateY(-2px)}.free_game_btn:active{transform:translateY(0);box-shadow:0 4px rgba(0,0,0,.14)}.free_game_btn.green_btn{background:linear-gradient(180deg,#62c217,#4eaf05);border-color:#3e9204}.free_game_btn.yellow_btn{background:linear-gradient(180deg,#ffa63a,#fe9000);border-color:#d77307}.rec_h_wrap{margin:10px 0 8px}.rec_h{color:#1a8895;font-weight:800;font-size:13px;letter-spacing:.06em;text-transform:uppercase;opacity:.95}.rec_table_small{background:rgba(255,255,255,.9);border:2px solid rgba(255,255,255,.95);border-radius:12px;overflow:hidden;box-shadow:inset 0 1px rgba(0,0,0,.04)}.rec_table_small>div>div{padding:10px 7px;border-bottom:1px dashed rgba(0,0,0,.06)}.rec_table_small>div>div:last-child{border-bottom:0}.rec_table_small>div>div>span:first-child{width:28px;justify-content:flex-start;color:#7e8b90}.rec_table_small_name{color:#2c3a41}.rec_table_small>div>div>div{margin-left:auto;display:flex;gap:4px}.rec_table_small span{font-size:14px;color:#5b6d75}.yellow_back{background-color:#fffbdc}.green_back{background-color:#e8ffd8}.blue_back{background-color:#eef8ff}.free_game_screen_wrap .free_game_my_rec span{font-weight:900}.levels_game_screen_wrap{background:rgba(249,218,180,.92);border:2px solid rgba(251,242,227,.95);border-radius:26px;box-shadow:0 16px 40px rgba(0,0,0,.18),inset 0 2px rgba(255,255,255,.55);padding:26px 28px 24px;display:flex;flex-direction:column;align-items:center}.levels_game_screen_wrap h3{color:#009aa9;font-family:Nunito Sans;background-color:#009aa9;-webkit-background-clip:text;-webkit-text-stroke:.2px rgba(255,255,255,1);position:relative;display:inline-flex;align-items:center;gap:10px;margin:0 0 10px;padding:0;border-radius:999px;font-family:Nunito Sans,Tahoma;font-size:20px;letter-spacing:.06em;text-transform:uppercase;background:linear-gradient(90deg,rgba(24,27,72,.63),#00dca8) text;-webkit-text-fill-color:transparent;-webkit-text-stroke:0px;text-shadow:none;font-weight:800;white-space:nowrap}.level_game_chels_wrap{background:rgba(255,255,255,.55);border:2px solid rgba(255,255,255,.9);border-radius:12px;padding:6px;gap:6px;display:inline-flex;box-shadow:inset 0 2px rgba(255,255,255,.65);border-bottom:none}.level_game_chels{width:auto;min-width:42px;height:55px;margin:0;padding:0 12px;border-radius:8px;border:2px solid rgba(0,0,0,.07)!important;background:linear-gradient(180deg,rgba(255,255,255,.9),rgba(255,255,255,.75))!important;color:#2b4b57;text-shadow:0 1px 0 rgba(255,255,255,.6);transition:transform .15s ease,box-shadow .15s ease}.level_game_chels:hover{transform:translateY(-1px)}.level_game_chels_active{border-color:#fff!important;background:linear-gradient(180deg,#b7fff1,#7cefe0)!important;box-shadow:0 4px 12px rgba(0,200,180,.25);color:#075f55}.level_game_chels_contest{width:auto;min-width:42px;height:55px;margin:0;padding:0 12px;border-radius:8px;border:2px solid rgba(0,0,0,.07)!important;background:linear-gradient(180deg,rgba(255,255,255,.9),rgba(255,255,255,.75))!important;color:#2b4b57;text-shadow:0 1px 0 rgba(255,255,255,.6);transition:transform .15s ease,box-shadow .15s ease}.level_game_chels_contest:hover{transform:translateY(-1px)}.level_game_chels_contest_active{border-color:#fff!important;background:linear-gradient(180deg,#b7fff1,#7cefe0)!important;box-shadow:0 4px 12px rgba(0,200,180,.25);color:#075f55}.levels_blocks,.levels_blocks_contest{gap:14px;max-width:100%;width:100%;margin:0;padding:6px 4px 2px}.levels_block{position:relative;border-radius:18px;border:2px solid rgba(0,0,0,.07);background:linear-gradient(180deg,#fff,#f5f7fa);box-shadow:0 8px rgba(0,0,0,.12),0 10px 22px rgba(0,0,0,.12),inset 0 2px rgba(255,255,255,.55);color:#2c3a41;text-shadow:0 1px 0 rgba(0,0,0,.12);transition:transform .15s ease,box-shadow .15s ease}.levels_block:hover{transform:translateY(-2px)}.levels_block:active{transform:translateY(0);box-shadow:0 4px rgba(0,0,0,.14)}.levels_block_number{font-family:Nunito Sans,Tahoma;color:#fff;-webkit-text-stroke:0;text-shadow:0 1px 0 rgba(255,255,255,.75),0 2px 0 rgba(0,0,0,.06)}.levels_blocks_contest .levels_block_number{color:#b7b7b7}.levels_block_status .status_chip{font-size:11px;font-weight:800;text-transform:uppercase;padding:2px 8px;border-radius:999px;border:none;color:#fff;background:transparent;box-shadow:none}.status_chip--completed{background:#e8ffd8}.status_chip--available{background:#fff5cf}.status_chip--locked{background:#eceff3;color:#8a97a0;border-color:rgba(255,255,255,.85)}.levels_block--completed{background:linear-gradient(180deg,#62c217,#4eaf05);border-color:#3e9204;color:#fff}.levels_block--available{background:linear-gradient(180deg,#ffa63a,#fe9000);border-color:#d77307;color:#fff}.levels_block--locked{background:linear-gradient(180deg,#939393,#5d799b);border-color:#d9dee6;color:#8a97a0;cursor:not-allowed}.levels_block--locked:after{content:"ðŸ”’";position:absolute;top:6px;right:8px;font-size:14px;opacity:.9}.levels_block.active{outline:2px solid rgba(255,255,255,.95);box-shadow:0 0 12px rgba(255,255,255,.55),0 8px rgba(0,0,0,.12)}@media (max-width:1024px){.levels_block_status{bottom:2px}.levels_block_status .status_chip{font-size:10px;font-weight:800;text-transform:uppercase;padding:2px 8px;border-radius:999px;border:none;color:#fff;background:transparent;box-shadow:none}.levels_game_screen_wrap{padding:18px 16px;border-radius:20px;margin-top:3%;margin-bottom:3%}.levels_blocks,.levels_blocks_contest{gap:10px}.levels_block{height:60px}.levels_block_number{font-size:22px}.levels_game_screen h3,.levels_game_screen_contest h3,.free_game_screen_wrap h3{font-size:20px;margin:0 0 8px}.free_game_chels,.level_game_chels,.level_game_chels_contest{min-width:40px}.free_game_btn{width:80%;height:30px;font-size:12px;align-self:center}.rec_h_wrap{display:none}.levels_game_screen_wrap{max-width:550px;margin-top:20px}.level_game_chels_wrap,.levels_block_number{margin-bottom:10px}.rec_table_small span{font-size:12px}.rec_table_small>div>div{padding:5px 12px}.free_game_screen_wrap{margin-top:10px;margin-bottom:5px;padding:10px 30px}.free_game_chels_wrap{margin:0}}.popup_game_btn_close{position:absolute;top:10px;right:15px;font-size:30px}.popup_game_btn_close span:first-child{display:inline-block;transform:rotate(45deg)}.popup_game_btn_close span:last-child{display:inline-block;transform:translate(-10px) rotate(-45deg)}.rec_table_small_block{opacity:1;transform:translateY(0);transition:opacity .25s ease,transform .25s ease}.rec_table_small_block.anim-out{opacity:0;transform:translateY(8px)}.rec_table_small_block.anim-in{opacity:0;transform:translateY(-8px)}.rec_table_small_block.anim-in.anim-play{opacity:1;transform:translateY(0)}.opacity_my-screen{opacity:0;visibility:hidden;pointer-events:none;transition:opacity .3s ease}body{position:fixed;top:0;right:0;bottom:0;left:0;transform:none!important;left:0!important;top:0!important;overflow:hidden;width:100%;height:100%}.main_screen,.free_game_screen,.levels_game_screen,.levels_game_screen_contest{position:fixed;top:0;right:0;bottom:0;left:0;width:100%;height:100dvh;overflow-x:hidden;overflow-y:auto;-webkit-overflow-scrolling:touch;background-attachment:fixed}.scroll-progress{position:fixed;top:8px;right:3px;bottom:8px;width:4px;border-radius:4px;background:rgba(255,255,255,.18);pointer-events:none;z-index:1000;opacity:0;transition:opacity .25s ease}.scroll-progress.visible{opacity:1}.scroll-progress__bar{position:absolute;left:0;width:100%;border-radius:4px;background:rgba(255,255,255,.75);cursor:grab;pointer-events:auto;touch-action:none}.scroll-progress__bar:active{cursor:grabbing}.loader_screen{--color-yellow: #ffed02;--color-light-orange-1: #fece00;--color-light-orange-2: #fcaa1d;--color-orange: #f57a00;--color-blue-1: #FEB885;--color-blue-2: #5ec869;--duck-speed: .8s;--duck-speed-half: calc(var(--duck-speed) / 2);position:fixed;top:0;right:0;bottom:0;left:0;z-index:9999;display:grid;place-content:center;background:var(--color-blue-1);overflow:hidden;overscroll-behavior:contain;touch-action:none}.loader_screen .duck__wrapper{display:grid;place-content:center;margin-top:-15px}.loader_screen .duck{display:flex;flex-direction:column;position:relative}.loader_screen .duck__head{align-self:flex-end;width:6rem;height:4rem;border-radius:8rem 8rem 0 0;background-color:var(--color-yellow);position:relative;transform:translateY(1px);z-index:1}.loader_screen .duck__head:after,.loader_screen .duck__head:before{content:"";position:absolute;border-radius:1rem;background-color:var(--color-yellow);width:.4rem;height:2rem;top:0}.loader_screen .duck__head:after{left:44%;transform:translate(-50%,-50%) rotate(-30deg)}.loader_screen .duck__head:before{left:45%;transform:translate(-50%,-50%) rotate(10deg)}.loader_screen .duck__white{position:absolute;top:.8rem;left:.8rem;width:.6rem;height:1.3rem;transform:rotate(40deg);border-radius:50%;border-left:.2rem solid #fff}.loader_screen .duck__eye{position:absolute;bottom:.2rem;right:1rem;width:.8rem;height:.8rem;border-radius:50%;background-color:#000;animation:eye-animation 1s infinite linear}.loader_screen .duck__eye--shadow{position:absolute;bottom:-.5rem;right:2rem;width:.8rem;height:.8rem;border-radius:50%;background-color:var(--color-light-orange-2);z-index:1}.loader_screen .duck__mouth{position:absolute;right:0;top:40%;width:1rem;height:1.2rem;transform:translate(90%,-50%);clip-path:polygon(0 0,100% 40%,100% 60%,0% 100%);border-radius:0 1rem 1rem 0;background-color:var(--color-orange)}.loader_screen .duck__body{width:9.5rem;height:5rem;border-radius:1rem 0 16rem 16rem;background-color:var(--color-yellow);position:relative;overflow:hidden}.loader_screen .duck__body:after{content:"";position:absolute;width:105%;height:200%;left:50%;top:-95%;transform:translate(-50%,.02rem) rotate(-6deg);border-radius:50%;border-bottom:1rem solid var(--color-light-orange-2)}.loader_screen .duck__wing{position:absolute;left:.6rem;top:55%;width:4rem;height:2.4rem;border-radius:1rem 1rem 4rem 4rem;background-color:var(--color-light-orange-1);transform:translateY(-50%);transform-origin:right;animation:wing-animation var(--duck-speed) linear infinite;z-index:1}.loader_screen .duck__foot{position:absolute;width:.6rem;height:2rem;background-color:var(--color-orange);z-index:-1}.loader_screen .duck__foot:after{content:"";position:absolute;width:2rem;height:.6rem;bottom:0;left:-.5rem;background-color:var(--color-orange);border-radius:1rem}.loader_screen .duck__foot--1,.loader_screen .duck__foot--2{left:40%;bottom:0;transform:translate(-50%,80%)}.loader_screen .duck__foot--1{animation:foot-ans var(--duck-speed) linear infinite}.loader_screen .duck__foot--2{animation:foot-ans var(--duck-speed) var(--duck-speed-half) linear infinite}.loader_screen .surface{position:absolute;bottom:-2.4rem;left:55%;transform:translate(-50%);background-color:#fff;width:8rem;height:.7rem;border-radius:1rem;animation:surface-animation var(--duck-speed-half) linear infinite}.loader_screen .surface>.loader_line{position:absolute;background:var(--color-blue-2);box-shadow:0 0 4px #fff;border-radius:1rem;height:100%;width:0%;background:linear-gradient(90deg,#4dffa3,#00c44b);border-radius:999px;box-shadow:0 0 10px rgba(0,255,180,.8);transition:width .8s ease-in-out}.loader_screen .cloud{position:absolute;top:var(--y, 15vh);left:0;width:5rem;height:3rem;border-radius:6rem 6rem 0 1rem;background-color:#fff;transform:translate(var(--x, 0)) scale(var(--scale, 1));animation:cloud-drift var(--dur, 32s) linear infinite;animation-delay:var(--delay, 0s)}.loader_screen .cloud:after{content:"";position:absolute;width:6rem;height:3.5rem;bottom:0;border-radius:6rem 10rem 1rem 0;transform:translate(3rem);background-color:#fff}.loader_screen .cloud:before{content:"";position:absolute;width:4rem;height:3rem;bottom:2rem;border-radius:10rem 10rem 0 0;transform:translate(2rem);background-color:#fff}.loader_screen .cloud--1{--x: 10vw;--y: 18vh;--scale: 1;--dur: 18s;--delay: 0s}.loader_screen .cloud--2{--x: 30vw;--y: 26vh;--scale: .85;--dur: 26s;--delay: 0s}.loader_screen .cloud--3{--x: 55vw;--y: 12vh;--scale: 1.15;--dur: 32s;--delay: 0s}.loader_screen .cloud--4{--x: 80vw;--y: 20vh;--scale: .9;--dur: 22s;--delay: 0s}@keyframes surface-animation{0%,to{transform:translate(-50%) scaleX(.9)}50%{transform:translate(-50%) scaleX(1)}}@keyframes foot-ans{0%{transform:translate(-50%,80%) rotate(0)}10%{transform:translate(-150%,80%) rotate(10deg)}20%{transform:translate(-150%,10%) rotate(10deg)}40%{transform:translate(400%,10%) rotate(-20deg)}60%{transform:translate(600%,60%) rotate(-20deg)}70%{transform:translate(500%,60%) rotate(0)}}.loader_screen .duck__inner{animation:bird-up-down var(--duck-speed-half) linear infinite}@keyframes bird-up-down{0%,to{transform:translateY(.4rem)}50%{transform:translateY(0)}}@keyframes wing-animation{0%,to{transform:translateY(-50%) rotate(16deg)}50%{transform:translateY(-50%) rotate(-2deg)}}@keyframes eye-animation{0%,20%{transform:scaleY(1)}10%{transform:scaleY(0)}}@keyframes cloud-drift{0%{transform:translate(var(--x)) scale(var(--scale))}to{transform:translate(calc(var(--x) - 40vw)) scale(var(--scale))}}.loader_screen .surface span{font-size:26px;padding-top:14px;position:absolute;color:#fff;font-weight:700}.lang-toggle{position:relative;width:60px;height:30px;background-color:rgba(255,255,255,.25);backdrop-filter:blur(0px);border-radius:20px;padding:4px;cursor:pointer;z-index:100}.lang-toggle img{position:absolute;top:4px;width:30px;height:30px;border-radius:50%;object-fit:cover;transition:all .2s ease-in-out}.lang-toggle img.ru{left:4px}.lang-toggle img.us{left:34px;transform:rotate(360deg)}.noselect{-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;-webkit-user-drag:none}#lang-toggle{position:fixed;bottom:20px;left:20px;z-index:1001}.popup_game_btn1 span:first-child{padding-left:35px;position:relative}.popup_game_btn1 span:first-child:before{content:"";position:absolute;width:31px;height:22px;top:45%;left:0;transform:translateY(-50%);background:url('+new URL("../images/ad-icon.png",o.meta.url).href+') no-repeat}.popup_game_btn1 span:last-child{--heart-size: 1em;--heart-color: #ff4d94;display:inline-block;width:var(--heart-size);height:var(--heart-size);background:var(--heart-color);position:relative;transform-origin:center;vertical-align:middle;margin-left:.5em;animation:heartBeat1 1s ease-in-out infinite}.popup_game_btn1 span:last-child:before,.popup_game_btn1 span:last-child:after{content:"";position:absolute;width:var(--heart-size);height:var(--heart-size);background:var(--heart-color);border-radius:50%}.popup_game_btn1 span:last-child:before{top:calc(var(--heart-size) * -.5);left:0}.popup_game_btn1 span:last-child:after{top:0;left:calc(var(--heart-size) * .5)}@keyframes heartBeat1{0%,to{transform:rotate(-43deg) scale(1)}50%{transform:rotate(-43deg) scale(1.15)}}.levels_block--super{position:relative;border:2px solid #FFD700;background:linear-gradient(135deg,#1a1a2e,#16213e,#0f3460);box-shadow:0 0 20px rgba(255,215,0,.35);overflow:visible;z-index:0}.levels_block--super .levels_block_number{color:gold;font-weight:800;font-size:26px;text-shadow:0 0 10px rgba(255,215,0,.8)}.levels_block--super:before{content:"";position:absolute;top:-2px;right:-2px;bottom:-2px;left:-2px;border-radius:inherit;pointer-events:none;box-shadow:0 0 22px gold,0 0 44px gold,0 0 72px gold;transform:scale(1);transform-origin:50% 50%;animation:superGlow 1.6s ease-in-out infinite;will-change:opacity,transform,filter}@keyframes superGlow{0%,to{opacity:.55;filter:blur(.4px);transform:scale(1)}50%{opacity:1;filter:blur(1.2px);transform:scale(1.07)}}.level_reward_icon{position:absolute;top:0;right:0;font-size:14px;animation:heartBeat 1s ease-in-out infinite;filter:drop-shadow(0 0 5px #ff4d94);pointer-events:none;z-index:3}@keyframes heartBeat{0%,to{transform:scale(1)}50%{transform:scale(1.45)}}.levels_block--locked:after{content:"ðŸ”’";position:absolute;top:6px;left:10px;font-size:14px;opacity:.9;z-index:4}.hidden_screen,.main_screen.hidden_screen,.free_game_screen.hidden_screen,.levels_game_screen.hidden_screen,.levels_game_screen_contest.hidden_screen,.popup_in_game.hidden_screen,.hud.hidden_screen,.menu_in_game.hidden_screen,.player_panel.hidden_screen{display:none!important;opacity:0!important;visibility:hidden!important;pointer-events:none!important;transform:none!important;position:absolute!important;left:-9999px!important}*{-webkit-tap-highlight-color:transparent!important;-webkit-touch-callout:none!important;-webkit-user-select:none!important;-moz-user-select:none!important;-ms-user-select:none!important;user-select:none!important;-webkit-user-drag:none!important;user-drag:none!important;touch-action:manipulation!important}.new_game_btn,.free_game_btn,.free_game_chels,.level_game_chels,.level_game_chels_contest,.levels_block,.contest_game_btn,.popup_game_btn,.arrow_back,.lang-toggle,.sound_btn_wrap,.pause_btn_wrap,.player_panel_out{-webkit-tap-highlight-color:transparent;touch-action:manipulation;user-select:none;-webkit-user-drag:none}canvas{-webkit-tap-highlight-color:transparent;touch-action:none!important;user-select:none!important}img{-webkit-user-drag:none!important;user-drag:none!important;pointer-events:none}.lang-toggle img{pointer-events:auto}.player_panel,.hud,.menu_in_game{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}@media screen and (max-device-width: 1024px){body{-webkit-text-size-adjust:none;-moz-text-size-adjust:none;-ms-text-size-adjust:none;text-size-adjust:none}#lang-toggle{bottom:10px;left:10px}}.status_chip,.levels_block_number{-webkit-user-select:none;user-select:none}@media (hover: none){*{cursor:default!important}}.autoriz{margin:25px 0}.auth_card{display:flex;align-items:center;gap:12px;padding:10px 12px;border-radius:10px;background:linear-gradient(180deg,rgba(255,255,255,.95),rgba(255,255,255,.85));border:2px solid rgba(255,255,255,.95);box-shadow:inset 0 2px rgba(255,255,255,.55),0 8px 20px rgba(0,0,0,.08)}.auth_text{display:flex;flex-direction:column;line-height:1.15}.auth_text span{color:#5b6d75;font-size:13px;opacity:.95}.auth_btn{margin-left:auto;padding:7px 11px;border-radius:10px;box-sizing:border-box;margin-bottom:0;position:relative;cursor:pointer;transition:.3s;align-items:center;justify-content:center;font-size:12px;text-transform:uppercase;font-weight:400;background:#009aa9;background:linear-gradient(1deg,#009aa9 1%,#7acad6);border:1px solid #007d8c;box-shadow:0 4px #007d8c;color:#fff}.auth_btn:hover{transform:translateY(-2px)}.auth_btn:active{transform:translateY(0);box-shadow:0 4px rgba(0,0,0,.14)}@media (max-width: 1024px){.auth_text strong{font-size:13px}.auth_text span{font-size:12px}.auth_btn{padding:8px 12px;font-size:12px}}.rec_table_small_name{flex:1 1 100%;max-width:130px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;display:inline-block;text-align:left}.rec_table_small>div>div{display:grid;grid-template-columns:30px 1fr 50px;align-items:center;gap:6px}html,body{height:100%;margin:0;padding:0;overscroll-behavior:none}body{position:fixed;top:0;right:0;bottom:0;left:0;width:100%;height:100%;overflow:hidden!important;transform:none!important;left:0!important;top:0!important}.scrollable{overflow-y:auto;overflow-x:hidden;-webkit-overflow-scrolling:touch;overscroll-behavior:contain}canvas{overflow-y:auto;overflow-x:hidden;-webkit-overflow-scrolling:touch;overscroll-behavior:contain;-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.popup_in_game{overflow:hidden;-webkit-overflow-scrolling:auto;overscroll-behavior:contain;-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.main_screen,.free_game_screen,.levels_game_screen,.levels_game_screen_contest{-ms-overflow-style:none;scrollbar-width:none}.main_screen::-webkit-scrollbar,.free_game_screen::-webkit-scrollbar,.levels_game_screen::-webkit-scrollbar,.levels_game_screen_contest::-webkit-scrollbar{width:0;height:0;display:none}.testt{position:absolute;left:0;top:0;z-index:99999;font-size:40px}.debug_error_overlay{position:fixed;top:0;right:0;bottom:0;left:0;z-index:10000;background:rgba(0,0,0,.8);color:#ff8080;font-family:monospace;font-size:14px;padding:20px;box-sizing:border-box;white-space:pre-wrap;overflow:auto}\n/*$vite$:1*/',document.head.appendChild(xe);var _e=function(e,t,a){var s=Promise.resolve();function i(e){var t=new Event("vite:preloadError",{cancelable:!0});if(t.payload=e,window.dispatchEvent(t),!t.defaultPrevented)throw e}return s.then(function(t){var a,s=c(t||[]);try{for(s.s();!(a=s.n()).done;){var n=a.value;"rejected"===n.status&&i(n.reason)}}catch(o){s.e(o)}finally{s.f()}return e().catch(i)})};function we(e,t){return Math.random()*(t-e)+e}function ke(e){return e.reduce(function(e,t){return e|1<<t},0)}function je(e,t){return"0x"+((65535&ke(e))<<16|65535&ke(t)).toString(16).padStart(8,"0")}function Pe(e){var t=e.collisionGroups(),a=65535&t;function s(e){for(var t=[],a=0;a<16;a++)e&1<<a&&t.push(a);return t}return[s(t>>>16&65535),s(a)]}function Me(e){var t,a,s;return null!==(t=null!==(a=null==e||null===(s=e.userData)||void 0===s?void 0:s.id)&&void 0!==a?a:null==e?void 0:e.uuid)&&void 0!==t?t:null==e?void 0:e.id}var De=new _(new x(-.5,-.5,-.5),new x(.5,.5,.5)),Ce=new w,Se=new P;function ze(e){var t,a,s,i,n;if(null!=e&&e.isObject3D){var o;if(e.updateMatrixWorld(!0),null!==(o=e.geometry)&&void 0!==o&&o.isBufferGeometry){var r=e.geometry;if(r.boundingBox||r.computeBoundingBox(),r.boundingBox){var l=r.boundingBox.clone();return l.applyMatrix4(e.matrixWorld),l}}return(new _).setFromObject(e)}var h,d,p,c,u=null!==(t=null!==(a=e.position)&&void 0!==a?a:e.pos)&&void 0!==t?t:new x,m="number"==typeof(h=null!==(s=e.size)&&void 0!==s?s:1)?new x(h,h,h):null!=h&&h.isVector3?h:new x(null!==(d=null==h?void 0:h.x)&&void 0!==d?d:1,null!==(p=null==h?void 0:h.y)&&void 0!==p?p:1,null!==(c=null==h?void 0:h.z)&&void 0!==c?c:1),b=null!==(i=e.quaternion)&&void 0!==i&&i.isQuaternion?e.quaternion:null!==(n=e.rotation)&&void 0!==n&&n.isEuler?Se.setFromEuler(e.rotation):Se.set(0,0,0,1);return Ce.compose(u,b,m),De.clone().applyMatrix4(Ce)}function Le(e,t){for(var a=ze(e),s=Me(e),i=t.length-1;i>=0;i--){var n=t[i],o=Me(n);if(void 0===s||void 0===o||s!==o)if(ze(n).intersectsBox(a))return n}return null}function Ae(e){e.traverse(function(e){var t;null!==(t=e.userData)&&void 0!==t&&t.persistent||(e.geometry&&e.geometry.dispose(),e.material&&(Array.isArray(e.material)?e.material.forEach(function(e){return e.dispose()}):e.material.dispose()),e.material&&e.material.map&&e.material.map.dispose())});var t,a=[],s=c(e.children);try{for(s.s();!(t=s.n()).done;){var i,n=t.value;null!==(i=n.userData)&&void 0!==i&&i.persistent||a.push(n)}}catch(o){s.e(o)}finally{s.f()}a.forEach(function(t){return e.remove(t)})}function Ee(e,t,a,s){var i,n,o;if(e){var r={position:e.position.clone(),quaternion:e.quaternion.clone()},l=[];e.traverse(function(e){(e.isMesh||e.isSkinnedMesh)&&l.push({object3d:e,frustumCulled:e.frustumCulled,visible:e.visible,castShadow:e.castShadow,receiveShadow:e.receiveShadow})});var h=null!==(i=null===(n=t.shadowMap)||void 0===n?void 0:n.enabled)&&void 0!==i&&i;t.shadowMap&&(t.shadowMap.enabled=!1),l.forEach(function(e){var t=e.object3d;t.frustumCulled=!1,t.visible=!0,t.castShadow=!1});var d=a.getWorldDirection(new x).multiplyScalar(2.5),p=a.position.clone().add(d);p.z=a.position.z-1.5,e.position.copy(p),e.updateMatrixWorld(!0),null!==(o=e.userData)&&void 0!==o&&o.mixer&&e.userData.mixer.update(1/60),t.compile(s,a);var c=t.getRenderTarget(),u=new j(1,1,{depthBuffer:!1,stencilBuffer:!1});t.setRenderTarget(u),t.render(s,a),t.setRenderTarget(c),u.dispose(),e.position.copy(r.position),e.quaternion.copy(r.quaternion),l.forEach(function(e){var t=e.object3d,a=e.frustumCulled,s=e.visible,i=e.castShadow,n=e.receiveShadow;t.frustumCulled=a,t.visible=s,t.castShadow=i,t.receiveShadow=n}),t.shadowMap&&(t.shadowMap.enabled=h)}}function Te(e,t,a){var s=e.localClippingEnabled,i=e.clippingPlanes?e.clippingPlanes.slice():[];e.localClippingEnabled=!0,e.clippingPlanes=[new k(new x(0,1,0),-1e9)],e.compile(t,a),e.clippingPlanes=i,e.localClippingEnabled=s}function Be(e,t,a,s){if(e){var i=t.getRenderTarget(),n=!!t.shadowMap,o=!!n&&t.shadowMap.autoUpdate;n&&(t.shadowMap.autoUpdate=!1);var r=e.visible;e.visible=!0;var l=new j(1,1,{depthBuffer:!1,stencilBuffer:!1});t.setRenderTarget(l),t.render(a,s),t.setRenderTarget(i),l.dispose(),e.visible=r,n&&(t.shadowMap.autoUpdate=o,t.shadowMap.needsUpdate=!0)}}var He=function(){return d(function e(t,a,s,i,n,o,r){l(this,e),this.dataClass=t,this.scene=a,this.audioClass=s,this.levelClass=i,this.paramsClass=n,this.camera=o,this.gameClass=r,this.playerHeight=.9,this.playerWidth=.5,this.player=new v(new M(this.playerWidth,this.playerHeight,this.playerWidth),new D({color:16711680,transparent:!0,opacity:0})),this.player.material.depthWrite=!1,this.player.rotation.y=Math.PI,this.player.position.y=1.2,this.player.position.x=-.4,this.player.userData.name="player",this.player.userData.readyJump=!1,this.player.userData.jumping=!1,this.player.userData.playerPowerJump=1,this.player.userData.body=0,this.player.userData.onGround=!1,this.player.userData.audio=[],this.player.userData.canFly=!1,this.player.userData.canFlyNum=null,this.player.userData.canFlyJumps=0,this.player.userData.canFlyJumpsMax=3,this.player.userData.live=!0,this.player.userData.startPos,this.player.userData.deadPos,this.player.userData.playerAlive=!1,this.player.userData.score,this.player.userData.maxLives=3,this.player.userData.lives=this.player.userData.maxLives,this.player.userData.bonusHeart=0,this.player.userData.finish=!1,this.player.userData.splash=!1,this.playerModel,this.playerOut=new v(new M(this.playerWidth,this.playerHeight+.1,this.playerWidth),new C({color:16776960,transparent:!0,opacity:0})),this.playerOut.material.depthWrite=!1,this.playerOut.userData.id=this.player.uuid,this.leftHand,this.rightHand,this.head,this.headPosition,this.playerColors=[15904944,11596464,16052346]},[{key:"loadPlayerModel",value:(e=r(i().m(function e(){var t,a=this;return i().w(function(e){for(;;)switch(e.n){case 0:return t=new S,e.n=1,t.loadAsync("models/players/player1.glb").then(function(e){var t=e.scene;a.playerModel=t,a.playerModel.traverse(function(e){e.isMesh&&(e.castShadow=!0)}),a.playerModel.children[0].traverse(function(e){e.isMesh&&(e.castShadow=!0)}),a.leftHand=a.playerModel.children[0].children[1],a.rightHand=a.playerModel.children[0].children[0],a.head=a.playerModel.children[0].children[2],a.player.userData.head=a.head,a.playerModel.rotation.y=Math.PI,a.playerModel.scale.x=1.3,a.playerModel.scale.y=1.3,a.playerModel.scale.z=1.3});case 1:return e.a(2)}},e)})),function(){return e.apply(this,arguments)})},{key:"playerMove",value:function(){var e=this;if(this.levelClass.levelsMode&&"coop"==this.dataClass.levelCoopMode?(this.levelClass.players.every(function(e){return e.player.userData.finish})||this.levelClass.players.every(function(e){return e.player.userData.finish||e.player.userData.lives<=0}))&&this.levelClass.players.forEach(function(e){e.player.userData.body.setTranslation(new x(0,-5,0))}):this.levelClass.levelsMode&&"contest"==this.dataClass.levelCoopMode&&this.levelClass.players.some(function(e){return e.player.userData.finish})&&this.levelClass.players.forEach(function(e){e.player.userData.body.setTranslation(new x(0,-5,0))}),("hor"==this.paramsClass.gameDir&&this.player.position.x>this.levelClass.objs.grassPlanes.data[this.levelClass.count-1].position.x-this.levelClass.objs.grassPlanes.data[this.levelClass.count-1].size.x/2&&this.player.userData.onGround||"vert"==this.paramsClass.gameDir&&this.player.position.y>this.levelClass.objs.grassPlanes.data[this.levelClass.count-1].position.y+.5&&this.player.userData.onGround&&this.player.userData.body.linvel().y<0)&&(this.player.userData.finish||(this.player.userData.finish=!0)),Le(this.player,this.levelClass.objs.sensorPlanes.data)){var t=s(Pe(this.player.userData.collider),2);t[0];0==t[1][0]&&this.player.userData.collider.setCollisionGroups(je([1],[1]))}else{var a=s(Pe(this.player.userData.collider),2);a[0];0!=a[1][0]&&this.player.userData.collider.setCollisionGroups(je([1],[0,1]))}if(0==this.player.userData.body.linvel().x&&0==this.player.userData.body.linvel().y||!Le(this.player,this.levelClass.boostHatMeshes)||this.levelClass.boostHatModels[this.levelClass.boostHatMeshes.indexOf(Le(this.player,this.levelClass.boostHatMeshes))].userData.fly||this.levelClass.boostHatMeshes.indexOf(Le(this.player,this.levelClass.boostHatMeshes))==this.player.userData.canFlyNum||this.player.userData.canFly||(this.player.userData.canFly=!0,this.player.userData.canFlyJumps=this.player.userData.canFlyJumpsMax,this.player.userData.canFlyNum=this.levelClass.boostHatMeshes.indexOf(Le(this.player,this.levelClass.boostHatMeshes)),this.levelClass.boostHatModels[this.player.userData.canFlyNum].userData.fly=!0,this.audioClass.takeAudio.isPlaying&&this.audioClass.stopMusic(["take"]),this.audioClass.musicOn&&this.audioClass.playMusic(["take"])),Le(this.player,this.levelClass.objs.topPlanes.data)||Le(this.player,this.levelClass.playerOuts)?this.player.userData.onGround=!0:this.player.userData.onGround=!1,Le(this.player,this.levelClass.objs.livesBlocks.data)&&!Le(this.player,this.levelClass.objs.livesBlocks.data).userData.taked&&this.player.userData.lives<this.player.userData.maxLives&&(this.player.userData.lives++,this.audioClass.takeAudio.isPlaying&&this.audioClass.stopMusic(["take"]),this.audioClass.musicOn&&this.audioClass.playMusic(["take"]),this.reLiveField(),Le(this.player,this.levelClass.objs.livesBlocks.data).userData.taked=!0),this.playerModel.position.x=this.player.position.x,this.playerModel.position.y=this.player.position.y-this.playerHeight/2,this.playerModel.position.z=this.player.position.z,this.playerOut.position.copy(this.player.position),this.playerOut.rotation.copy(this.player.rotation),"hor"==this.paramsClass.gameDir&&this.player.position.x<this.camera.position.x-1.7*Math.abs(this.levelClass.bounds.leftX)&&this.player.userData.live&&this.levelClass.canHorDie&&this.levelClass.startAfterReset&&(this.player.userData.lives=0,this.reLiveField(),this.player.userData.body.setTranslation(new x(this.player.userData.body.translation().x,-5,0))),"vert"==this.paramsClass.gameDir&&this.player.position.y<this.camera.position.y-13&&this.player.userData.live&&this.camera.position.y>10&&this.levelClass.startAfterReset&&(this.player.userData.lives=0,this.reLiveField(),this.player.userData.body.setTranslation(new x(0,-5,0))),!this.levelClass.canHorDie&&this.camera.position.x>4&&this.camera.position.x<8&&"hor"==this.paramsClass.gameDir&&(this.levelClass.canHorDie=!0),this.player.position.y<-2&&this.gameClass.gameStarting&&(this.player.userData.splash||(this.player.userData.finish||this.gameClass.pause||!this.player.userData.live||(this.audioClass.stopMusic(["inwater"]),(this.audioClass.musicOn&&"coop"==this.dataClass.levelCoopMode||this.audioClass.musicOn&&"contest"==this.dataClass.levelCoopMode&&!this.levelClass.players.some(function(e){return e.player.userData.finish}))&&this.audioClass.playMusic(["inwater"])),this.levelClass.splash.trigger(new x(this.player.position.x,this.player.position.y+20,this.player.position.z),2),this.levelClass.ring.trigger(new x(this.player.position.x,this.player.position.y+.1,this.player.position.z))),this.player.userData.splash=!0),this.player.position.y<-4&&this.gameClass.gameStarting){if(this.player.userData.splash=!1,this.levelClass.players.length<2?(this.player.userData.live&&(this.audioClass.pauseMusic(["back"]),!this.player.userData.finish&&this.gameClass.pause,this.levelClass.levelsMode?(this.player.userData.lives=0,this.player.userData.finish?this.levelClass.showPopupInGame(!1,!0):this.levelClass.showPopupInGame(!0,!0),this.paramsClass.allDie=!0):(2==this.levelClass.gameNum?this.player.userData.lives--:4==this.levelClass.gameNum&&(this.player.userData.lives=0),(2==this.levelClass.gameNum&&this.player.userData.lives<1||4==this.levelClass.gameNum&&this.player.userData.lives<1)&&this.levelClass.showPopupInGame(!0),this.paramsClass.allDie=!0),this.player.userData.lives),this.player.userData.canFlyJumps=0,this.player.userData.live=!1):(this.player.userData.live&&(2==this.levelClass.gameNum||1==this.levelClass.gameNum?this.player.userData.lives--:4!=this.levelClass.gameNum&&3!=this.levelClass.gameNum||(this.player.userData.lives=0),this.levelClass.levelsMode&&(this.player.userData.lives=0),this.player.userData.finish,this.player.userData.canFlyJumps=0,this.player.userData.live=!1),this.levelClass.players.every(function(e){return!e.player.userData.live})&&this.levelClass.players.every(function(e){return e.player.userData.lives<1})&&this.gameClass.gameStarting&&(this.audioClass.pauseMusic(["back"]),this.audioClass.pauseMusic(["rain"]),"coop"==this.dataClass.levelCoopMode?(this.levelClass.players.every(function(e){return e.player.userData.finish})?this.levelClass.showPopupInGame(!1,!0):this.levelClass.showPopupInGame(!0),this.paramsClass.allDie=!0):"contest"==this.dataClass.levelCoopMode&&(this.levelClass.players.some(function(e){return e.player.userData.finish})?(this.levelClass.showPopupInGame(!1,!0),this.levelClass.players.forEach(function(t,a,s){t.player.userData.finish&&(e.dataClass.table.levelsStatusContest[e.levelClass.levelsMode-1]=a+1,e.dataClass.loadLevelsContest())})):this.levelClass.showPopupInGame(!0),this.paramsClass.allDie=!0))),this.player.userData.lives>0&&(this.levelClass.boostHatModels.forEach(function(e,t,a){e.userData.fly=!1}),this.playerAliving(!1),this.audioClass.musicOn&&this.audioClass.playMusic(["back"]),this.audioClass.musicOn&&this.levelClass.worldClass.rain&&this.audioClass.playMusic(["rain"])),!this.player.userData.live||this.player.userData.finish){if(this.player.userData.body.setLinvel(new x(0,0,0)),this.player.userData.canFlyNum&&(this.levelClass.boostHatModels[this.player.userData.canFlyNum].userData.fly=!1),this.player.userData.deadPos!=this.player.userData.startPos){for(var i=this.levelClass.objs.grassPlanes.data,n=0;n<i.length-1;n++){var o=i[n];if(o.position.x>=this.player.position.x-1&&!o.userData.moveHor&&!o.userData.moveVert){this.player.userData.deadPos=o.position;break}}null==this.player.userData.deadPos&&(this.player.userData.deadPos=this.levelClass.objs.grassPlanes.data[this.levelClass.objs.grassPlanes.data.length-1].position)}this.player.userData.playerAlive&&(this.player.userData.readyJump=!1,this.player.userData.canFly=!1,this.player.userData.canFlyJumps=0,this.player.userData.canFlyNum=null,this.player.userData.jumping=!1,this.player.userData.playerPowerJump=1,this.player.userData.onGround=!1,this.player.userData.body.setLinvel({x:0,y:0,z:0},!0),"vert"==this.paramsClass.gameDir?this.player.userData.body.setTranslation(new x(this.player.userData.deadPos.x+(.1+.2*Math.random()),this.player.userData.deadPos.y,this.player.userData.deadPos.z)):this.player.userData.body.setTranslation(new x(this.player.userData.deadPos.x+(.1+.2*Math.random()),this.player.userData.deadPos.y+we(1.1,3.1),this.player.userData.deadPos.z)),this.player.userData.deadPos=new x(0,0,0),this.player.userData.live=!0,this.player.userData.playerAlive=!1)}this.reLiveField()}else{var r=this.player.userData.readyJump?Math.PI/2:0,l=this.player.userData.readyJump?-Math.PI/2:0,h=this.player.userData.body.linvel().y<-1?Math.PI/1.5:0,d=this.player.userData.body.linvel().y<-1?-Math.PI/1.5:0,p=this.player.userData.readyJump?Math.PI/8:0,c=this.player.userData.body.linvel().y<-.4?Math.PI/7:0,u=this.player.userData.body.linvel().y>.4?Math.PI/-5.9:0,m=this.player.userData.readyJump?.75:1.18,b=this.player.userData.readyJump?.55:.15;this.rightHand.rotation.z=this.lerp(this.rightHand.rotation.z,r,.1),this.leftHand.rotation.z=this.lerp(this.leftHand.rotation.z,l,.1),this.rightHand.rotation.z=this.lerp(this.rightHand.rotation.z,h,.1),this.leftHand.rotation.z=this.lerp(this.leftHand.rotation.z,d,.1),this.head.rotation.x=this.lerp(this.head.rotation.x,p,.1),this.head.position.y=this.lerp(this.head.position.y,m,.1),this.head.position.z=this.lerp(this.head.position.z,b,.1),this.head.rotation.z=this.lerp(this.head.rotation.z,c,.1),this.head.rotation.z=this.lerp(this.head.rotation.z,u,.1);var g=this.player.userData.onGround?Math.PI:Math.PI/1.2;this.playerModel.rotation.y=this.lerp(this.playerModel.rotation.y,g,.4);var f=this.player.userData.readyJump?.71:0;this.player.userData.body.setRotation({w:this.player.userData.body.rotation().w,x:this.lerp(this.player.userData.body.rotation().x,f,.1),y:this.player.userData.body.rotation().y,z:this.player.userData.body.rotation().z}),this.player.userData.readyJump&&this.player.userData.playerPowerJump<8&&(this.player.userData.playerPowerJump+=.2),this.player.userData.jumping&&(this.player.userData.body.setLinvel({x:0,y:0,z:0},!0),this.player.userData.body.applyImpulse({x:"hor"==this.paramsClass.gameDir?this.player.userData.playerPowerJump/3:0,y:this.player.userData.playerPowerJump/1.4,z:0},!0),this.player.userData.playerPowerJump=1,this.player.userData.jumping=!1)}if(this.player.userData.canFlyJumps){var y=this.levelClass.boostHatModels[this.player.userData.canFlyNum],v=this.player.userData.head;y.userData.originalScale||(y.userData.originalScale=y.scale.clone()),y.parent!==this.scene&&this.scene.attach(y),this.playerModel.updateMatrixWorld(!0),v.updateWorldMatrix(!0,!1);var _=(new x).setFromMatrixPosition(this.player.userData.head.matrixWorld),w=new P;this.player.userData.head.getWorldQuaternion(w);var k=(new P).setFromEuler(new z(0,Math.PI/2,0)),j=w.clone().multiply(k),M=new x(.01,.14,.05).clone().applyQuaternion(j);y.quaternion.copy(j),y.position.copy(_).add(M),y.children[0].children[1].rotation.y+=.4,y.userData.lastPos=y.position.clone(),y.userData.lastQuat=y.quaternion.clone()}else{var D=this.player.userData.canFlyNum;if(null!==D&&this.levelClass.boostHatModels[D]){var C=this.levelClass.boostHatModels[D];C.userData.lastPos&&(C.position.copy(C.userData.lastPos),C.quaternion.copy(C.userData.lastQuat)),C.userData.fly=!1,C.children[0].children[1].rotation.y+=.02}}}},{key:"lerp",value:function(e,t,a){return e+(t-e)*a}},{key:"playerAliving",value:function(e){var t=this;this.paramsClass.allDie=!1,this.player.userData.playerAlive=!0,e&&(this.levelClass.reloadLevel(this.levelClass.players.findIndex(function(e,a,s){return e.player==t.player})),this.levelClass.canHorDie=!1,this.player.userData.deadPos=this.player.userData.startPos,this.levelClass.levelsMode?this.player.userData.lives=1:this.player.userData.lives=this.player.userData.maxLives,this.reLiveField(),this.player.userData.score=0),setTimeout(function(){t.gameClass.gameStarting=!0,t.player.userData.splash=!1},100)}},{key:"reLiveField",value:function(){for(var e=this,t=document.querySelectorAll(".player_panel_bottom_lives")[this.levelClass.players.findIndex(function(t,a,s){return t.player==e.player})].children,a=document.querySelectorAll(".num_bonus_heart")[this.levelClass.players.findIndex(function(t,a,s){return t.player==e.player})],s=0;s<t.length;s++)s>this.player.userData.lives-1?t[s].classList.add("opacity_my-screen"):t[s].classList.contains("opacity_my-screen")&&t[s].classList.remove("opacity_my-screen");this.player.userData.lives>3?(a.classList.contains("opacity_my-screen")&&a.classList.remove("opacity_my-screen"),a.textContent=this.player.userData.bonusHeart):a.classList.contains("opacity_my-screen")||a.classList.add("opacity_my-screen")}}]);var e}(),Re={ru:{ui:{langToggle:"EN"},title:"Ð£Ð¢Ð˜ÐÐÐ¯ Ð‘Ð ÐÐ¢Ð’Ð",modes:{champ:{title:"Ð§ÐµÐ¼Ð¿Ð¸Ð¾Ð½Ð°Ñ‚",desc:"Ð£ÑÑ‚Ð°Ð½Ð¾Ð²Ð¸Ñ‚Ðµ Ð»ÑƒÑ‡ÑˆÐµÐµ Ð²Ñ€ÐµÐ¼Ñ (1,2,3 Ð¸Ð³Ñ€Ð¾ÐºÐ°)"},coop:{title:"ÐŸÑ€Ð¾Ñ…Ð¾Ð¶Ð´ÐµÐ½Ð¸Ðµ",desc:"Ð¡Ð¾Ð²Ð¼ÐµÑÑ‚Ð½Ð¾Ðµ Ð¿Ñ€Ð¾Ñ…Ð¾Ð¶Ð´ÐµÐ½Ð¸Ðµ ÑƒÑ€Ð¾Ð²Ð½ÐµÐ¹"},versus:{title:"Ð¡Ð¾Ñ€ÐµÐ²Ð½Ð¾Ð²Ð°Ð½Ð¸Ðµ",desc:"ÐžÐ¿Ñ€ÐµÐ´ÐµÐ»Ð¸Ñ‚Ðµ Ð»ÑƒÑ‡ÑˆÐµÐ³Ð¾ Ð² Ð¿Ñ€Ð¾Ñ…Ð¾Ð¶Ð´ÐµÐ½Ð¸Ð¸"}},free:{playersTitle:"Ð¡ÐºÐ¾Ð»ÑŒÐºÐ¾ Ð¸Ð³Ñ€Ð¾ÐºÐ¾Ð²",gameChoice:"Ð’Ñ‹Ð±Ð¾Ñ€ Ð¸Ð³Ñ€Ñ‹",tip1:"Ð”Ð»Ñ ÐºÐ°Ð¶Ð´Ð¾Ð³Ð¾ ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð° Ð¸Ð³Ñ€Ð¾ÐºÐ¾Ð² ÑÐ²Ð¾Ñ Ñ‚Ð°Ð±Ð»Ð¸Ñ†Ð° Ñ€ÐµÐºÐ¾Ñ€Ð´Ð¾Ð²",tip2:"Ð£Ñ‡Ð¸Ñ‚Ñ‹Ð²Ð°ÐµÑ‚ÑÑ Ð¿Ñ€Ð¾Ð¹Ð´ÐµÐ½Ð½Ñ‹Ð¹ Ð¿ÑƒÑ‚ÑŒ ÐºÐ°Ð¶Ð´Ð¾Ð³Ð¾ Ð¸Ð³Ñ€Ð¾ÐºÐ° Ð² ÐºÐ¾Ð¼Ð°Ð½Ð´Ðµ",tip3:"Ð£Ð¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ Ð¾Ð´Ð½Ð¾Ð¹ ÐºÐ½Ð¾Ð¿ÐºÐ¾Ð¹. 1Ð¹ Ð¸Ð³Ñ€Ð¾Ðº Ð¼Ñ‹ÑˆÐºÐ¾Ð¹, 2Ð¹ Ð¸ 3Ð¹ ÐºÐ½Ð¾Ð¿ÐºÐ°Ð¼Ð¸",ocean:"ÐžÐºÐµÐ°Ð½",space:"ÐšÐ¾ÑÐ¼Ð¾Ñ"},levels:{playersTitle:"Ð¡ÐºÐ¾Ð»ÑŒÐºÐ¾ Ð¸Ð³Ñ€Ð¾ÐºÐ¾Ð²",levelChoice:"Ð’Ñ‹Ð±Ð¾Ñ€ ÑƒÑ€Ð¾Ð²Ð½Ñ",tip1:"ÐŸÑ€Ð¾Ñ…Ð¾Ð´Ð¸Ñ‚Ðµ ÑƒÑ€Ð¾Ð²Ð½Ð¸ Ñ€Ð°Ð·Ð½Ñ‹Ð¼ ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾Ð¼ Ð¸Ð³Ñ€Ð¾ÐºÐ¾Ð²",tip2:"ÐšÐ°Ð¶Ð´Ñ‹Ð¹ Ñ€Ð°Ð·, Ð¿Ñ€Ð¾Ñ…Ð¾Ð´Ñ 10Ð¹ ÑƒÑ€Ð¾Ð²ÐµÐ½ÑŒ, Ð¸Ð³Ñ€Ð¾Ðº Ð¿Ð¾Ð»ÑƒÑ‡Ð°ÐµÑ‚ 4 ÑÐµÑ€Ð´ÐµÑ‡ÐºÐ¾ Ð² Ñ€ÐµÐ¶Ð¸Ð¼Ðµ 'Ð§ÐµÐ¼Ð¿Ð¸Ð¾Ð½Ð°Ñ‚' Ð½Ð° Ð½ÐµÑÐºÐ¾Ð»ÑŒÐºÐ¾ Ð¿Ð¾Ð¿Ñ‹Ñ‚Ð¾Ðº. 10 ÑƒÑ€Ð¾Ð²ÐµÐ½ÑŒ Ð²ÑÐµÐ³Ð´Ð° Ñ€Ð°Ð·Ð½Ñ‹Ð¹!",tip3:"Ð”Ð»Ñ Ð¿Ñ€Ð¾Ñ…Ð¾Ð¶Ð´ÐµÐ½Ð¸Ñ ÑƒÑ€Ð¾Ð²Ð½Ñ Ð²ÑÐµ Ð¸Ð³Ñ€Ð¾ÐºÐ¸ Ð´Ð¾Ð»Ð¶Ð½Ñ‹ Ð´Ð¾Ð¹Ñ‚Ð¸ Ð´Ð¾ Ñ„Ð¸Ð½Ð¸ÑˆÐ°",status:{completed:"ÐŸÑ€Ð¾Ð¹Ð´ÐµÐ½",available:"Ð”Ð¾ÑÑ‚ÑƒÐ¿ÐµÐ½",locked:"Ð—Ð°ÐºÑ€Ñ‹Ñ‚",completedAria:"ÑƒÑ€Ð¾Ð²ÐµÐ½ÑŒ Ð¿Ñ€Ð¾Ð¹Ð´ÐµÐ½",availableAria:"ÑƒÑ€Ð¾Ð²ÐµÐ½ÑŒ Ð´Ð¾ÑÑ‚ÑƒÐ¿ÐµÐ½",lockedAria:"ÑƒÑ€Ð¾Ð²ÐµÐ½ÑŒ Ð·Ð°ÐºÑ€Ñ‹Ñ‚"}},contest:{playersTitle:"Ð¡ÐºÐ¾Ð»ÑŒÐºÐ¾ Ð¸Ð³Ñ€Ð¾ÐºÐ¾Ð²",levelChoice:"Ð’Ñ‹Ð±Ð¾Ñ€ ÑƒÑ€Ð¾Ð²Ð½Ñ",random:"Ð¡Ð»ÑƒÑ‡Ð°Ð¹Ð½Ñ‹Ð¹ ÑƒÑ€Ð¾Ð²ÐµÐ½ÑŒ",tip1:"Ð¡Ð¾Ñ€ÐµÐ²Ð½ÑƒÐ¹Ñ‚ÐµÑÑŒ Ð´Ñ€ÑƒÐ³ Ñ Ð´Ñ€ÑƒÐ³Ð¾Ð¼. ÐŸÐ¾Ð±ÐµÐ¶Ð´Ð°ÐµÑ‚ Ñ‚Ð¾Ñ‚, ÐºÑ‚Ð¾ Ð¿ÐµÑ€Ð²Ñ‹Ð¹ Ð´Ð¾Ð±ÐµÑ€ÐµÑ‚ÑÑ Ð´Ð¾ Ñ„Ð¸Ð½Ð¸ÑˆÐ°",tip2:"Ð¦Ð²ÐµÑ‚ ÑƒÑ€Ð¾Ð²Ð½Ñ Ð¾ÐºÑ€Ð°ÑˆÐ¸Ð²Ð°ÐµÑ‚ÑÑ Ð² Ñ†Ð²ÐµÑ‚ Ð¿Ð¾Ð±ÐµÐ´Ð¸Ñ‚ÐµÐ»Ñ",tip3:"Ð¦ÐµÐ»ÑŒ - Ð¾ÐºÑ€Ð°ÑÐ¸Ñ‚ÑŒ Ð²ÑÐµ ÑƒÑ€Ð¾Ð²Ð½Ð¸ Ð² ÑÐ²Ð¾Ð¸ Ñ†Ð²ÐµÑ‚Ð°",player1:"Ð‘Ð¸Ð»Ð»Ð¸",player2:"Ð’Ð¸Ð»Ð»Ð¸",player3:"Ð”Ð¸Ð»Ð»Ð¸"},players:{billy:"Ð‘Ð¸Ð»Ð»Ð¸",willy:"Ð’Ð¸Ð»Ð»Ð¸",dilly:"Ð”Ð¸Ð»Ð»Ð¸",lives:"Ð–Ð¸Ð·Ð½Ð¸:"},hud:{metersLabel:"Ð¼",records:"Ð ÐµÐºÐ¾Ñ€Ð´Ñ‹:",mine:"ÐœÐ¾Ð¹:",world:"ÐœÐ¸Ñ€Ð¾Ð²Ð¾Ð¹:",secPlayer:"Ð¯",thirdPlayer:"Ð¬"},popup:{continue:"ÐŸÑ€Ð¾Ð´Ð¾Ð»Ð¶Ð¸Ñ‚ÑŒ +",next:"Ð¡Ð»ÐµÐ´ÑƒÑŽÑ‰Ð¸Ð¹ ÑƒÑ€Ð¾Ð²ÐµÐ½ÑŒ",restart:"ÐÐ°Ñ‡Ð°Ñ‚ÑŒ Ð·Ð°Ð½Ð¾Ð²Ð¾",levelSelect:"Ð’Ñ‹Ð±Ð¾Ñ€ ÑƒÑ€Ð¾Ð²Ð½Ñ",exit:"Ð’Ñ‹Ð¹Ñ‚Ð¸ Ð² Ð¼ÐµÐ½ÑŽ"},loader:{loading:"Ð—Ð°Ð³Ñ€ÑƒÐ·ÐºÐ°..."},leaderboard:{mine:"ÐœÐ¾Ð¹ Ñ€ÐµÐºÐ¾Ñ€Ð´"},auth:{title:"ÐÐ²Ñ‚Ð¾Ñ€Ð¸Ð·ÑƒÐ¹Ñ‚ÐµÑÑŒ Ð´Ð»Ñ ÑƒÑ‡Ð°ÑÑ‚Ð¸Ñ Ð² Ñ€ÐµÐºÐ¾Ñ€Ð´Ð°Ñ…",cta:"Ð’Ð¾Ð¹Ñ‚Ð¸"}},en:{ui:{langToggle:"RU"},title:"DUCK BROS",modes:{champ:{title:"Championship",desc:"Set the best time (1,2,3 players)"},coop:{title:"Beat levels",desc:"Beat levels together"},versus:{title:"Versus",desc:"Find out whoâ€™s fastest"}},free:{playersTitle:"Players",gameChoice:"Game selection",tip1:"Each player count has its own leaderboard",tip2:"We sum distance traveled by each teammate",tip3:"One-button control. 1st player with the mouse, 2nd and 3rd buttons",ocean:"Ocean",space:"Space"},levels:{playersTitle:"Players",levelChoice:"Level selection",tip1:"Beat levels with different team sizes",tip2:"Each time you beat level 10 you get a 4th heart for a few championship attempts",tip3:"To finish a level, all players must reach the goal",status:{completed:"Completed",available:"Available",locked:"Locked",completedAria:"level completed",availableAria:"level available",lockedAria:"level locked"}},contest:{playersTitle:"Players",levelChoice:"Level selection",random:"Random level",tip1:"Race each other: first to finish wins",tip2:"The level gets dyed in the winnerâ€™s color",tip3:"Goal: dye all levels in your color",player1:"Billy",player2:"Willy",player3:"Dilly"},players:{billy:"Billy",willy:"Willy",dilly:"Dilly",lives:"Lives:"},hud:{metersLabel:"m",records:"Records:",mine:"Mine:",world:"World:",secPlayer:"Z",thirdPlayer:"M"},popup:{continue:"Continue +",next:"Next level",restart:"Restart",levelSelect:"Level select",exit:"Main menu"},loader:{loading:"Loading..."},leaderboard:{mine:"My record"},auth:{title:"Log in to participate in the records",cta:"LogIn"}}};function Fe(e,t){return t.split(".").reduce(function(e,t){return e&&e[t]},e)}function Ie(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"ru",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document,a=Re[e]||Re.ru;if(t.querySelectorAll("[data-i18n]").forEach(function(e){var t=e.dataset.i18n,s=Fe(a,t);null!=s&&(e.textContent=s)}),document.documentElement.lang=e,localStorage.setItem("locale",e),document.getElementById("lang-toggle")){var s=document.getElementById("flag");"ru"===Fe(a,"ui.langToggle")||"ru"===e?(s.classList.remove("us"),s.classList.add("ru"),s.src="images/ru.svg"):(s.classList.remove("ru"),s.classList.add("us"),s.src="images/us.svg")}}function Ne(e,t){null!=t?Ie(t):Ie(localStorage.getItem("locale")||"ru");var a=document.getElementById("lang-toggle");document.getElementById("flag"),a&&a.addEventListener("click",function(){Ie("ru"===(localStorage.getItem("locale")||"ru")?"en":"ru"),e()})}function Ge(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",a=localStorage.getItem("locale")||"ru",s=Re[a]||Re.ru,i=e.split(".").reduce(function(e,t){return e&&e[t]},s);return null!=i?i:t}var qe=new Set(["ÐœÐ¾Ð¹ Ñ€ÐµÐºÐ¾Ñ€Ð´","My record"]),Ue=function(e){return!0===(null==e?void 0:e.isMine)||(null==e?void 0:e.name)===Ge("hud.mineRecord","ÐœÐ¾Ð¹ Ñ€ÐµÐºÐ¾Ñ€Ð´")||qe.has(null==e?void 0:e.name)},Ye=function(){return d(function e(t,a,s,n,o,h,d,p,c,u,m,b,_,w,k,j){var P=this;l(this,e),this.scene=t,this.audioClass=a,this.physicsClass=s,this.renderer=n,this.camera=o,this.isMobile=h,this.paramsClass=d,this.worldClass=p,this.initMatch=c,this.gameClass=m,this.splash=b,this.ring=_,this.dataClass=u,this.scoreClass=w,this.menuClass=k,this.assetsManager=j,this.playersLoaded=!1,this.cameraSpeed=.01,this.score300ChampHorSent=!1,this.score100ChampVertSent=!1,this.levelsPlayedTracked=new Set,this.levelsContestPlayedTracked=new Set,this.hardHorReachedSent=!1,this.hardVertReachedSent=!1,this.levelsMode=!1,this.levelsNoFric=!1,this.allLevels=this.dataClass.allLevels,this.randomNoFric=.3,this.randomAnimateHor=.2,this.randomAnimateVert=.2,this.canShowAds=!0,this.boostHatModel,this.boostHatPropeller,this.boostHatMesh,this.boostHatModels=[],this.boostHatMeshes=[],this.boostHatCoords=[],this.angryBird,this.birdFlyingMark=10,this.distanceToBird=20,this.angryBirdModel,this.maxHeight=0,this.birdYes=!0,this.canHorDie=!1,this.planeWidth=4,this.planeHeight=10,this.planeDepth=1,this.minPlaneWidthTic=1,this.fixedDistanceHor={min:1,max:4},this.fixedDistanceVert={min:3,max:4},this.count=120,this._dayColor=new L(16777215),this._nightColor=new L(16771488),this.mksWidth=100,this.mksHeight=100,this.geometryPlane=new g(this.mksWidth,this.mksHeight),this.materialPlane=new y({color:0,side:A}),this.mks=new v(this.geometryPlane,this.materialPlane),this.mks.position.z=-550,this.mks.position.x=100,this.isMobile?this.mks.position.y=120:this.mks.position.y=140,this.mks.layers.set(1),this.startAfterReset=!0;var S=new E,N=.01;S.moveTo(5*N,5*N),S.bezierCurveTo(5*N,5*N,4*N,2*N,0,2*N),S.bezierCurveTo(-6*N,2*N,-6*N,7*N,-6*N,7*N),S.bezierCurveTo(-6*N,.1,-3*N,.14,5*N,.18),S.bezierCurveTo(.12,.14,.16,.1,.16,7*N),S.bezierCurveTo(.16,7*N,.16,2*N,.1,2*N),S.bezierCurveTo(7*N,2*N,5*N,5*N,5*N,5*N),this.objs={planes:{data:Array.from({length:this.count},function(e,t){return{position:new x(0,-10,0),rotation:new z(0,0,0),scale:new x(1,1,1),size:new x(1,1,1),userData:{name:"plane",collide:null,body:null,speed:null,direction:1}}}),geometryPlane:new M(this.planeWidth,this.planeHeight,this.planeDepth),materialPlane:new D({color:52224}),plane:null},topPlanes:{data:Array.from({length:this.count},function(e,t){return{position:new x(0,-10,0),rotation:new z(0,0,0),scale:new x(1,1,1),size:new x(1,1,1),userData:{name:"topSensor",collide:null,body:null,speed:null,direction:1}}}),geometryPlaneTop:new M(this.planeWidth,.4,1.2),materialPlaneTop:new C({color:13421568,transparent:!0,opacity:0}),planeTop:null},grassPlanes:{data:Array.from({length:this.count},function(e,t){return{position:new x(0,-10,0),rotation:new z(0,0,0),scale:new x(1,1,1),size:new x(1,1,1),userData:{name:"tops",collide:null,body:null,speed:null,direction:1,noFriction:!1,moveHor:!1,moveVert:!1}}}),geometryPlaneGrass:new M(this.planeWidth,.5,this.planeDepth+.2),materialPlaneGrass:new D({color:52224,transparent:!0,opacity:1}),planeGrass:null},sensorPlanes:{data:Array.from({length:this.count},function(e,t){return{position:new x(0,-10,0),rotation:new z(0,0,0),scale:new x(1,1,1),size:new x(1,1,1),userData:{name:"sensor",collide:null,body:null,speed:null,direction:1}}}),geometryPlaneSensor:new M(this.planeWidth,.4,1.2),materialPlaneSensor:new D({color:65280,transparent:!0,opacity:0}),planeSensor:null},lamps:{data:Array.from({length:this.count},function(e,t){return{position:new x(0,-10,0),rotation:new z(0,0,0),scale:new x(1,1,1),size:new x(.1,2,.1),userData:{name:"lamp",light:!1}}}),lampHeight:1,geometryLamp:new M(.3,1,.3),materialLamp:new D({color:16777215,transparent:!1,opacity:1}),lamp:null},plafons:{data:Array.from({length:this.count},function(e,t){return{position:new x(0,-10,0),rotation:new z(0,0,0),scale:new x(1,1,1),size:new x(.6,.6,.6),userData:{name:"plafon",light:!1,pointLight:null}}}),geometryPlafon:new B(.32,24,16),materialPlafon:new C({transparent:!0,color:16777215,opacity:.65,roughness:0,metalness:0,emissive:16777215}),plafon:null},bulbs:{data:Array.from({length:this.count},function(e,t){return{position:new x(0,-10,0),rotation:new z(0,0,0),scale:new x(1,1,1),size:new x(.3,.3,.3),userData:{name:"bulb",light:!1,pointLight:null}}}),geometryBulb:new B(.3),materialBulb:new C({emissive:new L(16770979),emissiveIntensity:6,color:16777215}),bulb:null},livesBlocks:{data:Array.from({length:this.count},function(e,t){return{position:new x(0,-10,0),rotation:new z(0,0,0),scale:new x(1,1,1),size:new x(.4,.3,.1),userData:{name:"liveBlock",taked:!1,startPos:new x(0,-10,0)}}}),geometryLivesBlock:new T(S,{depth:.22,bevelEnabled:!1,curveSegments:12,steps:1}),materialLivesBlock:new C({color:16711680}),livesBlock:null}},this.objs.planes.plane=new H(this.objs.planes.geometryPlane,this.objs.planes.materialPlane,this.count),this.objs.planes.plane.instanceMatrix.setUsage(R),this.objs.planes.plane.receiveShadow=!0,this.objs.planes.plane.castShadow=!0,this.objs.planes.plane.frustumCulled=!1,this.objs.topPlanes.planeTop=new H(this.objs.topPlanes.geometryPlaneTop,this.objs.topPlanes.materialPlaneTop,this.count),this.objs.topPlanes.planeTop.instanceMatrix.setUsage(R),this.objs.topPlanes.planeTop.frustumCulled=!1,this.objs.grassPlanes.planeGrass=new H(this.objs.grassPlanes.geometryPlaneGrass,this.objs.grassPlanes.materialPlaneGrass,this.count),this.objs.grassPlanes.planeGrass.instanceMatrix.setUsage(R),this.objs.grassPlanes.planeGrass.userData.direction=1,this.objs.grassPlanes.planeGrass.receiveShadow=!0,this.objs.grassPlanes.planeGrass.castShadow=!0,this.objs.grassPlanes.planeGrass.userData.name="tops",this.objs.grassPlanes.planeGrass.frustumCulled=!1,this.objs.sensorPlanes.planeSensor=new H(this.objs.sensorPlanes.geometryPlaneSensor,this.objs.sensorPlanes.materialPlaneSensor,this.count),this.objs.sensorPlanes.planeSensor.instanceMatrix.setUsage(R),this.objs.sensorPlanes.planeSensor.frustumCulled=!1,this.objs.sensorPlanes.planeSensor.visible=!1,this.objs.lamps.lamp=new H(this.objs.lamps.geometryLamp,this.objs.lamps.materialLamp,this.count),this.objs.lamps.lamp.instanceMatrix.setUsage(R),this.objs.lamps.lamp.frustumCulled=!1,this.objs.plafons.plafon=new H(this.objs.plafons.geometryPlafon,this.objs.plafons.materialPlafon,this.count),this.objs.plafons.plafon.instanceMatrix.setUsage(R),this.objs.plafons.plafon.frustumCulled=!1,this.objs.bulbs.bulb=new H(this.objs.bulbs.geometryBulb,this.objs.bulbs.materialBulb,this.count),this.objs.bulbs.bulb.instanceMatrix.setUsage(R),this.objs.bulbs.bulb.frustumCulled=!1,this.objs.bulbs.baseSize=this.objs.bulbs.data[0].size.clone(),this.objs.livesBlocks.livesBlock=new H(this.objs.livesBlocks.geometryLivesBlock,this.objs.livesBlocks.materialLivesBlock,this.count),this.objs.livesBlocks.livesBlock.instanceMatrix.setUsage(R),this.objs.livesBlocks.livesBlock.frustumCulled=!1,this.objs.livesBlocks.geometryLivesBlock.center(),this.objs.livesBlocks.geometryLivesBlock.rotateZ(Math.PI),this.objs.livesBlocks.geometryLivesBlock.center(),this.objs.livesBlocks.livesBlock.castShadow=!0,this.objs.plafons.materialPlafon.onBeforeCompile=function(e){e.uniforms.fresnelPower={value:2.5},e.fragmentShader=e.fragmentShader.replace("#include <output_fragment>","\n    float f = pow(1.0 - dot(normalize(vNormal), normalize(vViewPosition)), fresnelPower);\n    gl_FragColor = vec4( outgoingLight + f * 0.15, diffuseColor.a );\n    ")},this.objs.plafons.materialPlafon.needsUpdate=!0;for(var G=new Float32Array(this.count),q=0;q<this.count;q++)G[q]=0;this.objs.bulbs.geometryBulb.setAttribute("aEmissive",new F(G,1)),this.objs.bulbs.materialBulb.onBeforeCompile=function(e){e.vertexShader="\n    attribute float aEmissive;\n    varying float vEmissive;\n  "+e.vertexShader.replace("#include <begin_vertex>","\n      #include <begin_vertex>\n      vEmissive = aEmissive;\n    "),e.fragmentShader="\n    varying float vEmissive;\n  "+e.fragmentShader.replace("#include <lights_fragment_begin>","\n      #include <lights_fragment_begin>\n      // ÑƒÑÐ¸Ð»Ð¸Ð²Ð°ÐµÐ¼ ÑÐ¼Ð¸ÑÑÐ¸ÑŽ Ð² Ð·Ð°Ð²Ð¸ÑÐ¸Ð¼Ð¾ÑÑ‚Ð¸ Ð¾Ñ‚ Ð¸Ð½ÑÑ‚Ð°Ð½ÑÐ°\n      totalEmissiveRadiance *= vEmissive;\n    ")},this.objs.bulbs.materialBulb.needsUpdate=!0,this._glowTex=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:64,t=document.createElement("canvas");t.width=t.height=e;var a=t.getContext("2d"),s=a.createRadialGradient(e/2,e/2,0,e/2,e/2,e/2);s.addColorStop(0,"rgba(255, 235, 175, 1)"),s.addColorStop(1,"rgba(255, 235, 175, 0)"),a.fillStyle=s,a.fillRect(0,0,e,e);var i=new f(t);return i.anisotropy=1,i.generateMipmaps=!1,i.needsUpdate=!0,i}(),this._emissive=G,this.glowPool=[],this.lightsCount=5,this.lights=[],this.lightIntensity=25,this.bulbEmissiveIntensity=.9,this.playerOuts=[],this.players=[],this.backModel,this.backModels=[],this.leftEdge=new x(-1,0,0),this.rightEdge=new x(1,0,0),this.leftEdge.unproject(o),this.rightEdge.unproject(o),this.bounds,this.gameNum=1,this.cam={targetX:this.camera.position.x,velocityX:0,smoothTime:.28,targetFilterLambda:8,lookAheadSeconds:.2,lookAheadMax:3,maxBackJump:800},this.dt=new I,this.menuInGame=function(){function e(){return t.apply(this,arguments)}function t(){return(t=r(i().m(function e(){return i().w(function(e){for(;;)if(0===e.n)return e.a(2,new Promise(function(e){ysdk.adv.showFullscreenAdv({callbacks:{onOpen:function(){return console.log("Ad opened")},onClose:function(t){console.log("Ad closed",t),e(t)},onError:function(t){console.warn("Ad error",t),e(!1)}}})}))},e)}))).apply(this,arguments)}P.rebindButton(".popup_game_btn1",r(i().m(function e(){return i().w(function(e){for(;;)switch(e.n){case 0:ysdk.adv.showRewardedVideo({callbacks:{onOpen:function(){console.log("Video ad open.")},onRewarded:function(){console.log("Rewarded!"),P.audioClass.oceanAudio.isPlaying||P.audioClass.oceanAudio.play(),P.boostHatModels.forEach(function(e,t,a){e.userData.fly=!1});var e=[];P.players.forEach(function(t,a,s){e.push(t.player.position.x)}),P.players.forEach(function(t,a,s){t.playerAliving(!1),t.player.userData.lives=1,t.player.position.x=Math.max.apply(Math,e),P.camera.position.x=t.player.position.x}),P.audioClass.pauseMusic(["back"]),P.audioClass.playMusic(["back"]),P.levelsMode||(P.canShowAds=!1),P.gameClass.showGamePopup=!1,P.hideScreen("popup_in_game")},onClose:function(){console.log("Video ad closed.")},onError:function(e){console.log("Error while open video ad:",e)}}});case 1:return e.a(2)}},e)}))),P.rebindButton(".popup_game_btn2",r(i().m(function t(){var a,s;return i().w(function(t){for(;;)switch(t.n){case 0:return P.audioClass.hardStopAll(),t.n=1,e();case 1:for(a=[0,-1,1],P.players.forEach(function(e,t,s){if(e.player.userData.live=!1,e.player.userData.score=0,e.player.userData._lastMeterPos=null,e.player.userData._wasLive=!1,e.player.userData.body.setTranslation(new x(0,-5,0)),e.player.userData.finish=!1,e.playerAliving(!0),P.levelsMode){var i=P.players[t],n=Math.floor(Math.random()*a.length);i.player.userData.startPos.x=a[n],a.splice(n,1)}else e.player.position.x=e.player.position.x-1*t+1}),1!=P.gameNum&&3!=P.gameNum||(P.camera.position.y=0,P.camera.position.x=0,P.cameraSpeed=.01),P.canShowAds=!0,P.birdYes&&setTimeout(function(){P.birdFlyingMark=10,P.angryBird.userData.body.setTranslation({x:P.birdFlyingMark+P.bounds.rightX+P.distanceToBird,y:20,z:P.angryBird.userData.body.translation().z}),P.angryBird.userData.flying=!1},100),P.boostHatModels.forEach(function(e,t,a){e.position.x=P.boostHatCoords[t][0],e.position.y=P.boostHatCoords[t][1],e.userData.fly=!1}),s=0;s<P.objs.livesBlocks.data.length;s++)P.objs.livesBlocks.data[s].position=P.objs.livesBlocks.data[s].userData.startPos,P.apply(s,P.objs.livesBlocks.data,P.objs.livesBlocks.livesBlock);P.objs.livesBlocks.livesBlock.instanceMatrix.needsUpdate=!0,P.audioClass.stopMusic(["back"]),P.audioClass.playMusic(["back"]),P.audioClass.stopMusic(["ocean"]),P.audioClass.playMusic(["ocean"]),P.camera.position.x=0,P.gameClass.pause=!1,P.gameClass.showGamePopup=!1,P.hideScreen("popup_in_game"),setTimeout(function(){P.startAfterReset=!0},3e3);case 2:return t.a(2)}},t)}))),P.rebindButton(".popup_game_btn15",r(i().m(function t(){return i().w(function(t){for(;;)switch(t.n){case 0:return P.audioClass.hardStopAll(),t.n=1,e();case 1:P.paramsClass.dataLoaded=!1,Ae(P.scene),P.audioClass.stopMusic(0),setTimeout(function(){var e=P.levelsMode<P.allLevels?P.levelsMode+1:1;e==P.allLevels&&P.hideScreen("popup_game_btn15"),P.initMatch(P.players.length,P.gameNum,e,P.birdYes)},100),setTimeout(function(){P.players.forEach(function(e,t,a){e.playerAliving(!0)})},100),P.gameClass.showGamePopup=!1,P.hideScreen("popup_in_game");case 2:return t.a(2)}},t)}))),P.rebindButton(".popup_game_btn3",r(i().m(function t(){return i().w(function(t){for(;;)switch(t.n){case 0:return P.audioClass.hardStopAll(),t.n=1,e();case 1:P.gameClass.pause=!1,P.gameClass.showGamePopup=!1,P.hideScreen("popup_in_game"),P.showScreen("main_screen"),P.paramsClass.dataLoaded=!1,Ae(P.scene),P.audioClass.stopMusic(0),P.dataClass.gameInit=!1;case 2:return t.a(2)}},t)}))),P.rebindButton(".popup_game_btn4",r(i().m(function t(){return i().w(function(t){for(;;)switch(t.n){case 0:return P.audioClass.hardStopAll(),t.n=1,e();case 1:P.gameClass.pause=!1,P.gameClass.showGamePopup=!1,P.hideScreen("popup_in_game"),"contest"==P.dataClass.levelCoopMode?P.showScreen("levels_game_screen_contest"):P.showScreen("levels_game_screen"),P.paramsClass.dataLoaded=!1,Ae(P.scene),P.audioClass.stopMusic(0),P.dataClass.gameInit=!1;case 2:return t.a(2)}},t)})))},this.menuInGame()},[{key:"toVec3",value:function(e){var t,a,s;return"number"==typeof e?new x(e,e,e):null!=e&&e.isVector3?e:e?new x(null!==(t=e.x)&&void 0!==t?t:1,null!==(a=e.y)&&void 0!==a?a:1,null!==(s=e.z)&&void 0!==s?s:1):new x(1,1,1)}},{key:"apply",value:function(e,t,a){var s=a.userData.invBaseSize;if(!s){var i=a.geometry;i.computeBoundingBox();var n=new x;i.boundingBox.getSize(n),s=a.userData.invBaseSize=new x(1/(n.x||1),1/(n.y||1),1/(n.z||1))}this._dummy||(this._dummy=new N);var o=this._dummy,r=t[e]||{},l=this.toVec3(r.size);o.position.copy(r.position||new x),r.rotation?o.rotation.copy(r.rotation):o.rotation.set(0,0,0),o.scale.set(l.x*s.x,l.y*s.y,l.z*s.z),o.updateMatrix(),a.setMatrixAt(e,o.matrix)}},{key:"loadTexture",value:(p=r(i().m(function e(){var t=this;return i().w(function(e){for(;;)switch(e.n){case 0:(function(){var e=t.assetsManager.plane.texture,a=t.assetsManager.plane.material;e.wrapS=G,e.wrapT=G,e.repeat.set(t.planeWidth/4,t.planeHeight/4),t.objs.planes.plane.material=a})(),function(){var e=t.assetsManager.planeGrass.texture,a=t.assetsManager.planeGrass.material;e.wrapS=G,e.wrapT=G,e.repeat.set(t.planeWidth/1,t.planeHeight/8),t.objs.grassPlanes.planeGrass.material=a}(),function(){t.assetsManager.mks.texture;var e=t.assetsManager.mks.material;t.mks.material=e}();case 1:return e.a(2)}},e)})),function(){return p.apply(this,arguments)})},{key:"loadBarriers",value:(h=r(i().m(function e(){var t,a;return i().w(function(e){for(;;)switch(e.n){case 0:t=new M(.5,.5,1),a=new y({color:52224,transparent:!0,opacity:0}),this.angryBird=new v(t,a),this.angryBird.userData.name="bird",this.angryBird.userData.speed=we(8,13)/100,this.angryBird.userData.flying=!1,this.angryBird.position.y=-5,this.physicsClass.addPhysicsToObject(this.angryBird);case 1:return e.a(2)}},e,this)})),function(){return h.apply(this,arguments)})},{key:"createLevel",value:(o=r(i().m(function e(t){var a,s,n,o,r,l,h,d,p,c,u,m,b,g,f,y,v,x,_,w,k,j,P,M,D,C,S,z,L,A=this;return i().w(function(e){for(;;)switch(e.n){case 0:return this.levelsMode=t,this.maxHeight=0,this.birdFlyingMark=10,document.querySelector(".lev_hud span").textContent=t,e.n=1,this.loadTexture();case 1:return e.n=2,this.loadBarriers();case 2:if(this.boostHatModel=this.assetsManager.boostHatModel,this.boostHatPropeller=this.assetsManager.boostHatPropeller,this.boostHatMesh=this.assetsManager.boostHatMesh,this.birdYes&&(this.angryBirdModel=this.assetsManager.angryBirdModel,this.scene.add(this.angryBirdModel),Ee(this.angryBirdModel,this.renderer,this.camera,this.scene)),document.querySelectorAll(".player_panel")[0].classList.add("hidden_screen"),document.querySelectorAll(".player_panel")[1].classList.add("hidden_screen"),document.querySelectorAll(".player_panel")[2].classList.add("hidden_screen"),this.players.forEach(function(e,t,a){document.querySelectorAll(".player_panel")[t].classList.remove("hidden_screen")}),this.getHorizontalWorldBounds(),this.cameraMove(this.camera),!t){e.n=14;break}this.isMobile?this.getHorizontalWorldBounds():this.getHorizontalWorldBounds(-7),a=-2.5,s=-5,n=!1,z=t,e.n=1===z?3:2===z?4:3===z?5:4===z?6:5===z?7:6===z?8:7===z?9:8===z?10:9===z?11:10===z?12:13;break;case 3:return this.birdYes=!1,this.count=3,this.paramsClass.gameDir="hor",this.levelsNoFric=!0,this.randomAnimateHor=0,this.randomAnimateVert=0,this.gameNum=2,this.cameraSpeed=.01,this.fixedDistanceHor.min=1.5,e.a(3,13);case 4:return this.gameNum=4,this.birdYes=!1,this.count=3,this.paramsClass.gameDir="vert",this.randomAnimateHor=0,this.randomAnimateVert=0,e.a(3,13);case 5:return this.birdYes=!0,this.count=5,this.paramsClass.gameDir="hor",this.levelsNoFric=!0,this.randomAnimateHor=1,this.randomAnimateVert=0,this.gameNum=1,this.cameraSpeed=.01,this.fixedDistanceHor.min=1.5,e.a(3,13);case 6:return this.gameNum=3,this.birdYes=!0,this.count=5,this.paramsClass.gameDir="vert",this.levelsNoFric=!0,this.randomAnimateHor=0,this.randomAnimateVert=0,this.cameraSpeed=.01,e.a(3,13);case 7:return this.birdYes=!0,this.count=7,this.paramsClass.gameDir="hor",this.levelsNoFric=!1,this.randomNoFric=1,this.randomAnimateHor=1,this.randomAnimateVert=0,this.gameNum=1,this.cameraSpeed=.01,this.fixedDistanceHor.min=1.5,e.a(3,13);case 8:return this.birdYes=!0,this.count=9,this.paramsClass.gameDir="hor",this.levelsNoFric=!1,this.randomNoFric=1,this.randomAnimateHor=.5,this.randomAnimateVert=1,this.gameNum=2,this.cameraSpeed=.01,this.fixedDistanceHor.min=1.5,e.a(3,13);case 9:return this.gameNum=4,this.birdYes=!1,this.count=6,this.paramsClass.gameDir="vert",this.levelsNoFric=!0,this.randomAnimateHor=0,this.randomAnimateVert=0,this.cameraSpeed=.01,n=[5,6,5,6,5,6,5,6,5,6,5,6],e.a(3,13);case 10:return this.birdYes=!0,this.count=5,this.paramsClass.gameDir="hor",this.levelsNoFric=!0,this.randomNoFric=0,this.randomAnimateHor=0,this.randomAnimateVert=0,this.gameNum=2,this.cameraSpeed=.01,n=[3,2,2,2,1,6,5,6,5,6,5,1],this.fixedDistanceHor.min=2,e.a(3,13);case 11:return this.gameNum=3,this.birdYes=!1,this.count=6,this.paramsClass.gameDir="vert",this.levelsNoFric=!0,this.randomAnimateHor=0,this.randomAnimateVert=0,this.cameraSpeed=.01,n=[6,4,3,2,1,6,5,6,5,6,5,6],e.a(3,13);case 12:return this.birdYes=!0,this.count=10,this.paramsClass.gameDir="hor",this.levelsNoFric=!1,this.randomNoFric=.5,this.randomAnimateHor=.5,this.randomAnimateVert=.5,this.gameNum=1,this.cameraSpeed=.01,n=[2,2,1,1,1,1,1,1,5,6,5,.5],this.fixedDistanceHor.min=3,e.a(3,13);case 13:if("hor"==this.paramsClass.gameDir){for(o=0;o<this.count;o++)r=we(this.planeWidth,this.planeWidth-1),l=a+r/2+we(this.fixedDistanceHor.min,this.fixedDistanceHor.max),h=we(-1.2,1.2)-this.planeHeight/1.5,n&&(r=n[o]),0==o?(this.objs.planes.data[o].size.x=this.planeWidth,this.objs.planes.data[o].size.y=this.planeHeight,this.objs.planes.data[o].size.z=this.objs.grassPlanes.geometryPlaneGrass.parameters.depth,this.objs.topPlanes.data[o].size.x=this.planeWidth+.3,this.objs.topPlanes.data[o].size.y=this.objs.topPlanes.geometryPlaneTop.parameters.height,this.objs.grassPlanes.data[o].size.x=this.planeWidth+.3,this.objs.grassPlanes.data[o].size.y=this.objs.topPlanes.geometryPlaneTop.parameters.height,this.objs.grassPlanes.data[o].size.z=1.2*this.objs.grassPlanes.geometryPlaneGrass.parameters.depth):1==o?(this.objs.planes.data[o].size.x=r,this.objs.planes.data[o].size.y=this.planeHeight,this.objs.topPlanes.data[o].size.x=r+.3,this.objs.topPlanes.data[o].size.y=this.objs.topPlanes.geometryPlaneTop.parameters.height,this.objs.grassPlanes.data[o].size.x=r+.3,this.objs.grassPlanes.data[o].size.y=this.objs.grassPlanes.geometryPlaneGrass.parameters.height,this.objs.grassPlanes.data[o].size.z=this.objs.grassPlanes.geometryPlaneGrass.parameters.depth):o==this.count-1?(this.objs.planes.data[o].size.x=n?n[n.length-1]-.2:5,this.objs.planes.data[o].size.y=this.planeHeight,this.objs.topPlanes.data[o].size.x=n?n[n.length-1]:5.3,this.objs.topPlanes.data[o].size.y=this.objs.topPlanes.geometryPlaneTop.parameters.height,this.objs.grassPlanes.data[o].size.x=n?n[n.length-1]:5.3,this.objs.grassPlanes.data[o].size.y=this.objs.grassPlanes.geometryPlaneGrass.parameters.height,this.objs.grassPlanes.data[o].size.z=this.objs.grassPlanes.geometryPlaneGrass.parameters.depth):(this.objs.planes.data[o].size.x=r,this.objs.planes.data[o].size.y=this.planeHeight,this.objs.topPlanes.data[o].size.x=r+.3,this.objs.topPlanes.data[o].size.y=this.objs.topPlanes.geometryPlaneTop.parameters.height,this.objs.grassPlanes.data[o].size.x=r+.3,this.objs.grassPlanes.data[o].size.y=this.objs.grassPlanes.geometryPlaneGrass.parameters.height,this.objs.grassPlanes.data[o].size.z=this.objs.grassPlanes.geometryPlaneGrass.parameters.depth),0==o?(h=1-this.planeHeight/1.5,this.objs.planes.data[o].position.x=0,this.objs.planes.data[o].position.y=h+this.planeHeight/6-1.5,this.objs.topPlanes.data[o].position.x=0,this.objs.topPlanes.data[o].position.y=h+this.planeHeight/1.5+.2-1.5,this.objs.grassPlanes.data[o].position.x=0,this.objs.grassPlanes.data[o].position.y=h+this.planeHeight/1.5-1.5):(this.objs.planes.data[o].position.x=l+this.fixedDistanceHor.min/4,this.objs.planes.data[o].position.y=h+this.planeHeight/6,this.objs.topPlanes.data[o].position.x=l+this.fixedDistanceHor.min/4,this.objs.topPlanes.data[o].position.y=h+this.planeHeight/1.5+.2,this.objs.grassPlanes.data[o].position.x=l+this.fixedDistanceHor.min/4,this.objs.grassPlanes.data[o].position.y=h+this.planeHeight/1.5),this.objs.lamps.data[o].position.x=this.objs.grassPlanes.data[o].position.x,this.objs.lamps.data[o].position.z=-this.planeDepth/4,this.objs.lamps.data[o].position.y=this.objs.grassPlanes.data[o].position.y+this.objs.grassPlanes.data[o].size.y/2+this.objs.lamps.lampHeight-.2,this.objs.plafons.data[o].position.x=this.objs.lamps.data[o].position.x,this.objs.plafons.data[o].position.z=this.objs.lamps.data[o].position.z,this.objs.plafons.data[o].position.y=this.objs.lamps.data[o].position.y+1,this.objs.bulbs.data[o].position.x=this.objs.lamps.data[o].position.x,this.objs.bulbs.data[o].position.z=this.objs.lamps.data[o].position.z,this.objs.bulbs.data[o].position.y=this.objs.lamps.data[o].position.y+1,this.lights.length<this.lightsCount&&((d=new q(16247464,0,4)).position.set(0,0,1.6),this.lights.push(d),this.scene.add(d)),this.apply(o,this.objs.planes.data,this.objs.planes.plane),this.apply(o,this.objs.topPlanes.data,this.objs.topPlanes.planeTop),this.apply(o,this.objs.grassPlanes.data,this.objs.grassPlanes.planeGrass),this.apply(o,this.objs.lamps.data,this.objs.lamps.lamp),this.apply(o,this.objs.plafons.data,this.objs.plafons.plafon),this.apply(o,this.objs.bulbs.data,this.objs.bulbs.bulb),a=l+r/2;for(p=0;p<this.count;p++)p>1&&p<this.count-1&&Math.random()<this.randomAnimateHor&&!this.objs.grassPlanes.data[p-1].userData.moveHor&&(this.objs.grassPlanes.data[p].userData.moveHor={x1:this.objs.grassPlanes.data[p-1].position.x,x2:this.objs.grassPlanes.data[p+1].position.x,w1:this.objs.grassPlanes.data[p-1].size.x/2,w2:this.objs.grassPlanes.data[p+1].size.x/2},this.objs.planes.data[p].position.y=-10),p>1&&p<this.count-1&&Math.random()<this.randomAnimateVert&&(this.objs.grassPlanes.data[p].userData.moveVert={x1:this.objs.grassPlanes.data[p-1].position.x,x2:this.objs.grassPlanes.data[p+1].position.x,w1:this.objs.grassPlanes.data[p-1].size.x/2,w2:this.objs.grassPlanes.data[p+1].size.x/2},this.objs.planes.data[p].position.y=-10)}else if("vert"==this.paramsClass.gameDir)for(this.birdYes=!1,c=0;c<this.count;c++)u=we(this.bounds.rightX/this.minPlaneWidthTic,this.bounds.rightX/5),n&&(u=n[c]),this.minPlaneWidthTic+=.1,Math.random()<.5?this.objs.grassPlanes.data[c].userData.direction=1:this.objs.grassPlanes.data[c].userData.direction=-1,m=s+we(this.fixedDistanceVert.min,this.fixedDistanceVert.max),this.objs.topPlanes.data[c].position.y=m-1.3,this.objs.grassPlanes.data[c].position.y=m,this.objs.sensorPlanes.data[c].position.y=m-.3,this.objs.topPlanes.data[c].size.y=.3,this.objs.grassPlanes.data[c].size.y=.7,this.objs.sensorPlanes.data[c].size.y=.9,c>0?(this.objs.topPlanes.data[c].size.x=u+.3,this.objs.grassPlanes.data[c].size.x=u+.3,this.objs.sensorPlanes.data[c].size.x=u+.7):(this.objs.topPlanes.data[c].size.x=10,this.objs.grassPlanes.data[c].size.x=10,this.objs.sensorPlanes.data[c].size.x=10),this.objs.lamps.data[c].position.x=this.objs.grassPlanes.data[c].position.x,this.objs.lamps.data[c].position.z=-this.planeDepth/4,this.objs.lamps.data[c].position.y=this.objs.grassPlanes.data[c].position.y+this.objs.grassPlanes.data[c].size.y/2+this.objs.lamps.lampHeight-.2,this.objs.plafons.data[c].position.x=this.objs.lamps.data[c].position.x,this.objs.plafons.data[c].position.z=this.objs.lamps.data[c].position.z,this.objs.plafons.data[c].position.y=this.objs.lamps.data[c].position.y+1,this.objs.bulbs.data[c].position.x=this.objs.lamps.data[c].position.x,this.objs.bulbs.data[c].position.z=this.objs.lamps.data[c].position.z,this.objs.bulbs.data[c].position.y=this.objs.lamps.data[c].position.y+1,this.objs.grassPlanes.data[c].userData.speed=we(6,10)/100,this.lights.length<this.lightsCount&&((b=new q(16247464,0,4)).position.set(0,0,1.6),this.lights.push(b),this.scene.add(b)),this.apply(c,this.objs.topPlanes.data,this.objs.topPlanes.planeTop),this.apply(c,this.objs.grassPlanes.data,this.objs.grassPlanes.planeGrass),this.apply(c,this.objs.sensorPlanes.data,this.objs.sensorPlanes.planeSensor),this.apply(c,this.objs.lamps.data,this.objs.lamps.lamp),this.apply(c,this.objs.plafons.data,this.objs.plafons.plafon),this.apply(c,this.objs.bulbs.data,this.objs.bulbs.bulb),s=m;"hor"==this.paramsClass.gameDir&&(this.objs.planes.plane.instanceMatrix.needsUpdate=!0),"vert"==this.paramsClass.gameDir&&(this.objs.sensorPlanes.planeSensor.instanceMatrix.needsUpdate=!0),this.objs.topPlanes.planeTop.instanceMatrix.needsUpdate=!0,this.objs.grassPlanes.planeGrass.instanceMatrix.needsUpdate=!0,this.objs.lamps.lamp.instanceMatrix.needsUpdate=!0,this.objs.plafons.plafon.instanceMatrix.needsUpdate=!0,this.objs.bulbs.bulb.instanceMatrix.needsUpdate=!0,"hor"==this.paramsClass.gameDir&&this.scene.add(this.objs.planes.plane),"vert"==this.paramsClass.gameDir&&this.scene.add(this.objs.sensorPlanes.planeSensor),this.scene.add(this.objs.topPlanes.planeTop),this.scene.add(this.objs.grassPlanes.planeGrass),this.scene.add(this.objs.lamps.lamp),this.scene.add(this.objs.plafons.plafon),this.scene.add(this.objs.bulbs.bulb),this.isMobile?this.getHorizontalWorldBounds():this.getHorizontalWorldBounds(-7),e.n=17;break;case 14:this.getHorizontalWorldBounds(),L=this.gameNum,e.n=1===L||2===L?15:3===L||4===L?16:17;break;case 15:for(this.paramsClass.gameDir="hor",g=-2.5,f=0;f<this.count;f++)y=we(this.planeWidth/this.minPlaneWidthTic,this.planeWidth-1),v=g+y/2+we(this.fixedDistanceHor.min,this.fixedDistanceHor.max),x=we(-1.2,1.2)-this.planeHeight/1.5,f>20&&(this.fixedDistanceHor.max=6),this.minPlaneWidthTic+=.1,f>this.count-20?(this.objs.planes.data[f].size.x=.1,this.objs.planes.data[f].size.y=this.planeHeight,this.objs.topPlanes.data[f].size.x=.5,this.objs.topPlanes.data[f].size.y=this.objs.topPlanes.geometryPlaneTop.parameters.height,this.objs.grassPlanes.data[f].size.x=.5,this.objs.grassPlanes.data[f].size.y=this.objs.grassPlanes.geometryPlaneGrass.parameters.height,this.objs.grassPlanes.data[f].size.z=this.objs.grassPlanes.geometryPlaneGrass.parameters.depth):f>0?(this.objs.planes.data[f].size.x=y,this.objs.planes.data[f].size.y=this.planeHeight,this.objs.topPlanes.data[f].size.x=y+.3,this.objs.topPlanes.data[f].size.y=this.objs.topPlanes.geometryPlaneTop.parameters.height,this.objs.grassPlanes.data[f].size.x=y+.3,this.objs.grassPlanes.data[f].size.y=this.objs.grassPlanes.geometryPlaneGrass.parameters.height,this.objs.grassPlanes.data[f].size.z=this.objs.grassPlanes.geometryPlaneGrass.parameters.depth):(this.objs.planes.data[f].size.x=this.planeWidth,this.objs.planes.data[f].size.y=this.planeHeight,this.objs.topPlanes.data[f].size.x=this.planeWidth+.3,this.objs.topPlanes.data[f].size.y=this.objs.topPlanes.geometryPlaneTop.parameters.height,this.objs.grassPlanes.data[f].size.x=this.planeWidth+.3,this.objs.grassPlanes.data[f].size.y=this.objs.topPlanes.geometryPlaneTop.parameters.height,this.objs.grassPlanes.data[f].size.z=this.objs.grassPlanes.geometryPlaneGrass.parameters.depth),0==f?(x=1-this.planeHeight/1.5,this.objs.planes.data[f].position.x=0,this.objs.planes.data[f].position.y=x+this.planeHeight/6-1.5,this.objs.topPlanes.data[f].position.x=0,this.objs.topPlanes.data[f].position.y=x+this.planeHeight/1.5+.2-1.5,this.objs.grassPlanes.data[f].position.x=0,this.objs.grassPlanes.data[f].position.y=x+this.planeHeight/1.5-1.5):1==f?(v=6,this.objs.planes.data[f].position.x=v,this.objs.planes.data[f].position.y=x+this.planeHeight/6,this.objs.topPlanes.data[f].position.x=v,this.objs.topPlanes.data[f].position.y=x+this.planeHeight/1.5+.2,this.objs.grassPlanes.data[f].position.x=v,this.objs.grassPlanes.data[f].position.y=x+this.planeHeight/1.5):f>1&&(this.objs.planes.data[f].position.x=v,this.objs.planes.data[f].position.y=x+this.planeHeight/6,this.objs.topPlanes.data[f].position.x=v,this.objs.topPlanes.data[f].position.y=x+this.planeHeight/1.5+.2,this.objs.grassPlanes.data[f].position.x=v,this.objs.grassPlanes.data[f].position.y=x+this.planeHeight/1.5),this.objs.lamps.data[f].position.x=this.objs.grassPlanes.data[f].position.x,this.objs.lamps.data[f].position.z=-this.planeDepth/4,this.objs.lamps.data[f].position.y=this.objs.grassPlanes.data[f].position.y+this.objs.grassPlanes.data[f].size.y/2+this.objs.lamps.lampHeight-.2,this.objs.plafons.data[f].position.x=this.objs.lamps.data[f].position.x,this.objs.plafons.data[f].position.z=this.objs.lamps.data[f].position.z,this.objs.plafons.data[f].position.y=this.objs.lamps.data[f].position.y+1,this.objs.bulbs.data[f].position.x=this.objs.lamps.data[f].position.x,this.objs.bulbs.data[f].position.z=this.objs.lamps.data[f].position.z,this.objs.bulbs.data[f].position.y=this.objs.lamps.data[f].position.y+1,this.lights.length<this.lightsCount&&((_=new q(16247464,0,4)).position.set(0,0,1.6),this.lights.push(_),this.scene.add(_)),this.apply(f,this.objs.planes.data,this.objs.planes.plane),this.apply(f,this.objs.topPlanes.data,this.objs.topPlanes.planeTop),this.apply(f,this.objs.grassPlanes.data,this.objs.grassPlanes.planeGrass),this.apply(f,this.objs.lamps.data,this.objs.lamps.lamp),this.apply(f,this.objs.plafons.data,this.objs.plafons.plafon),this.apply(f,this.objs.bulbs.data,this.objs.bulbs.bulb),g=v+y/2;for(w=0;w<this.count;w++)w>4&&w<this.count-2&&Math.random()<this.randomAnimateHor&&!this.objs.grassPlanes.data[w-1].userData.moveHor&&(this.objs.grassPlanes.data[w].userData.moveHor={x1:this.objs.grassPlanes.data[w-1].position.x,x2:this.objs.grassPlanes.data[w+1].position.x,w1:this.objs.grassPlanes.data[w-1].size.x/2,w2:this.objs.grassPlanes.data[w+1].size.x/2},this.objs.planes.data[w].position.y=-10),w>7&&w<this.count-2&&Math.random()<this.randomAnimateHor&&!this.objs.grassPlanes.data[w-1].userData.moveHor&&!this.objs.grassPlanes.data[w-1].userData.moveVert&&(this.objs.grassPlanes.data[w].userData.moveVert={x1:this.objs.grassPlanes.data[w-1].position.x,x2:this.objs.grassPlanes.data[w+1].position.x,w1:this.objs.grassPlanes.data[w-1].size.x/2,w2:this.objs.grassPlanes.data[w+1].size.x/2},this.objs.planes.data[w].position.y=-10),this.objs.grassPlanes.data[w].position.y>this.maxHeight&&(this.maxHeight=this.objs.grassPlanes.data[w].position.y),w>7&&Math.random()<.1&&!this.objs.grassPlanes.data[w].userData.moveHor&&!this.objs.grassPlanes.data[w].userData.moveVert&&(this.objs.livesBlocks.data[w].position.x=this.objs.grassPlanes.data[w].position.x-this.objs.grassPlanes.data[w].size.x/2+this.objs.livesBlocks.data[w].size.x/2,this.objs.livesBlocks.data[w].position.y=this.objs.grassPlanes.data[w].position.y+this.objs.grassPlanes.data[w].size.y/2+this.objs.livesBlocks.data[w].size.y/2+.2,this.objs.livesBlocks.data[w].userData.startPos=this.objs.livesBlocks.data[w].position.clone()),this.apply(w,this.objs.livesBlocks.data,this.objs.livesBlocks.livesBlock),w>2&&(w+1)%10==1&&((k=this.boostHatModel.clone()).position.x=this.objs.grassPlanes.data[w].position.x,k.position.y=this.objs.topPlanes.data[w].position.y+2,k.rotation.y=-Math.PI/2,k.userData.num=w,this.boostHatModels.push(k),this.boostHatMeshes.push(k.children[0].children[0].children[0]),this.boostHatCoords.push([k.position.x,k.position.y]),this.scene.add(k));return this.objs.planes.plane.instanceMatrix.needsUpdate=!0,this.objs.topPlanes.planeTop.instanceMatrix.needsUpdate=!0,this.objs.grassPlanes.planeGrass.instanceMatrix.needsUpdate=!0,this.objs.livesBlocks.livesBlock.instanceMatrix.needsUpdate=!0,this.objs.lamps.lamp.instanceMatrix.needsUpdate=!0,this.objs.plafons.plafon.instanceMatrix.needsUpdate=!0,this.objs.bulbs.bulb.instanceMatrix.needsUpdate=!0,this.scene.add(this.objs.planes.plane),this.scene.add(this.objs.topPlanes.planeTop),this.scene.add(this.objs.grassPlanes.planeGrass),this.scene.add(this.objs.livesBlocks.livesBlock),this.scene.add(this.objs.lamps.lamp),this.scene.add(this.objs.plafons.plafon),this.scene.add(this.objs.bulbs.bulb),this.angryBird.position.y=50,this.angryBird.position.x=40,this.scene.add(this.angryBird),e.a(3,17);case 16:for(this.paramsClass.gameDir="vert",j=-5,this.birdYes=!1,P=0;P<this.count;P++)M=we(7/this.minPlaneWidthTic,18/this.minPlaneWidthTic),this.minPlaneWidthTic+=.1,Math.random()<.5?this.objs.grassPlanes.data[P].userData.direction=1:this.objs.grassPlanes.data[P].userData.direction=-1,D=j+we(this.fixedDistanceVert.min,this.fixedDistanceVert.max),this.objs.topPlanes.data[P].position.y=D-1.3,this.objs.grassPlanes.data[P].position.y=D,this.objs.sensorPlanes.data[P].position.y=D-.3,this.objs.topPlanes.data[P].size.y=.3,this.objs.grassPlanes.data[P].size.y=.7,this.objs.sensorPlanes.data[P].size.y=.9,P>this.count-20&&(this.objs.topPlanes.data[P].size.x=M/8+.1,this.objs.grassPlanes.data[P].size.x=M/8+.1,this.objs.sensorPlanes.data[P].size.x=M/8+.4),P>0?(this.objs.topPlanes.data[P].size.x=M+.3,this.objs.grassPlanes.data[P].size.x=M+.3,this.objs.sensorPlanes.data[P].size.x=M+.7):(this.objs.topPlanes.data[P].size.x=10,this.objs.grassPlanes.data[P].size.x=10,this.objs.sensorPlanes.data[P].size.x=10),P>this.count-10?this.objs.grassPlanes.data[P].userData.speed=we(10,14)/100:this.objs.grassPlanes.data[P].userData.speed=we(6,10)/100,this.objs.lamps.data[P].position.x=this.objs.grassPlanes.data[P].position.x,this.objs.lamps.data[P].position.z=-this.planeDepth/4,this.objs.lamps.data[P].position.y=this.objs.grassPlanes.data[P].position.y+this.objs.grassPlanes.data[P].size.y/2+this.objs.lamps.lampHeight-.2,this.objs.plafons.data[P].position.x=this.objs.lamps.data[P].position.x,this.objs.plafons.data[P].position.z=this.objs.lamps.data[P].position.z,this.objs.plafons.data[P].position.y=this.objs.lamps.data[P].position.y+1,this.objs.bulbs.data[P].position.x=this.objs.lamps.data[P].position.x,this.objs.bulbs.data[P].position.z=this.objs.lamps.data[P].position.z,this.objs.bulbs.data[P].position.y=this.objs.lamps.data[P].position.y+1,(P+1)%7==0&&((C=this.boostHatModel.clone()).position.x=we(this.bounds.leftX+1,this.bounds.rightX-1),C.position.y=this.objs.topPlanes.data[P].position.y+.5,this.boostHatModels.push(C),this.boostHatMeshes.push(C.children[0].children[0].children[0]),this.boostHatCoords.push([C.position.x,C.position.y]),this.scene.add(C)),this.lights.length<this.lightsCount&&((S=new q(16247464,0,4)).position.set(0,0,1.6),this.lights.push(S),this.scene.add(S)),this.apply(P,this.objs.topPlanes.data,this.objs.topPlanes.planeTop),this.apply(P,this.objs.grassPlanes.data,this.objs.grassPlanes.planeGrass),this.apply(P,this.objs.sensorPlanes.data,this.objs.sensorPlanes.planeSensor),this.apply(P,this.objs.lamps.data,this.objs.lamps.lamp),this.apply(P,this.objs.plafons.data,this.objs.plafons.plafon),this.apply(P,this.objs.bulbs.data,this.objs.bulbs.bulb),j=D;return this.objs.topPlanes.planeTop.instanceMatrix.needsUpdate=!0,this.objs.grassPlanes.planeGrass.instanceMatrix.needsUpdate=!0,this.objs.sensorPlanes.planeSensor.instanceMatrix.needsUpdate=!0,this.objs.lamps.lamp.instanceMatrix.needsUpdate=!0,this.objs.plafons.plafon.instanceMatrix.needsUpdate=!0,this.objs.bulbs.bulb.instanceMatrix.needsUpdate=!0,this.scene.add(this.objs.topPlanes.planeTop),this.scene.add(this.objs.grassPlanes.planeGrass),this.scene.add(this.objs.sensorPlanes.planeSensor),this.scene.add(this.objs.lamps.lamp),this.scene.add(this.objs.plafons.plafon),this.scene.add(this.objs.bulbs.bulb),this.scene.add(this.mks),e.a(3,17);case 17:this.players.forEach(function(e,a,s){e.player.position.y=A.objs.grassPlanes.data[0].position.y+A.objs.grassPlanes.data[0].size.y,(t||"vert"==A.paramsClass.gameDir)&&(e.player.userData.lives=1,e.reLiveField())});case 18:return e.a(2)}},e,this)})),function(e){return o.apply(this,arguments)})},{key:"getHorizontalWorldBounds",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=new x(-1,0,.5),a=new x(1,0,.5),s=new x(0,1,.5),i=new x(0,-1,.5);if(t.unproject(this.camera),a.unproject(this.camera),s.unproject(this.camera),i.unproject(this.camera),this.camera.isPerspectiveCamera){var n=this.camera.position,o=t.clone().sub(n).normalize(),r=a.clone().sub(n).normalize(),l=s.clone().sub(n).normalize(),h=i.clone().sub(n).normalize(),d=(e-n.z)/o.z,p=(e-n.z)/h.z,c=n.clone().add(o.multiplyScalar(d)),u=n.clone().add(r.multiplyScalar(d)),m=n.clone().add(l.multiplyScalar(p)),b=n.clone().add(h.multiplyScalar(p));this.bounds={leftX:c.x,rightX:u.x,topY:m.y,bottomY:b.y}}}},{key:"animateTops",value:function(){if("hor"==this.paramsClass.gameDir){for(var e=!1,t=0;t<this.objs.grassPlanes.data.length;t++){var a=this.objs.grassPlanes.data[t],s=a.userData.body,i=a.userData.moveHor,n=a.userData.moveVert;if(s&&(i||n))if(i){var o,r=s.translation(),l=i.x1+i.w1+.5*a.size.x,h=i.x2-i.w2-.5*a.size.x,d=null!==(o=a.userData.speed)&&void 0!==o?o:.05;r.x>=h&&(a.userData.direction=-1),r.x<=l&&(a.userData.direction=1);var p=a.userData.direction*d,c=r.x+p;s.setNextKinematicTranslation({x:c,y:r.y,z:r.z}),a.position.x=c,this.objs.lamps.data[t].position.x=c,this.objs.plafons.data[t].position.x=c,this.objs.bulbs.data[t].position.x=c,this.objs.topPlanes.data[t].position.x=c}else if(n){var u,m=s.translation(),b=null!==(u=a.userData.speed)&&void 0!==u?u:.03;m.y>=2&&(a.userData.direction=-1),m.y<=.5&&(a.userData.direction=1);var g=a.userData.direction*b,f=m.y+g;s.setNextKinematicTranslation({x:m.x,y:f,z:m.z}),a.position.y=f,this.objs.lamps.data[t].position.y=f+this.objs.lamps.lampHeight,this.objs.plafons.data[t].position.y=f+this.objs.lamps.lampHeight+1,this.objs.bulbs.data[t].position.y=f+this.objs.lamps.lampHeight+1,this.objs.topPlanes.data[t].position.y=f+.2}for(var y=0;y<this.objs.livesBlocks.data.length;y++)this.objs.livesBlocks.data[y].userData.taked?this.objs.livesBlocks.data[y].position.y<10?(this.objs.livesBlocks.data[y].position.y+=.001,this.objs.livesBlocks.data[y].rotation.y+=.004):this.objs.livesBlocks.data[y].userData.taked=!1:this.objs.livesBlocks.data[y].rotation.y+=4e-4,this.apply(y,this.objs.livesBlocks.data,this.objs.livesBlocks.livesBlock);this.objs.livesBlocks.livesBlock.instanceMatrix.needsUpdate=!0,this.apply(t,this.objs.grassPlanes.data,this.objs.grassPlanes.planeGrass),this.apply(t,this.objs.topPlanes.data,this.objs.topPlanes.planeTop),this.apply(t,this.objs.lamps.data,this.objs.lamps.lamp),this.apply(t,this.objs.plafons.data,this.objs.plafons.plafon),this.apply(t,this.objs.bulbs.data,this.objs.bulbs.bulb),e=!0}e&&(this.objs.grassPlanes.planeGrass.instanceMatrix.needsUpdate=!0,this.objs.topPlanes.planeTop.instanceMatrix.needsUpdate=!0,this.objs.lamps.lamp.instanceMatrix.needsUpdate=!0,this.objs.plafons.plafon.instanceMatrix.needsUpdate=!0,this.objs.bulbs.bulb.instanceMatrix.needsUpdate=!0)}if("vert"==this.paramsClass.gameDir){for(var v=0;v<this.objs.grassPlanes.data.length;v++){var x=this.objs.grassPlanes.data[v],_=this.objs.topPlanes.data[v];this.objs.sensorPlanes.data[v],this.objs.lamps.data[v],this.objs.plafons.data[v],this.objs.bulbs.data[v];var w=x.userData.body,k=x.userData.speed,j=w.translation();j.x>this.bounds.rightX-x.size.x/2?x.userData.direction=-1:j.x<this.bounds.leftX+x.size.x/2&&(x.userData.direction=1);var P=x.userData.direction*k,M=j.x+P;v>0&&w.setNextKinematicTranslation({x:M,y:j.y,z:j.z}),this.objs.sensorPlanes.data[v].position.x=M,this.objs.lamps.data[v].position.x=M,this.objs.plafons.data[v].position.x=M,this.objs.bulbs.data[v].position.x=M,this.objs.topPlanes.data[v].position.x=M,this.objs.topPlanes.data[v].position.y=j.y+.4,this.apply(v,this.objs.sensorPlanes.data,this.objs.sensorPlanes.planeSensor),this.apply(v,this.objs.topPlanes.data,this.objs.topPlanes.planeTop),this.apply(v,this.objs.lamps.data,this.objs.lamps.lamp),this.apply(v,this.objs.plafons.data,this.objs.plafons.plafon),this.apply(v,this.objs.bulbs.data,this.objs.bulbs.bulb),_.position.set(M,j.y+.6,j.z)}this.objs.sensorPlanes.planeSensor.instanceMatrix.needsUpdate=!0,this.objs.topPlanes.planeTop.instanceMatrix.needsUpdate=!0,this.objs.lamps.lamp.instanceMatrix.needsUpdate=!0,this.objs.plafons.plafon.instanceMatrix.needsUpdate=!0,this.objs.bulbs.bulb.instanceMatrix.needsUpdate=!0}}},{key:"loadEnvironments",value:(n=r(i().m(function e(){var t;return i().w(function(e){for(;;)switch(e.n){case 0:for(t=0;t<this.objs.grassPlanes.data.length;t++)"hor"==this.paramsClass.gameDir&&(this.physicsClass.addInstancedStatic(this.objs.planes.data,this.objs.planes.plane,t,{position:this.objs.planes.data[t].position,size:this.objs.planes.data[t].size,collide:"123"}),this.apply(t,this.objs.planes.data,this.objs.planes.plane)),this.physicsClass.addInstancedStatic(this.objs.grassPlanes.data,this.objs.grassPlanes.planeGrass,t,{position:this.objs.grassPlanes.data[t].position,size:this.objs.grassPlanes.data[t].size,collide:"123"}),this.apply(t,this.objs.grassPlanes.data,this.objs.grassPlanes.planeGrass),"vert"==this.paramsClass.gameDir||this.objs.grassPlanes.data[t].userData.moveHor?this.objs.grassPlanes.data[t].userData.collide.setFriction(500):Math.random()<this.randomNoFric&&t>2&&!this.levelsNoFric&&(this.objs.grassPlanes.data[t].userData.noFriction=!0,this.objs.grassPlanes.data[t].userData.collide.setFriction(0),this.objs.grassPlanes.planeGrass.setColorAt(t,new L(13421806))),t>this.count-10&&!this.levelsMode&&this.objs.grassPlanes.planeGrass.setColorAt(t,new L(16711680)),t==this.count-1&&this.levelsMode&&this.objs.grassPlanes.planeGrass.setColorAt(t,new L(65280));"hor"==this.paramsClass.gameDir&&(this.objs.planes.plane.instanceMatrix.needsUpdate=!0),this.objs.grassPlanes.planeGrass.instanceMatrix.needsUpdate=!0;case 1:return e.a(2)}},e,this)})),function(){return n.apply(this,arguments)})},{key:"levelAnimate",value:function(){var e=this;if(!this.levelsMode)if("hor"==this.paramsClass.gameDir){if(this.scoreClass.updateMetersFloat(null,this.players,"hor"),!this.hardHorReachedSent){var t,a,s=this.count-10,i=null!==(t=null===(a=this.objs.grassPlanes.data[s])||void 0===a?void 0:a.position.x)&&void 0!==t?t:1/0;this.players.some(function(e){var t=null==e?void 0:e.player;return!!t&&t.position.x>=i})&&(this.hardHorReachedSent=!0,ym(105298813,"reachGoal","champ_hor_hard_".concat(this.players.length)))}!this.score300ChampHorSent&&this.scoreClass.score>=300&&(this.score300ChampHorSent=!0,ym(105298813,"reachGoal","score300_champ_hor_".concat(this.players.length)))}else{if(this.scoreClass.updateMetersFloat(null,this.players,"vert"),!this.hardVertReachedSent){var n,o,r=this.count-10,l=null!==(n=null===(o=this.objs.grassPlanes.data[r])||void 0===o?void 0:o.position.y)&&void 0!==n?n:1/0;this.players.some(function(e){var t=null==e?void 0:e.player;return!!t&&t.position.y>=l})&&(this.hardVertReachedSent=!0,ym(105298813,"reachGoal","champ_vert_hard_".concat(this.players.length)))}!this.score100ChampVertSent&&this.scoreClass.score>=100&&(this.score100ChampVertSent=!0,ym(105298813,"reachGoal","score100_champ_vert_".concat(this.players.length)))}this.animateTops(),this.lampsAnimate(),this.gameClass.gameStarting&&(this.worldClass.night?("hor"==this.paramsClass.gameDir?this.audioClass.dayNight(!1):this.audioClass.dayNight(!1,"vert"),this.audioClass.dayNight(!1)):this.audioClass.dayNight(!0)),this.camera.position.x>this.objs.topPlanes.data[this.count-2].position.x&&(this.canShowAds=!1),this.boostHatModels.forEach(function(t,a,s){t.children[0].children[1].rotation.y+=.05,e.worldClass.night&&0==t.children[0].children[1].children[0].material.emissiveIntensity?t.children[0].children[1].children[0].material.emissiveIntensity=.1:e.worldClass.night||0==t.children[0].children[1].children[0].material.emissiveIntensity||(t.children[0].children[1].children[0].material.emissiveIntensity=0)}),this.angryBirdModel.position.set(this.angryBird.position.x,this.angryBird.position.y-.2,this.angryBird.position.z+.9),this.angryBirdModel.userData.mixer.update(this.angryBirdModel.userData.clock.getDelta()),this.birdYes&&(this.players[this.maxSpeed()].player.position.x>this.birdFlyingMark&&!this.angryBird.userData.flying&&!this.worldClass.thunder?(this.angryBird.userData.body.setTranslation({x:this.birdFlyingMark+this.bounds.rightX+this.distanceToBird,y:we(this.maxHeight-1.5,this.maxHeight+1),z:this.angryBird.userData.body.translation().z}),this.birdFlyingMark=this.birdFlyingMark+we(this.distanceToBird,this.distanceToBird+10),this.angryBird.userData.speed=we(8,13)/100,this.angryBird.userData.flying=!0):this.players[this.maxSpeed()].player.position.x>this.birdFlyingMark&&!this.angryBird.userData.flying&&this.worldClass.thunder&&(this.birdFlyingMark=this.birdFlyingMark+we(this.distanceToBird,this.distanceToBird+10)),this.angryBird.userData.flying&&(this.angryBird.userData.body.setNextKinematicTranslation({x:this.angryBird.userData.body.translation().x-=this.angryBird.userData.speed,y:this.angryBird.userData.body.translation().y,z:this.angryBird.userData.body.translation().z}),this.angryBird.userData.body.translation().x<this.players[this.maxSpeed()].player.position.x-20&&(this.angryBird.userData.body.setTranslation({x:this.birdFlyingMark+this.bounds.rightX+this.distanceToBird,y:20,z:this.angryBird.userData.body.translation().z}),this.angryBird.userData.flying=!1)))}},{key:"makeGlowSprite",value:function(){var e=new U(new Y({map:this._glowTex,transparent:!0,depthWrite:!1,blending:W}));return e.scale.set(10.4,10.4,10.4),e.renderOrder=20,e}},{key:"lampsAnimate",value:function(){var e=this,t=!1;if("hor"==this.paramsClass.gameDir)if(this.lightIntensity,this.worldClass.night&&!this.worldClass.thunder){this.lampsAnimate.did=!1;var a=this.camera.position.x-this.bounds.rightX/1.3,s=this.camera.position.x+.8*this.bounds.rightX;this.objs.plafons.data.forEach(function(i,n){i.pointLight;var o=i.position.x>=a&&i.position.x<=s,r=n;if(o&&!i.pointLight&&e.lights.length>0){var l=e.lights.shift();i.pointLight=l,i.glow=e.glowPool.pop()||e.makeGlowSprite(),e.scene.add(i.glow)}if(i.pointLight){var h=i.pointLight;h.position.set(e.objs.lamps.data[r].position.x,e.objs.lamps.data[r].position.y+1,e.objs.lamps.data[r].position.z+2),i.glow.position.set(e.objs.lamps.data[r].position.x,e.objs.lamps.data[r].position.y+1,e.objs.lamps.data[r].position.z+0);var d=o?e.lightIntensity:0;h.intensity=O.lerp(h.intensity,d,.15);var p=o?1:0;e._emissive[r]=O.lerp(e._emissive[r],p,.18),e.objs.bulbs.geometryBulb.attributes.aEmissive.needsUpdate=!0;var c=.5+.8*e._emissive[r];i.glow&&i.glow.scale.setScalar(c);var u=1+1.1*e._emissive[r],m=e.objs.bulbs.baseSize,b=e.objs.bulbs.data[r];b.userData._lastBulbFactor!==u&&(b.size.set(m.x*u,m.y*u,m.z*u),e.apply(r,e.objs.bulbs.data,e.objs.bulbs.bulb),b.userData._lastBulbFactor=u,t=!0),!o&&h.intensity<=.01&&e._emissive[r]<=.02&&(e.lights.push(h),i.pointLight=null,i.glow&&(e.glowPool.push(i.glow),e.scene.remove(i.glow),i.glow=null))}}),t&&(this.objs.bulbs.bulb.instanceMatrix.needsUpdate=!0)}else{var i,n=!1;if(this.objs.plafons.data.forEach(function(a,s){var i=a.pointLight;if(i){var o=e.objs.lamps.data[s].position;i.position.set(o.x,o.y+1,o.z+2),a.glow&&a.glow.position.set(o.x,o.y+1,o.z),i.intensity=O.lerp(i.intensity,0,.2),i.intensity<=.01&&(i.intensity=0,e.lights.push(i),a.pointLight=null,a.userData.light=!1,a.glow&&(e.scene.remove(a.glow),e.glowPool.push(a.glow),a.glow=null))}e.objs.plafons.plafon.setColorAt(s,e._dayColor),n=!0,e._emissive&&e._emissive.length>s&&(e._emissive[s]=0);var r=1+1.1*e._emissive[s],l=e.objs.bulbs.baseSize,h=e.objs.bulbs.data[s];h.userData._lastBulbFactor!==r&&(h.size.set(l.x*r,l.y*r,l.z*r),e.apply(s,e.objs.bulbs.data,e.objs.bulbs.bulb),h.userData._lastBulbFactor=r,t=!0)}),t&&(this.objs.bulbs.bulb.instanceMatrix.needsUpdate=!0),n)this.objs.plafons.plafon.instanceColor.needsUpdate=!0,null!==(i=this.objs.bulbs)&&void 0!==i&&null!==(i=i.geometryBulb)&&void 0!==i&&null!==(i=i.attributes)&&void 0!==i&&i.aEmissive&&(this.objs.bulbs.geometryBulb.attributes.aEmissive.needsUpdate=!0)}else if("vert"==this.paramsClass.gameDir)if(this.lightIntensity,this.worldClass.night){this.lampsAnimate.did=!1;var o=this.camera.position.y-this.bounds.topY/1,r=this.camera.position.y+.8*this.bounds.topY;this.objs.plafons.data.forEach(function(a,s){a.pointLight;var i=a.position.y>=o&&a.position.y<=r,n=s;if(i&&!a.pointLight&&e.lights.length>0){var l=e.lights.shift();a.pointLight=l,a.glow=e.glowPool.pop()||e.makeGlowSprite(),e.scene.add(a.glow)}if(a.pointLight){var h=a.pointLight;h.position.set(e.objs.lamps.data[n].position.x,e.objs.lamps.data[n].position.y+1,e.objs.lamps.data[n].position.z+2),a.glow.position.copy(a.position);var d=i?e.lightIntensity:0;h.intensity=O.lerp(h.intensity,d,.15);var p=i?1:0;e._emissive[n]=O.lerp(e._emissive[n],p,.18),e.objs.bulbs.geometryBulb.attributes.aEmissive.needsUpdate=!0;var c=.8+.8*e._emissive[n];a.glow&&a.glow.scale.setScalar(c);var u=1+1*e._emissive[n],m=e.objs.bulbs.baseSize,b=e.objs.bulbs.data[n];b.userData._lastBulbFactor!==u&&(b.size.set(m.x*u,m.y*u,m.z*u),e.apply(n,e.objs.bulbs.data,e.objs.bulbs.bulb),b.userData._lastBulbFactor=u,t=!0),!i&&h.intensity<=.01&&e._emissive[n]<=.02&&(e.lights.push(h),a.pointLight=null,a.glow&&(e.glowPool.push(a.glow),e.scene.remove(a.glow),a.glow=null))}}),t&&(this.objs.bulbs.bulb.instanceMatrix.needsUpdate=!0)}else{var l,h=!1;if(this.objs.plafons.data.forEach(function(t,a){var s=t.pointLight;(t.pointLight||0!==e._emissive[a])&&(s&&(s.intensity=O.lerp(s.intensity,0,1),s.intensity<=.01&&(s.intensity=0,e.lights.push(s),t.pointLight=null,t.userData.light=!1,t.glow&&(e.scene.remove(t.glow),e.glowPool.push(t.glow),t.glow=null))),e.objs.plafons.plafon.setColorAt(a,e._dayColor),h=!0,e._emissive&&e._emissive.length>a&&(e._emissive[a]=0))}),h)this.objs.plafons.plafon.instanceColor.needsUpdate=!0,null!==(l=this.objs.bulbs)&&void 0!==l&&null!==(l=l.geometryBulb)&&void 0!==l&&null!==(l=l.attributes)&&void 0!==l&&l.aEmissive&&(this.objs.bulbs.geometryBulb.attributes.aEmissive.needsUpdate=!0)}}},{key:"resetLevel",value:function(){}},{key:"maxSpeed",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(0===(e=t?this.players.filter(function(e,t,a){return e.player.userData.live}):this.players).length)return-1;var a,s=0;a="vert"==this.paramsClass.gameDir?e[0].player.position.y:e[0].player.position.x;for(var i=1;i<e.length;i++)e[i].player&&e[i].player.userData.live&&e[i].player.position&&("vert"==this.paramsClass.gameDir?e[i].player.position.y>a&&(a=e[i].player.position.y,s=i):e[i].player.position.x>a&&(a=e[i].player.position.x,s=i));return t?this.players.indexOf(e[s],0):s}},{key:"loadPlayers",value:(s=r(i().m(function e(){var t,s,n;return i().w(function(e){for(;;)switch(e.n){case 0:this.reloadLevel(),t=0;case 1:if(!(t<this.players.length)){e.n=4;break}return s=this.players[t],this.levelsMode||s.reLiveField(),s.player.position.x=s.player.position.x-1*t+1,this.physicsClass.addPhysicsToObject(s.player),"vert"==this.paramsClass.gameDir&&(s.player.position.y=-0,s.player.userData.collider.setFriction(500)),e.n=2,s.loadPlayerModel();case 2:s.player.userData.startPos=s.player.position.clone(),this.scene.add(s.player),this.scene.add(s.playerOut),this.scene.add(s.playerModel),this.playerOuts.push(s.playerOut),t<this.players[0].playerColors.length?s.head.children[0].material.color.set(this.players[0].playerColors[t]):(n=this.players[0].playerColors).splice.apply(n,[this.players[0].playerColors.length,0].concat(a(this.players[0].playerColors))),s.player.userData.audio.push(this.audioClass.readyJumpAudio.clone()),this.audioClass.quacks.length>t?s.player.userData.audio.push(this.audioClass.quacks[t].clone()):s.player.userData.audio.push(this.audioClass.quacks[0].clone());case 3:t++,e.n=1;break;case 4:this.playersLoaded=!0;case 5:return e.a(2)}},e,this)})),function(){return s.apply(this,arguments)})},{key:"cameraMove",value:function(e,t){var a=Math.min(.033,Math.max(.001,t||1/60));switch(this.gameNum){case 1:this.gameClass.gameStarting&&(e.position.x+=3*this.cameraSpeed),this.cameraSpeed+=1e-6,e.position.y=this.isMobile?2.5:3,e.position.z=this.isMobile?25:30,e.lookAt(e.position.x,e.position.y-2,0);break;case 2:var s=Math.max(0,this.maxSpeed(!0));if(s>=0&&!this.worldClass.thunder||this.levelsMode){var i,n,o=0;1===this.players.filter(function(e){return e.player.userData.live}).length?"hor"===this.paramsClass.gameDir&&(o=this.players[s].player.position.x+this.bounds.rightX/2):o=this.players[s].player.position.x;var r=0,l=(null===(i=this.players[s])||void 0===i||null===(i=i.player)||void 0===i||null===(i=i.userData)||void 0===i?void 0:i.body)||(null===(n=this.players[s])||void 0===n||null===(n=n.player)||void 0===n||null===(n=n.userData)||void 0===n?void 0:n.collider);if(l&&l.linvel)r=l.linvel().x||0;var h=o+O.clamp(r*this.cam.lookAheadSeconds,-this.cam.lookAheadMax,this.cam.lookAheadMax);this.cam.targetX=this.dampScalar(this.cam.targetX,h,this.cam.targetFilterLambda,a),this.cam.targetX<e.position.x-this.cam.maxBackJump&&(this.cam.targetX=e.position.x-this.cam.maxBackJump);var d=this.smoothDamp(e.position.x,this.cam.targetX,this.cam.velocityX,this.cam.smoothTime,1/0,a);e.position.x=d.newPos,this.cam.velocityX=d.newVel,e.position.y=this.isMobile?2.5:3,e.position.z=this.isMobile?25:30,e.lookAt(e.position.x,e.position.y-2,0)}else this.gameClass.gameStarting&&(e.position.x+=2*this.cameraSpeed),e.position.y=(this.isMobile,3),e.position.z=this.isMobile?25:30,e.lookAt(e.position.x,e.position.y-2,0);break;case 3:this.gameClass.gameStarting&&(e.position.y+=this.cameraSpeed),e.position.x=0,e.position.z=this.isMobile?25:35,this.cameraSpeed+=1e-6,e.lookAt(e.position.x,e.position.y-2,0);break;case 4:this.gameClass.gameStarting&&this.playersLoaded&&this.players[this.maxSpeed()].player.userData.body.linvel().y>-20&&(e.position.y=this.players[this.maxSpeed()].player.position.y+3.5),e.position.x=0,e.position.z=this.isMobile?25:35,e.lookAt(e.position.x,e.position.y-2,0),this.mks.material.opacity=this.worldClass.blackSky.material.opacity,e.position.y>20&&(this.mks.position.x-=.02)}}},{key:"damp",value:function(e,t,a,s){return e+(t-e)*(1-Math.exp(-a*s))}},{key:"spring",value:function(e,t,a,s,i){var n=2/s,o=n*i,r=1/(1+o+.48*o*o+.235*o*o*o),l=e-t,h=(a+n*l)*i;return{newPos:t+(l+h)*r,newVel:(a-n*h)*r}}},{key:"smoothDamp",value:function(e,t,a,s,i,n){var o=2/(s=Math.max(1e-6,s)),r=o*n,l=1/(1+r+.48*r*r+.235*r*r*r),h=e-t,d=(i>0?i:1/0)*s,p=(a+o*(h=O.clamp(h,-d,d)))*n;return{newPos:t+(h+p)*l,newVel:(a-o*p)*l}}},{key:"dampScalar",value:function(e,t,a,s){return e+(t-e)*(1-Math.exp(-a*s))}},{key:"showPopupInGame",value:(t=r(i().m(function e(){var t,a,s,n,o,l,h,d,p,c,u=this,m=arguments;return i().w(function(e){for(;;)switch(e.n){case 0:if(t=m.length>0&&void 0!==m[0]&&m[0],this.hideScreen("popup_game_btn_close"),this.hideScreen("menu_in_game"),!t||!this.canShowAds||this.levelsMode||this.gameClass.pause?this.hideScreen("popup_game_btn1"):!t&&!this.canShowAds||this.levelsMode||this.gameClass.pause||this.showScreen("popup_game_btn1"),this.levelsMode?this.showScreen("popup_game_btn4"):this.hideScreen("popup_game_btn4"),this.startAfterReset=!1,a=0,this.scoreClass.score>this.scoreClass.myRec&&(this.scoreClass.myRec=this.scoreClass.score,a++),this.scoreClass.score>this.scoreClass.worldRec&&(this.scoreClass.worldRec=this.scoreClass.score,a++),!a){e.n=6;break}if("hor"!==this.paramsClass.gameDir){e.n=2;break}return s=this.dataClass.table.hor[this.players.length-1],(n=s.find(Ue))&&(n.rec=this.scoreClass.score),e.n=1,this.dataClass.submitMyScore(ysdk,"ocean".concat(this.players.length),this.scoreClass.score);case 1:e.n=3;break;case 2:if("vert"!==this.paramsClass.gameDir){e.n=3;break}return o=this.dataClass.table.vert[this.players.length-1],(l=o.find(Ue))&&(l.rec=this.scoreClass.score),e.n=3,this.dataClass.submitMyScore(ysdk,"space".concat(this.players.length),this.scoreClass.score);case 3:return e.n=4,this.dataClass.saveTableToCloud();case 4:return h="hor"===this.paramsClass.gameDir?"hor":"vert",d=this.players.length-1,this.dataClass.updateLocalTop3(h,d,this.scoreClass.myRec),e.n=5,this.dataClass.refreshMineLabels();case 5:this.menuClass.loadRecsData(),"hor"===this.paramsClass.gameDir?this.scoreClass.loadRecsToHud(0,this.players.length-1):this.scoreClass.loadRecsToHud(1,this.players.length-1);case 6:if(this.audioClass.oceanAudio.isPlaying&&this.audioClass.oceanAudio.stop(),this.audioClass.rainAudio.isPlaying&&this.audioClass.rainAudio.stop(),this.gameClass.pause){e.n=15;break}if(this.gameClass.showGamePopup=!0,this.levelsMode){e.n=7;break}document.querySelector(".popup_in_game_wrap").classList.remove("popup_in_game_wrap_win"),this.audioClass.looseAudio.isPlaying&&this.audioClass.looseAudio.stop(),this.audioClass.musicOn&&this.audioClass.looseAudio.play(),e.n=14;break;case 7:if(!(this.players.every(function(e){return e.player.userData.finish})&&"coop"==this.dataClass.levelCoopMode||this.players.some(function(e){return e.player.userData.finish})&&"contest"==this.dataClass.levelCoopMode)){e.n=13;break}if(document.querySelector(".popup_in_game_wrap").classList.add("popup_in_game_wrap_win"),this.audioClass.winAudio.isPlaying&&this.audioClass.winAudio.stop(),this.audioClass.musicOn&&this.audioClass.winAudio.play(),this.levelsMode<this.allLevels&&this.showScreen("popup_game_btn15"),this.hideScreen("popup_game_btn4"),"coop"!=this.dataClass.levelCoopMode){e.n=11;break}if(p=!1,c=!1,this.levelsPlayedTracked.has(this.levelsMode)||(this.levelsPlayedTracked.add(this.levelsMode),ym(105298813,"reachGoal","level_coop_".concat(this.levelsMode,"_").concat(this.players.length))),this.players.forEach(function(e,t,a){u.levelsMode==u.allLevels&&(u.dataClass.table.player.bonusHeart[t]=10,p=!0),u.levelsMode+1>u.dataClass.table.player.levels[t]&&(u.dataClass.table.player.levels[t]=u.levelsMode,c=!0)}),!p&&!c){e.n=10;break}return e.n=8,this.dataClass.saveTableToCloud();case 8:return e.n=9,this.dataClass.loadTableFromCloud();case 9:return e.n=10,this.dataClass.loadLevels(this.players.length-1);case 10:e.n=12;break;case 11:"contest"==this.dataClass.levelCoopMode&&(this.levelsContestPlayedTracked.has(this.levelsMode)||(this.levelsContestPlayedTracked.add(this.levelsMode),ym(105298813,"reachGoal","level_contest_".concat(this.levelsMode,"_").concat(this.players.length))),this.players.forEach(function(){var e=r(i().m(function e(t,a,s){return i().w(function(e){for(;;)switch(e.n){case 0:if(!t.player.userData.finish){e.n=1;break}if(u.dataClass.table.levelsStatusContest[u.levelsMode-1]==a+1){e.n=1;break}return u.dataClass.table.levelsStatusContest[u.levelsMode-1]=a+1,e.n=1,u.dataClass.saveTableToCloud();case 1:return e.a(2)}},e)}));return function(t,a,s){return e.apply(this,arguments)}}()));case 12:this.dataClass.loadLevels(this.players.length-1),e.n=14;break;case 13:this.hideScreen("popup_game_btn15"),document.querySelector(".popup_in_game_wrap").classList.remove("popup_in_game_wrap_win");case 14:e.n=16;break;case 15:document.querySelector(".popup_in_game_wrap").classList.add("popup_in_game_wrap_win"),this.hideScreen("popup_game_btn15");case 16:this.showScreen("popup_in_game"),this.gameClass.gameStarting=!1;case 17:return e.a(2)}},e,this)})),function(){return t.apply(this,arguments)})},{key:"reloadLevel",value:(e=r(i().m(function e(){var t,a,s,n,o,r,l,h=arguments;return i().w(function(e){for(;;)switch(e.n){case 0:if(t=h.length>0&&void 0!==h[0]?h[0]:-1,"hor"!=this.paramsClass.gameDir||this.levelsMode){e.n=1;break}if(a=!1,t>=0)s=this.players[t],this.dataClass.table.player.bonusHeart[t]?(s.player.userData.maxLives=4,s.player.userData.lives=s.player.userData.maxLives,s.player.userData.bonusHeart=this.dataClass.table.player.bonusHeart[t],this.dataClass.table.player.bonusHeart[t]--,a=!0):(s.player.userData.maxLives=3,s.player.userData.lives=s.player.userData.maxLives);else for(n=[0,-1,1],o=0;o<this.players.length;o++)r=this.players[o],l=Math.floor(Math.random()*n.length),this.levelsMode?r.player.position.x=n[l]:(r.reLiveField(),r.player.position.x=r.player.position.x-.3*o+1),n.splice(l,1),this.dataClass.table.player.bonusHeart[o]?(r.player.userData.maxLives=4,r.player.userData.lives=r.player.userData.maxLives,r.player.userData.bonusHeart=this.dataClass.table.player.bonusHeart[o],this.dataClass.table.player.bonusHeart[o]--,a=!0):(r.player.userData.maxLives=3,r.player.userData.lives=r.player.userData.maxLives),this.levelsMode||r.reLiveField();if(!a){e.n=1;break}return e.n=1,this.dataClass.saveTableToCloud();case 1:return e.a(2)}},e,this)})),function(){return e.apply(this,arguments)})},{key:"rebindButton",value:function(e,t){var a=document.querySelector(e),s=a.cloneNode(!0);return a.parentNode.replaceChild(s,a),s.addEventListener("click",t),s}},{key:"hideScreen",value:function(e){document.querySelector(".".concat(e)).classList.add("hidden_screen")}},{key:"showScreen",value:function(e){document.querySelector(".".concat(e)).classList.remove("hidden_screen")}}]);var e,t,s,n,o,h,p}(),We=function(){function e(t,a){l(this,e),this.world=t,this.RAPIER=a,this.dynamicBodies=[],this.allWallBodyCollision=[],this.playersHandles=[],this.allTops=[],this.instancedBodies=[],this._dummy=new N}return d(e,[{key:"addInstancedDynamic",value:function(t,a,s){var i,n,o=e._toVec3(s.size),r=e._toVec3(null!==(i=s.position)&&void 0!==i?i:{x:0,y:0,z:0}),l=null!==(n=s.quaternion)&&void 0!==n&&n.isQuaternion?s.quaternion:new P,h=this.world.createRigidBody(this.RAPIER.RigidBodyDesc.dynamic().setTranslation(r.x,r.y,r.z).setRotation({x:l.x,y:l.y,z:l.z,w:l.w})),d=this.RAPIER.ColliderDesc.cuboid(o.x/2,o.y/2,o.z/2).setFriction(.6).setRestitution(.1);this.world.createCollider(d,h),this.instancedBodies.push({mesh:t,index:a,size:o,body:h})}},{key:"addInstancedStatic",value:function(t,a,s,i){var n,o,r=e._toVec3(i.size),l=e._toVec3(null!==(n=i.position)&&void 0!==n?n:{x:0,y:0,z:0}),h=null!==(o=i.quaternion)&&void 0!==o&&o.isQuaternion?i.quaternion:new P,d=this.world.createRigidBody(this.RAPIER.RigidBodyDesc.kinematicPositionBased().setTranslation(l.x,l.y,l.z).setRotation({x:h.x,y:h.y,z:h.z,w:h.w})),p=this.RAPIER.ColliderDesc.cuboid(r.x/2,r.y/2,r.z/2).setFriction(1.6).setRestitution(0);t[s].userData.body=d,t[s].userData.shape=p,t[s].userData.collide=this.world.createCollider(p,d),this.instancedBodies.push({mesh:a,index:s,size:r,body:d})}},{key:"updateInstancedTransforms",value:function(){var t,a=this._dummy,s=new Set,i=c(this.instancedBodies);try{for(i.s();!(t=i.n()).done;){var n=t.value,o=e._ensureInvBase(n.mesh),r=n.body.translation(),l=n.body.rotation();a.position.set(r.x,r.y,r.z),a.quaternion.set(l.x,l.y,l.z,l.w),a.scale.set(n.size.x*o.x,n.size.y*o.y,n.size.z*o.z),a.updateMatrix(),n.mesh.setMatrixAt(n.index,a.matrix),s.add(n.mesh)}}catch(p){i.e(p)}finally{i.f()}var h,d=c(s);try{for(d.s();!(h=d.n()).done;){h.value.instanceMatrix.needsUpdate=!0}}catch(p){d.e(p)}finally{d.f()}}},{key:"addPhysicsToObject",value:function(e){if(null!=e&&e.userData.name.includes("player")){var t,a,s=e.rotation.clone();e.rotation.set(0,0,0),(new _).setFromObject(e);var i=Ve(e);e.rotation.copy(s),e.userData.size=i,e.userData.orgRotation=s,t=this.world.createRigidBody(this.RAPIER.RigidBodyDesc.dynamic().setTranslation(e.position.x,e.position.y,e.position.z).setRotation(e.quaternion).setCanSleep(!1).enabledRotations(!1,!1,!1).setLinearDamping(0).setAngularDamping(2)),a=this.RAPIER.ColliderDesc.cuboid(i.x/2,i.y/2,i.z/2).setMass(.6).setRestitution(0).setFriction(.5).setActiveEvents(this.RAPIER.ActiveEvents.COLLISION_EVENTS),e.userData.body=t,e.userData.shape=a;var n=t;a.setActiveEvents(this.RAPIER.ActiveEvents.COLLISION_EVENTS);var o=this.world.createCollider(a,t);e.userData.collider=o,e.userData.handle=n.handle,this.playersHandles.push(n.handle),this.dynamicBodies.push([e,t,e.id])}else if(null!=e&&e.userData.name.includes("tops")){var r,l,h=e.rotation.clone();e.rotation.set(0,0,0),(new _).setFromObject(e);var d=Ve(e);e.rotation.copy(h),e.userData.size=d,e.userData.orgRotation=h,r=this.world.createRigidBody(this.RAPIER.RigidBodyDesc.kinematicPositionBased().setTranslation(e.position.x,e.position.y,e.position.z).setRotation(e.quaternion).setCanSleep(!1).enabledRotations(!1,!1,!1).setLinearDamping(0).setAngularDamping(2)),(l=this.RAPIER.ColliderDesc.cuboid(d.x/2,d.y/2,d.z/2).setMass(1).setRestitution(0).setFriction(.3)).setActiveEvents(this.RAPIER.ActiveEvents.COLLISION_EVENTS);var p=this.world.createCollider(l,r);e.userData.body=r,e.userData.collide=p,this.allWallBodyCollision.push(p),e.userData.handle=r.handle,this.dynamicBodies.push([e,r,e.id]),e.userData.playerHandlesInside=new Set,this.allTops.push(e)}else if(null!=e&&e.userData.name.includes("bird")){var c,u,m=e.rotation.clone();e.rotation.set(0,0,0),(new _).setFromObject(e);var b=Ve(e);e.rotation.copy(m),e.userData.size=b,e.userData.orgRotation=m,c=this.world.createRigidBody(this.RAPIER.RigidBodyDesc.kinematicPositionBased().setTranslation(e.position.x,e.position.y,e.position.z).setRotation(e.quaternion).setCanSleep(!1).enabledRotations(!1,!1,!1).setLinearDamping(0).setAngularDamping(2)),(u=this.RAPIER.ColliderDesc.cuboid(b.x/2,b.y/2,b.z/2).setMass(1).setRestitution(1).setFriction(0)).setActiveEvents(this.RAPIER.ActiveEvents.COLLISION_EVENTS);var g=this.world.createCollider(u,c);e.userData.body=c,e.userData.collide=g,this.allWallBodyCollision.push(g),e.userData.handle=c.handle,this.dynamicBodies.push([e,c,e.id])}}}],[{key:"_ensureInvBase",value:function(e){if(e.userData.invBase)return e.userData.invBase;var t=e.geometry;t.computeBoundingBox();var a=new x;t.boundingBox.getSize(a);var s=new x(1/(a.x||1),1/(a.y||1),1/(a.z||1));return e.userData.invBase=s,s}},{key:"_toVec3",value:function(e){var t,a,s;return"number"==typeof e?new x(e,e,e):null!=e&&e.isVector3?e.clone():new x(null!==(t=null==e?void 0:e.x)&&void 0!==t?t:1,null!==(a=null==e?void 0:e.y)&&void 0!==a?a:1,null!==(s=null==e?void 0:e.z)&&void 0!==s?s:1)}}])}(),Oe=new x;function Ve(e){if(e.isMesh&&e.geometry){var t=e.geometry;return t.boundingBox||t.computeBoundingBox(),t.boundingBox.getSize(Oe),Oe.multiply(e.scale),Oe.clone()}return(new _).setFromObject(e).getSize(new x)}var Ke=function(){return d(function e(){l(this,e),this.backAudio,this.backAudio2,this.backAudio3,this.oceanAudio,this.rainAudio,this.thunderAudio,this.thunderAudio2,this.thunderAudio3,this.thundersAudio=[],this.inwaterAudio,this.takeAudio,this.looseAudio,this.winAudio,this.readyJumpAudio,this.jumpAudio,this.jumpAudio2,this.jumpAudio3,this.quacks=[],this.musics=[],this.musicNowPlaying=[],this.musicDay=!0,this.musicNight=!1,this.timeToChange=2,this._attached=!1,this.listener=new V,this.musicOn=!0},[{key:"hardStopAll",value:function(){this.musics.forEach(function(e){var t=e.music;try{t.stop()}catch(a){}}),this.quacks.forEach(function(e){try{e.stop()}catch(t){}}),this.thundersAudio.forEach(function(e){try{e.music.stop()}catch(t){}}),this.musicNowPlaying=[]}},{key:"toggleMute",value:function(e){e?(this.musicOn=!1,this.listener.context.suspend()):(this.musicOn=!0,this.listener.context.resume(),this.playMusic(["back"]))}},{key:"isMuted",value:function(){return"suspended"===this.listener.context.state}},{key:"attachTo",value:function(e){this._attached||(e.add(this.listener),this._attached=!0)}},{key:"loadAudio",value:(e=r(i().m(function e(){var t,a,s=this;return i().w(function(e){for(;;)switch(e.n){case 0:return t=new K,a=[{key:"backAudio",name:"back1",path:"audio/back1.mp3",loop:!0,ref:100,vol:2},{key:"backAudio2",name:"back2",path:"audio/back2.mp3",loop:!0,ref:100,vol:2},{key:"backAudio3",name:"back3",path:"audio/back3.mp3",loop:!0,ref:100,vol:.5},{key:"oceanAudio",name:"ocean",path:"audio/ocean.mp3",loop:!0,ref:100,vol:.4},{key:"inwaterAudio",name:"inwater",path:"audio/inwater.mp3",loop:!1,ref:200,vol:1},{key:"looseAudio",name:"loose",path:"audio/loose.mp3",loop:!1,ref:200,vol:1},{key:"winAudio",name:"win",path:"audio/win.mp3",loop:!1,ref:200,vol:2},{key:"takeAudio",name:"take",path:"audio/take.mp3",loop:!1,ref:200,vol:2},{key:"readyJumpAudio",name:"readyJump",path:"audio/ready-jump.mp3",loop:!1,ref:1e3,vol:200,rate:2},{key:"jumpAudio",name:"quack1",path:"audio/quack1.mp3",loop:!1,ref:2e3,vol:2,quack:!0},{key:"jumpAudio2",name:"quack2",path:"audio/quack2.mp3",loop:!1,ref:400,vol:.3,quack:!0},{key:"jumpAudio3",name:"quack3",path:"audio/quack3.mp3",loop:!1,ref:400,vol:.3,quack:!0},{key:"rainAudio",name:"rain",path:"audio/rain.mp3",loop:!0,ref:400,vol:1.5},{key:"thunderAudio",name:"thunder1",path:"audio/thunder.mp3",loop:!1,ref:400,vol:1,thunder:!0},{key:"thunderAudio2",name:"thunder2",path:"audio/thunder2.mp3",loop:!1,ref:400,vol:1,thunder:!0},{key:"thunderAudio3",name:"thunder3",path:"audio/thunder3.mp3",loop:!1,ref:400,vol:1,thunder:!0}],e.n=1,Promise.all(a.map(function(e){return t.loadAsync(e.path).catch(function(t){return console.error("ÐžÑˆÐ¸Ð±ÐºÐ° Ð¿Ñ€Ð¸ Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐµ ".concat(e.path,":"),t),null})}));case 1:e.v.forEach(function(e,t){var i=a[t];if(e){var n=new J(s.listener);n.setBuffer(e),n.setLoop(i.loop),n.setRefDistance(i.ref),n.setVolume(i.vol),i.rate&&n.setPlaybackRate(i.rate),s[i.key]=n,s.musics.push({name:i.name,music:n}),i.quack&&s.quacks.push(n),i.thunder&&s.thundersAudio.push({name:i.name,music:n})}}),this.backAudio&&this.musics.push({name:"back",music:this.backAudio});case 2:return e.a(2)}},e,this)})),function(){return e.apply(this,arguments)})},{key:"stopMusic",value:function(e){var t=this;this.musicOn&&(0==e?this.musics.forEach(function(e,t,a){e.music.stop()}):e.forEach(function(e,a,s){t.musics.find(function(t){return t.name===e}).music.stop()}))}},{key:"pauseMusic",value:function(e){var t=this;this.musicOn&&e.forEach(function(e,a,s){t.musics.find(function(t){return t.name===e}).music.pause()})}},{key:"playMusic",value:function(e){var t=this;e.forEach(function(e,a,s){var i=t.musics.find(function(t){return t.name===e}).music;!i.isPlaying&&t.musicOn&&i.play()})}},{key:"togglePauseAll",value:function(e){var t=this;this.musicOn&&(e?(this.musicNowPlaying=[],this.musics.forEach(function(e){var a=e.music;a.isPlaying&&(a.pause(),t.musicNowPlaying.push(a))})):this.musicNowPlaying&&this.musicNowPlaying.length&&(this.musicNowPlaying.forEach(function(e){e.isPlaying||e.play()}),this.musicNowPlaying=[]))}},{key:"dayNight",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e&&!this.musicDay?this.timeToChange>0?(this.timeToChange-=.01,this.musics.find(function(e){return"back"===e.name}).music.setVolume(this.timeToChange)):(this.timeToChange=0,this.stopMusic(["back"]),this.musics.find(function(e){return"back"===e.name}).music.setVolume(2),this.musics.find(function(e){return"back"===e.name}).music=this.musics.find(function(e){return"back1"===e.name}).music,this.musicOn&&this.playMusic(["back"]),this.musicNight=!1,this.musicDay=!0,this.timeToChange=2,this.musics.find(function(e){return"back"===e.name}).music.setVolume(this.timeToChange)):e||this.musicNight||(this.timeToChange>0?(this.timeToChange-=.01,this.musics.find(function(e){return"back"===e.name}).music.setVolume(this.timeToChange)):(this.timeToChange=0,this.stopMusic(["back"]),this.musics.find(function(e){return"back"===e.name}).music.setVolume(2),this.musics.find(function(e){return"back"===e.name}).music=this.musics.find(function(e){return t?"back3"===e.name:"back2"===e.name}).music,this.musicOn&&this.playMusic(["back"]),this.musicNight=!0,this.musicDay=!1,this.timeToChange=2,this.musics.find(function(e){return"back"===e.name}).music.setVolume(this.timeToChange)))}}]);var e}(),Je=function(){return d(function e(t,a,s,i,n,o){l(this,e),this.levelClass=t,this.isMobile=a,this.renderer=s,this.camera=i,this.paramsClass=n,this.audioClass=o,this.mouse=new x,this.raycaster=new X,this.onTapDown=this.onTapDown.bind(this),this.onTapUp=this.onTapUp.bind(this),this.onKeyDown=this.onKeyDown.bind(this),this.onKeyUp=this.onKeyUp.bind(this)},[{key:"addKeyListeners",value:function(){var e=this.renderer.domElement;window.addEventListener("keydown",this.onKeyDown),window.addEventListener("keyup",this.onKeyUp),e.addEventListener("mousedown",this.onKeyDown),e.addEventListener("mouseup",this.onKeyUp),e.addEventListener("touchstart",this.onTapDown,{passive:!1}),e.addEventListener("touchend",this.onTapUp)}},{key:"removedKeyListeners",value:function(){var e=this.renderer.domElement;window.removeEventListener("keydown",this.onKeyDown),window.removeEventListener("keyup",this.onKeyUp),e.removeEventListener("mousedown",this.onKeyDown),e.removeEventListener("mouseup",this.onKeyUp),e.removeEventListener("touchstart",this.onTapDown),e.removeEventListener("touchend",this.onTapUp)}},{key:"onTapDown",value:function(e){var t=this.renderer.domElement.getBoundingClientRect();e=e.changedTouches[0],this.mouse.x=(e.clientX-t.left)/t.width*2-1,this.mouse.y=-(e.clientY-t.top)/t.height*2+1,this.raycaster.setFromCamera(this.mouse,this.camera),1==this.levelClass.players.length?this.downKeys(this.levelClass.players[0].player):2==this.levelClass.players.length?this.mouse.x>0?this.downKeys(this.levelClass.players[0].player):this.downKeys(this.levelClass.players[1].player):3==this.levelClass.players.length&&(this.mouse.x>0?this.downKeys(this.levelClass.players[0].player):this.mouse.y<0?this.downKeys(this.levelClass.players[1].player):this.downKeys(this.levelClass.players[2].player))}},{key:"onTapUp",value:function(e){var t=this.renderer.domElement.getBoundingClientRect();e=e.changedTouches[0],this.mouse.x=(e.clientX-t.left)/t.width*2-1,this.mouse.y=-(e.clientY-t.top)/t.height*2+1,this.raycaster.setFromCamera(this.mouse,this.camera),1==this.levelClass.players.length?this.upKeys(this.levelClass.players[0].player):2==this.levelClass.players.length?this.mouse.x>0?this.upKeys(this.levelClass.players[0].player):this.upKeys(this.levelClass.players[1].player):3==this.levelClass.players.length&&(this.mouse.x>0?this.upKeys(this.levelClass.players[0].player):this.mouse.y<0?this.upKeys(this.levelClass.players[1].player):this.upKeys(this.levelClass.players[2].player))}},{key:"onKeyDown",value:function(e){switch(e.code){case void 0:this.isMobile||this.downKeys(this.levelClass.players[0].player);break;case"KeyW":case"ArrowUp":break;case"KeyZ":case"ArrowDown":this.levelClass.players.length>1&&this.downKeys(this.levelClass.players[1].player);break;case"KeyM":case"ArrowLeft":this.levelClass.players.length>2&&this.downKeys(this.levelClass.players[2].player);break;case"KeyD":case"ArrowRight":break;case"KeyP":this.renderer.setPixelRatio(1)}}},{key:"onKeyUp",value:function(e){switch(e.code){case void 0:this.isMobile||this.upKeys(this.levelClass.players[0].player);break;case"KeyW":case"ArrowUp":break;case"KeyZ":case"ArrowDown":this.levelClass.players.length>1&&this.upKeys(this.levelClass.players[1].player);break;case"KeyM":case"ArrowLeft":this.levelClass.players.length>2&&this.upKeys(this.levelClass.players[2].player)}}},{key:"downKeys",value:function(e){e.userData.live&&(e.userData.onGround||e.userData.canFly)&&(!e.userData.readyJump&&this.audioClass.musicOn&&e.userData.audio[0].play(),e.userData.readyJump=!0)}},{key:"upKeys",value:function(e){var t=this;e.userData.live&&(e.userData.canFly&&!e.userData.onGround&&e.userData.canFlyJumps>0&&(e.userData.canFlyJumps--,0==e.userData.canFlyJumps&&setTimeout(function(){e.userData.canFly=!1,t.levelClass.boostHatModels[e.userData.canFlyNum].userData.fly=!1},1e3)),e.userData.readyJump&&e.userData.onGround?(e.userData.jumping=!0,e.userData.readyJump=!1,e.userData.audio[0].stop(),!e.userData.audio[1].isPlaying&&this.audioClass.musicOn&&e.userData.audio[1].play(),e.userData.onGround=!1):e.userData.onGround||(e.userData.canFly?(e.userData.jumping=!0,e.userData.readyJump=!1,e.userData.audio[0].stop(),!e.userData.audio[1].isPlaying&&this.audioClass.musicOn&&e.userData.audio[1].play(),e.userData.onGround=!1,e.userData.hatBoost--,0==e.userData.hatBoost&&(e.userData.canFly=!1,setTimeout(function(){t.levelClass.boostHatModels[e.userData.numHatBoost].userData.fly=!1},500))):(e.userData.readyJump=!1,e.userData.audio[0].stop())))}}])}(),Xe=function(){return d(function e(t,a,s,i,n,o){l(this,e),this.scene=t,this.camera=a,this.renderer=s,this.paramsClass=i,this.isMobile=n,this.audioClass=o,this.ambientLight=new Q(11184810,1),this.hemiLight=new Z(16777215,16777215,2),this.hemiLight.groundColor.setHSL(.095,1,.75),this.hemiLight.position.set(0,10,0),this.dirLight=new $(16777215,2),this.dirLight.position.set(0,5,5),this.dirLight.castShadow=!0,this.dirLight.shadow.camera.far=100,this.topLight=1e3,this.targetObject=new N,this.dirLight.target=this.targetObject,this.helper=new ee(this.dirLight,3),this.water,this.night=!1,this._prevCamX=this.camera.position.x,this.thunder=!1,this.thunderStart=!1,this.isThunderActive=!1,this.thunderEndTimestampMs=0,this.nextThunderFlashTimestampMs=0,this.minThunderIntervalMs=1e3,this.maxThunderIntervalMs=3e3,this.currentThunderIndex=0,this.rain=!1,this.rainStart=!1,this.isRainActive=!1,this.rainEndTimestampMs=0,this.activeLightningLines=[],this.lightningMaterialBase=new te({color:16777215,transparent:!0,opacity:1,blending:W,depthWrite:!1}),this.clock=new I,this.deltaSeconds,this.lightningFade=0,this.rainDropCount=1500,this.rainAreaHalfWidth=10,this.rainAreaHalfDepth=22,this.rainTopY=7,this.rainBottomY=-2,this.rainGeometry=new h,this.rainPositions=new Float32Array(3*this.rainDropCount),this.rainVelocities=new Float32Array(this.rainDropCount),this.rainWindPhase=new Float32Array(this.rainDropCount)},[{key:"loadRain",value:(a=r(i().m(function e(){var t,a,s,n,o;return i().w(function(e){for(;;)switch(e.n){case 0:for(t=0;t<this.rainDropCount;t++)a=3*t,this.rainPositions[a+0]=(Math.random()-.5)*this.rainAreaHalfWidth*2,this.rainPositions[a+1]=Math.random()*(this.rainTopY-this.rainBottomY)+this.rainBottomY,this.rainPositions[a+2]=(Math.random()-.5)*this.rainAreaHalfDepth*2-35,this.rainVelocities[t]=10+10*Math.random(),this.rainWindPhase[t]=Math.random()*Math.PI*20;for(s=new Float32Array(3*this.rainDropCount),n=0;n<this.rainDropCount;n++)o=.8+.2*Math.random(),s[3*n+0]=.7*o,s[3*n+1]=.8*o,s[3*n+2]=1*o;this.rainGeometry.setAttribute("position",new p(this.rainPositions,3)),this.rainGeometry.setAttribute("color",new p(s,3)),this.rainStreakTex=this.makeRainStreakTexture(),this.rainMaterial=new u({color:8947916,vertexColors:!0,map:this.rainStreakTex,alphaTest:.79,transparent:!0,opacity:.96,size:.18,sizeAttenuation:!0,depthWrite:!0,blending:W}),this.rainPoints=new b(this.rainGeometry,this.rainMaterial),this.rainPoints.layers.set(1);case 1:return e.a(2)}},e,this)})),function(){return a.apply(this,arguments)})},{key:"loadWaterSky",value:(t=r(i().m(function e(){var t,a,s,n,o,r,l,d;return i().w(function(e){for(;;)switch(e.n){case 0:for(this.waterGeometry=new g(900,500),this.water=new ae(this.waterGeometry,{textureWidth:500,textureHeight:500,waterNormals:(new se).load("textures/waternormals.jpg",function(e){e.wrapS=e.wrapT=G}),sunDirection:new x,sunColor:16755370,waterColor:7759,distortionScale:.5,fog:void 0!==this.scene.fog}),this.water.rotation.x=-Math.PI/2,this.water.position.x=200,this.isMobile,this.water.position.y=-2,this.sun=new x,this.sky=new ie,this.sky.scale.setScalar(1e4),this.scene.add(this.sky),(t=this.sky.material.uniforms).turbidity.value=1,t.rayleigh.value=3,t.mieCoefficient.value=5e-4,t.mieDirectionalG.value=.8,this.parameters={elevation:5,azimuth:170,top:!1},this.blackSky=new v(new g(1e4,1e4),new y({color:526362,side:A,transparent:!0,opacity:0})),this.blackSky.position.z=-1e3,this.scene.add(this.blackSky),a=1500,s=new Float32Array(4500),n=new Float32Array(a),o=new Float32Array(4500),r=0;r<a;r++)s[3*r]=600*Math.random()-300,s[3*r+1]=150*Math.random()-100,s[3*r+2]=300*Math.random()-500,n[r]=2*Math.random()+.7,l=(new L).setHSL(.5+.1*Math.random(),.6+.3*Math.random(),.85+.15*Math.random()),o[3*r]=l.r,o[3*r+1]=l.g,o[3*r+2]=l.b;(d=new h).setAttribute("position",new p(s,3)),d.setAttribute("size",new p(n,1)),d.setAttribute("color",new p(o,3)),this.materialStars=new ne({uniforms:{time:{value:0},opacity:{value:0}},vertexShader:"\n  attribute float size;\n  varying vec3 vColor;\n  varying float vRandom;\n\n  void main() {\n    vColor = color;\n    vRandom = size;\n    vec4 mvPosition = modelViewMatrix * vec4(position, 1.0);\n    gl_PointSize = size * (300.0 / -mvPosition.z); // Ð¼Ð°ÑÑˆÑ‚Ð°Ð±Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð¿Ð¾ Ð¿ÐµÑ€ÑÐ¿ÐµÐºÑ‚Ð¸Ð²Ðµ\n    gl_Position = projectionMatrix * mvPosition;\n  }\n",fragmentShader:"\n  uniform float opacity;\nvarying vec3 vColor;\nvarying float vRandom;\nuniform float time;\n\nvoid main() {\n  float dist = distance(gl_PointCoord, vec2(0.5, 0.5));\n  float alpha = smoothstep(0.5, 0.45, dist);\n\n  // ÐœÐµÑ€Ñ†Ð°Ð½Ð¸Ðµ (Ð°Ð½Ð¸Ð¼Ð¸Ñ€ÑƒÐµÐ¼ Ð°Ð»ÑŒÑ„Ñƒ)\n  float twinkle = 0.7 + 0.5 * sin(time * 2.0 + vRandom * 10.0);\n\n  // Ð“Ð»Ð°Ð²Ð½Ð°Ñ ÑÑ‚Ñ€Ð¾ÐºÐ°: Ð°Ð»ÑŒÑ„Ð° Ñ‚ÐµÐ¿ÐµÑ€ÑŒ ÑƒÐ¼Ð½Ð¾Ð¶Ð°ÐµÑ‚ÑÑ Ð½Ð° uniform opacity!\n  gl_FragColor = vec4(vColor, alpha * twinkle * opacity);\n}\n",transparent:!0,vertexColors:!0,depthWrite:!1,blending:W}),this.stars=new b(d,this.materialStars),this.stars.layers.set(1),this.scene.add(this.stars),this.camera.layers.enable(1);case 1:return e.a(2)}},e,this)})),function(){return t.apply(this,arguments)})},{key:"updateSky",value:function(){var e=this.camera.position.x,t=Math.sign(e-this._prevCamX);this._prevCamX=t,this.stars.position.x=this.camera.position.x;var a=O.degToRad(90-this.parameters.elevation),s=O.degToRad(this.parameters.azimuth);if(this.sun.setFromSphericalCoords(1,a,s),this.sky.material.uniforms.sunPosition.value.copy(this.sun),this.water.material.uniforms.sunDirection.value.copy(this.sun).normalize(),"hor"==this.paramsClass.gameDir&&(this.sun.y<-.07&&this.materialStars.uniforms.opacity.value<1&&!this.thunder?(this.materialStars.uniforms.opacity.value+=.001,this.blackSky.material.opacity<.8&&(this.blackSky.material.opacity+=.001)):(this.sun.y>-.07&&this.materialStars.uniforms.opacity.value>0||this.thunder)&&(this.materialStars.uniforms.opacity.value-=.001,this.blackSky.material.opacity-=.01),this.thunder&&(this.blackSky.material.opacity=0),this.parameters.elevation<-8?this.parameters.top=!0:this.parameters.elevation>6&&(this.parameters.top=!1,this.rainStart=!1),this.parameters.top?(this.thunder||(this.parameters.elevation+=.003),this.dirLight.intensity+=3e-4,this.dirLight.intensity=Math.max(.5,Math.min(2,this.dirLight.intensity)),this.hemiLight.intensity+=3e-4,this.hemiLight.intensity=Math.max(.5,Math.min(2,this.hemiLight.intensity)),this.renderer.toneMappingExposure+=2e-4,this.renderer.toneMappingExposure=Math.max(.2,Math.min(1.05,this.renderer.toneMappingExposure))):(this.thunder||(this.parameters.elevation-=.003),this.dirLight.intensity-=3e-4,this.dirLight.intensity=Math.max(.5,Math.min(2,this.dirLight.intensity)),this.hemiLight.intensity-=3e-4,this.hemiLight.intensity=Math.max(.5,Math.min(2,this.hemiLight.intensity)),this.thunder||(this.renderer.toneMappingExposure-=3e-4,this.renderer.toneMappingExposure=Math.max(.2,Math.min(1.05,this.renderer.toneMappingExposure)))),!this.rainStart&&this.parameters.elevation<2&&this.parameters.elevation>1.5&&(this.rain=!0,this.startRain(),this.audioClass.musicOn&&this.audioClass.rainAudio.play(),this.rainStart=!0),this.parameters.elevation<-4.1&&!this.thunderStart&&(this.thunder=!0,this.startThunder(),this.thunderStart=!0),this.parameters.elevation<-2?this.night=!0:(this.night=!1,this.thunderStart=!1)),"vert"==this.paramsClass.gameDir){this.parameters.azimuth=150,this.stars.position.y=this.camera.position.y,void 0===this.prevCameraYSun&&(this.prevCameraYSun=this.camera.position.y);var i=this.camera.position.y-this.prevCameraYSun;this.parameters.elevation-=.05*i,this.blackSky.material.opacity+=.02*i,this.materialStars.uniforms.opacity.value+=.008*i,this.camera.position.y<this.topLight&&i<0?(this.dirLight.intensity-=.05*i,this.dirLight.intensity=Math.max(.5,Math.min(2,this.dirLight.intensity)),this.hemiLight.intensity-=.05*i,this.hemiLight.intensity=Math.max(.5,Math.min(2,this.hemiLight.intensity)),this.renderer.toneMappingExposure-=.05*i,this.renderer.toneMappingExposure=Math.max(.2,Math.min(1.05,this.renderer.toneMappingExposure))):this.topLight&&i>0&&(this.dirLight.intensity-=.05*i,this.dirLight.intensity=Math.max(.5,Math.min(2,this.dirLight.intensity)),this.hemiLight.intensity-=.05*i,this.hemiLight.intensity=Math.max(.5,Math.min(2,this.hemiLight.intensity)),this.renderer.toneMappingExposure-=.01*i,this.renderer.toneMappingExposure=Math.max(.2,Math.min(1.05,this.renderer.toneMappingExposure))),this.dirLight.intensity>.55&&this.dirLight.intensity<.57&&this.camera.position.y>10&&(this.topLight=this.camera.position.y),this.prevCameraYSun=this.camera.position.y,this.camera.position.y>30?this.night=!0:this.night=!1}this.materialStars.uniforms.time.value=.001*performance.now()}},{key:"waterUpdate",value:function(){performance.now(),this.water.material.uniforms.time.value+=.4/60}},{key:"loadWorld",value:(e=r(i().m(function e(){return i().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,this.loadWaterSky();case 1:return e.n=2,this.loadRain();case 2:this.scene.add(this.hemiLight),this.scene.add(this.dirLight),this.scene.add(this.targetObject),this.scene.add(this.water),Te(this.renderer,this.scene,this.camera),Be(this.water,this.renderer,this.scene,this.camera);case 3:return e.a(2)}},e,this)})),function(){return e.apply(this,arguments)})},{key:"updateLighting",value:function(){this.isRainActive&&performance.now()>=this.rainEndTimestampMs&&(this.scene.remove(this.rainPoints),this.isRainActive=!1,this.rain=!1,this.audioClass.musicOn&&this.audioClass.rainAudio.stop());var e=performance.now();this.thunder&&(e>=this.nextThunderFlashTimestampMs&&(this.triggerThunderFlashNow(),this.scheduleNextThunderFlash(e)),e>=this.thunderEndTimestampMs&&(this.thunder=!1,this.isThunderActive=!1)),this.dirLight.target.position.set(this.camera.position.x-4,-20,10),this.dirLight.position.set(this.camera.position.x,this.camera.position.y,0);this.dirLight.shadow.camera.left=-10,this.dirLight.shadow.camera.right=10,this.dirLight.shadow.camera.top=10,this.dirLight.shadow.camera.bottom=-10,this.deltaSeconds=Math.min(this.clock.getDelta(),.033);for(var t=this.activeLightningLines.length-1;t>=0;t--){var a=this.activeLightningLines[t];a.userData.life-=this.deltaSeconds/1.5,a.material.opacity*=.78,(a.userData.life<=0||a.material.opacity<=.02)&&(this.scene.remove(a),a.geometry.dispose(),a.material.dispose(),this.activeLightningLines.splice(t,1))}if(this.lightningFade>0&&(this.lightningFade-=1.7*this.deltaSeconds,this.lightningFade=Math.max(0,this.lightningFade),this.renderer.toneMappingExposure=.03+.97*this.lightningFade),this.rain){for(var s=this.rainGeometry.getAttribute("position"),i=.8*Math.sin(.0012*performance.now()),n=this.camera.position.x,o=this.camera.position.z,r=0;r<this.rainDropCount;r++){var l=3*r,h=.35*Math.sin(this.rainWindPhase[r]+.002*performance.now())+.4*i;this.rainPositions[l+0]+=h*this.deltaSeconds*8,this.rainPositions[l+1]-=this.rainVelocities[r]*(1+.3*Math.abs(i))*this.deltaSeconds,this.rainPositions[l+0],this.rainPositions[l+2],this.rainPositions[l+1]<this.rainBottomY&&(this.rainPositions[l+1]=this.rainTopY,this.rainPositions[l+0]=(Math.random()-.5)*this.rainAreaHalfWidth*2,this.rainPositions[l+2]=(Math.random()-.5)*this.rainAreaHalfDepth*2-35,this.rainWindPhase[r]=Math.random()*Math.PI*2),this.rainPositions[l+0]>this.rainAreaHalfWidth&&(this.rainPositions[l+0]-=2*this.rainAreaHalfWidth),this.rainPositions[l+0]<-this.rainAreaHalfWidth&&(this.rainPositions[l+0]+=2*this.rainAreaHalfWidth),this.rainPositions[l+2]>this.rainAreaHalfDepth&&(this.rainPositions[l+2]-=2*this.rainAreaHalfDepth-35),this.rainPositions[l+2]<-this.rainAreaHalfDepth&&(this.rainPositions[l+2]+=2*this.rainAreaHalfDepth-35)}this.rainPoints.position.set(n,0,o),s.needsUpdate=!0}this.waterUpdate(),this.updateSky()}},{key:"startRain",value:function(){if(!this.isRainActive){this.scene.add(this.rainPoints),this.isRainActive=!0;var e=performance.now();this.rainEndTimestampMs=e+7e4}}},{key:"startThunder",value:function(){if(this.thunder){var e=performance.now();this.isThunderActive=!0,this.thunderEndTimestampMs=e+16e3,this.triggerThunderFlashNow(),this.scheduleNextThunderFlash(e)}}},{key:"triggerThunderFlashNow",value:function(){if(this.thunder){var e=this.audioClass.thundersAudio;if(e&&e.length>0){var t=e[this.currentThunderIndex%e.length].music;t.isPlaying&&t.stop(),this.audioClass.musicOn&&t.play(),this.currentThunderIndex++}this.triggerLightningFlash(),this.lightningFade=1}}},{key:"scheduleNextThunderFlash",value:function(e){var t=this.minThunderIntervalMs+Math.random()*(this.maxThunderIntervalMs-this.minThunderIntervalMs);this.nextThunderFlashTimestampMs=e+t}},{key:"stopThunderImmediately",value:function(){this.thunder=!1,this.isThunderActive=!1,this.thunderEndTimestampMs=0,this.nextThunderFlashTimestampMs=0}},{key:"createLightningBolt",value:function(e,t,a){for(var s=e+6*(Math.random()-.5)-e,i=3*Math.random()-4-t,n=a+6*(Math.random()-.5)-a,o=Math.hypot(s,i,n)||1,r=s/o,l=i/o,d=n/o,p=-(n/o),c=s/o,u=Math.abs(l)>.9?new x(1,0,0):new x(0,1,0),m=new x(r,l,d),b=(new x).crossVectors(m,u).normalize(),g=(new x).crossVectors(m,b).normalize(),f=2+2*Math.random(),y=Math.random()*Math.PI*2,v=3+2.5*Math.random(),_=Math.random()*Math.PI*2,w=[],k=0;k<=28;k++){var j=k/28,P=1-j,M=e+s*j,D=t+i*j,C=a+n*j,S=1.2*Math.sin(j*Math.PI*f+y)*(.3+.7*P),z=.8*Math.sin(j*Math.PI*v+_)*(.3+.7*P),L=2*(Math.random()-.5)*4*P,A=1.6*(Math.random()-.5)*4*P,E=Math.random()<.12?3.5*(Math.random()-.5)*P:0;if(M+=b.x*(S+L+E)+g.x*(z+.7*A),D+=b.y*(S+.5*L)+g.y*(z+.5*A),C+=b.z*(S+L+E)+g.z*(z+.7*A),w.push(M,D,C),k>3&&k<25&&Math.random()<.22){var T=[],B=3+Math.floor(2*Math.random()),H=.25+.35*Math.random(),R=M,F=D,I=C;T.push(R,F,I);for(var N=1;N<=B;N++)R+=4*(Math.random()-.5)*H,F+=-(.8+.8*Math.random())*H,I+=4*(Math.random()-.5)*H,T.push(R,F,I);var G=new h;G.setAttribute("position",new oe(T,3));var q=new re(G,this.lightningMaterialBase.clone());q.material.opacity=.6,q.userData.life=.16+.12*Math.random(),this.scene.add(q),this.activeLightningLines.push(q)}}for(var U=-1;U<=2;U++){for(var Y=-1===U,W=Y?0:U%2==0?1:-1,O=.55+.45*Math.random(),V=Math.random()*Math.PI*2,K=[],J=w.length/3,X=0;X<J;X++){var Q=X/(J-1),Z=.35+.85*Q,$=.35*Math.sin(Q*Math.PI*2+V)*(.2+.8*Q),ee=p*W*O*Z+c*$*.3,te=0*W*O*Z+.05*$,ae=c*W*O*Z-p*$*.3,se=3*X+1,ie=3*X+2,ne=w[3*X+0],le=w[se],he=w[ie];Y?K.push(ne+.05*(Math.random()-.5),le+.05*(Math.random()-.5),he+.05*(Math.random()-.5)):K.push(ne+ee+.2*(Math.random()-.5),le+te+.2*(Math.random()-.5),he+ae+.2*(Math.random()-.5))}var de=new h;de.setAttribute("position",new oe(K,3));var pe=new re(de,this.lightningMaterialBase.clone());pe.material.opacity=Y?.95:.32,pe.userData.life=.22+.18*Math.random(),this.scene.add(pe),this.activeLightningLines.push(pe)}}},{key:"triggerLightningFlash",value:function(){var e=this.camera.position.x+30*(Math.random()-.5),t=34+6*Math.random(),a=-10-20*Math.random();this.createLightningBolt(e,t,a)}},{key:"makeRainStreakTexture",value:function(){for(var e=new Uint8Array(320),t=0;t<40;t++)for(var a=Math.pow(Math.sin(t/39*Math.PI),1.5),s=0;s<2;s++){var i=4*(2*t+s);e[i+0]=255,e[i+1]=255,e[i+2]=255,e[i+3]=Math.round(255*a)}var n=new le(e,2,40,he);return n.needsUpdate=!0,n.magFilter=de,n.minFilter=de,n.wrapS=pe,n.wrapT=pe,n.rotation=Math.PI/2,n.center.set(.5,.5),n}}]);var e,t,a}();function Qe(e){if(!e)return!1;if(!0===e.isMine)return!0;var t=Ge("leaderboard.mine","ÐœÐ¾Ð¹ Ñ€ÐµÐºÐ¾Ñ€Ð´");return e.name===t}var Ze,$e,et=function(){return d(function e(t,a,s,i){l(this,e),this.initMatch=t,this.gameClass=a,this.audioClass=s,this.dataClass=i,this.playersNum=1,this.levelPlayersNum=1},[{key:"init",value:function(){this.mainMenu(),this.loadRecsData()}},{key:"loadRecsData",value:function(){var e=this,t=this.dataClass.masTables,a=document.querySelectorAll(".rec_table_small");if(t&&Array.isArray(t)&&!(a.length<2)){var s="free_game_my_rec";a[0].innerHTML="",a[1].innerHTML="",t.forEach(function(t,i){Array.isArray(t)&&t.forEach(function(t,n){if(Array.isArray(t)&&0!==t.length){var o=t,r=o[0],l=o[1],h=o[2],d=o[3];if(r&&l&&h){var p=Ge("leaderboard.mine","ÐœÐ¾Ð¹ Ñ€ÐµÐºÐ¾Ñ€Ð´"),c=o.findIndex(function(e){return e&&e.name===p})<3&&-1!==o.findIndex(function(e){return e&&e.name===p}),u=e.playersNum===n+1?"":"hidden_screen";c?a[i].insertAdjacentHTML("beforeend",'\n              <div class="rec_table_small_block '.concat(u,'">\n                <div class="yellow_back one_place ').concat(Qe(r)?s:"",'">\n                    <span class="place_num">1</span>\n                    <span class="rec_table_small_name">').concat(r.name,'</span>\n                    <div><span class="place_rec">').concat(r.rec,"</span><span>").concat(Ge("hud.metersLabel","Ð¼"),'</span></div>\n                </div>\n                <div class="green_back two_place ').concat(Qe(l)?s:"",'">\n                    <span class="place_num">2</span>\n                    <span class="rec_table_small_name">').concat(l.name,'</span>\n                    <div><span class="place_rec">').concat(l.rec,"</span><span>").concat(Ge("hud.metersLabel","Ð¼"),'</span></div>\n                </div>\n                <div class="blue_back three_place ').concat(Qe(h)?s:"",'">\n                    <span class="place_num">').concat(h.pos>2?h.pos:3,'</span>\n                    <span class="rec_table_small_name">').concat(h.name,'</span>\n                    <div><span class="place_rec">').concat(h.rec,"</span><span>").concat(Ge("hud.metersLabel","Ð¼"),"</span></div>\n                </div>\n              </div>\n            ")):d&&a[i].insertAdjacentHTML("beforeend",'\n              <div class="rec_table_small_block '.concat(u,'">\n                <div class="yellow_back one_place">\n                    <span class="place_num">1</span>\n                    <span class="rec_table_small_name">').concat(r.name,'</span>\n                    <div><span class="place_rec">').concat(r.rec,"</span><span>").concat(Ge("hud.metersLabel","Ð¼"),'</span></div>\n                </div>\n                <div class="green_back two_place}">\n                    <span class="place_num">2</span>\n                    <span class="rec_table_small_name">').concat(l.name,'</span>\n                    <div><span class="place_rec">').concat(l.rec,"</span><span>").concat(Ge("hud.metersLabel","Ð¼"),'</span></div>\n                </div>\n                <div class="blue_back three_place ').concat(s,'">\n                  <span class="place_num">').concat(h.pos>2?h.pos:3,'</span>\n                  <span class="rec_table_small_name">').concat(d.name,'</span>\n                  <div><span class="place_rec">').concat(d.rec,"</span><span>").concat(Ge("hud.metersLabel","Ð¼"),"</span></div>\n                </div>\n              </div>\n            "))}}})})}}},{key:"mainMenu",value:function(){var e=this,t=document.querySelector(".new_game_btn1"),a=document.querySelector(".new_game_btn2"),s=document.querySelector(".new_game_btn3"),n=document.querySelector(".contest_game_btn"),o=document.querySelector(".levels_blocks"),l=document.querySelector(".levels_blocks_contest");t&&t.addEventListener("click",function(){e.loadRecsData(),e.hideScreen("main_screen"),e.showScreen("free_game_screen")}),a&&a.addEventListener("click",r(i().m(function t(){return i().w(function(t){for(;;)switch(t.n){case 0:e.dataClass.levelCoopMode="coop",document.querySelectorAll(".levels_game_screen .level_game_chels").forEach(function(t,a){t.classList.contains("level_game_chels_active")&&(e.levelPlayersNum=a+1,e.dataClass.loadLevels(e.levelPlayersNum-1))}),e.hideScreen("main_screen"),e.showScreen("levels_game_screen");case 1:return t.a(2)}},t)}))),s&&s.addEventListener("click",r(i().m(function t(){return i().w(function(t){for(;;)switch(t.n){case 0:e.dataClass.levelCoopMode="contest",document.querySelectorAll(".levels_game_screen_contest .level_game_chels_contest").forEach(function(t,a){t.classList.contains("level_game_chels_contest_active")&&(e.levelPlayersNum=a+2)}),e.hideScreen("main_screen"),e.showScreen("levels_game_screen_contest");case 1:return t.a(2)}},t)}))),document.querySelectorAll(".arrow_back").forEach(function(t){t.addEventListener("click",function(){t.parentElement.parentElement.classList.add("hidden_screen"),e.showScreen("main_screen")})}),o&&o.addEventListener("click",function(t){var a=t.target.closest(".levels_block");if(a&&!a.classList.contains("levels_block--locked")){var s=Number(a.dataset.level)||1;o.querySelectorAll(".levels_block").forEach(function(e){return e.classList.remove("active")}),a.classList.add("active"),e.hideScreen("levels_game_screen"),e.initMatch(e.levelPlayersNum,1,s,!0)}}),l&&l.addEventListener("click",function(t){var a=t.target.closest(".levels_block");if(a){var s=Number(a.dataset.level)||1;l.querySelectorAll(".levels_block").forEach(function(e){return e.classList.remove("active")}),a.classList.add("active"),e.hideScreen("levels_game_screen_contest"),e.initMatch(e.levelPlayersNum,1,s,!0)}}),n&&n.addEventListener("click",function(){var t=Math.floor(Math.random()*e.dataClass.allLevels);e.hideScreen("levels_game_screen_contest"),e.initMatch(e.levelPlayersNum,1,t,!0)}),document.querySelectorAll(".level_game_chels").forEach(function(t,a){t.addEventListener("click",function(){e.levelPlayersNum!==a+1&&(document.querySelectorAll(".level_game_chels").forEach(function(e){e.classList.remove("level_game_chels_active")}),t.classList.add("level_game_chels_active"),e.levelPlayersNum=a+1,e.dataClass.loadLevels(e.levelPlayersNum-1))})}),document.querySelectorAll(".level_game_chels_contest").forEach(function(t,a){t.addEventListener("click",function(){e.levelPlayersNum!==a+2&&(document.querySelectorAll(".level_game_chels_contest").forEach(function(e){e.classList.remove("level_game_chels_contest_active")}),t.classList.add("level_game_chels_contest_active"),e.levelPlayersNum=a+2)})});var h=document.querySelector(".free_game_btn1_2"),d=document.querySelector(".free_game_btn1_4");h&&h.addEventListener("click",function(){ym(105298813,"reachGoal","play_ocean"),e.hideScreen("free_game_screen"),e.initMatch(e.playersNum,2)}),d&&d.addEventListener("click",function(){ym(105298813,"reachGoal","play_space"),e.hideScreen("free_game_screen"),e.initMatch(e.playersNum,4,!1,!1)}),document.querySelectorAll(".free_game_chels").forEach(function(t,a){t.addEventListener("click",function(){document.querySelectorAll(".free_game_chels").forEach(function(e){e.classList.remove("free_game_chels_active")}),t.classList.add("free_game_chels_active");var s=a+1,i=document.querySelectorAll(".rec_table_small"),n=[];i.forEach(function(e){var t=e.querySelector(".rec_table_small_block:not(.hidden_screen)");t&&(n.push(t),t.getBoundingClientRect(),t.classList.add("anim-out"))});var o=0,r=function(){if(!(++o<n.length)){e.playersNum=s,e.loadRecsData();var t=[];document.querySelectorAll(".rec_table_small").forEach(function(e){var a=e.querySelector(".rec_table_small_block:not(.hidden_screen)");a&&(a.classList.add("anim-in"),t.push(a))}),requestAnimationFrame(function(){t.forEach(function(e){e.getBoundingClientRect(),e.classList.add("anim-play")});var e=function(t){t.classList.remove("anim-in","anim-play"),t.removeEventListener("transitionend",e)};t.forEach(function(t){return t.addEventListener("transitionend",function(){return e(t)},{once:!0})})})}};0===n.length?(e.playersNum=s,e.loadRecsData()):n.forEach(function(e){e.addEventListener("transitionend",function(){e.classList.remove("anim-out"),e.removeEventListener("transitionend",r),r()},{once:!0})})})})}},{key:"toggleLoader",value:function(e){var t=document.querySelector(".loader_screen");t&&(e?t.classList.remove("hidden_screen"):t.classList.add("hidden_screen"))}},{key:"hideScreen",value:function(e){var t=document.querySelector(".".concat(e));t&&t.classList.add("hidden_screen")}},{key:"showScreen",value:function(e){var t=document.querySelector(".".concat(e));t&&t.classList.remove("hidden_screen")}}])}(),tt=d(function e(){l(this,e),this.gameDir="hor",this.allDie=!1,this.dataLoaded=!1}),at=function(){return d(function e(t,a){l(this,e),this.camera=t,this.dataClass=a,this.score=0,this.startX=this.camera.position.x,this.startY=this.camera.position.y,this.metersFloatEl=document.getElementById("meters-float"),this.myRecField=document.getElementById("myRecord"),this.worldRecField=document.getElementById("worldRecord"),this.playerPanels=Array.from(document.querySelectorAll(".player_panel_rec_num")).slice(0,3),this.worldRec=0,this.myRec=0},[{key:"loadRecsToHud",value:function(){var e,t,a,s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(null===(e=this.dataClass.masTables)||void 0===e||null===(e=e[s])||void 0===e?void 0:e[i])||[];this.worldRec=Number(null==n||null===(t=n[0])||void 0===t?void 0:t.rec)||0;var o=Ge("leaderboard.mine","ÐœÐ¾Ð¹ Ñ€ÐµÐºÐ¾Ñ€Ð´"),r=n.find(function(e){return e&&e.name===o&&0!==e.pos});if(r||(null==n||null===(a=n[3])||void 0===a?void 0:a.name)!==o||(r=n[3]),!r){var l,h=0===s?"hor":"vert";r=(null===(l=this.dataClass.table)||void 0===l||null===(l=l[h])||void 0===l||null===(l=l[i])||void 0===l?void 0:l[0])||{rec:0}}this.myRec=Number(r.rec)||0,this.myRecField&&(this.myRecField.textContent=this.myRec),this.worldRecField&&(this.worldRecField.textContent=this.worldRec)}},{key:"updateMetersFloat",value:function(e,t){var a,s=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"hor",n="vert"===i?"y":"x",o=c(t);try{for(o.s();!(a=o.n()).done;){var r,l,h=a.value,d=null==h?void 0:h.player;if(d){var p=d.userData||(d.userData={});null==p.score&&(p.score=0);var u=null!==(r=null===(l=d.position)||void 0===l?void 0:l[n])&&void 0!==r?r:0;if(null==p._lastMeterPos&&(p._lastMeterPos=u),"vert"!==i&&!1===p._wasLive&&p.live&&(p._lastMeterPos=u),p.live){var m=u-p._lastMeterPos,b=m>1e-4?m:0;0!==b&&(p.score+=b,p._lastMeterPos=u)}0===p.score&&(p._lastMeterPos=u),p._wasLive=!!p.live}}}catch(D){o.e(D)}finally{o.f()}this.playerPanels||(this.playerPanels=Array.from(document.querySelectorAll(".player_panel_rec_num")).slice(0,3));for(var g=0,f=0;f<3;f++){var y,v,x=this.playerPanels[f],_=null===(y=t[f])||void 0===y?void 0:y.player,w=Math.max(0,Math.floor((null==_||null===(v=_.userData)||void 0===v?void 0:v.score)||0));g+=w,x&&(x.textContent=String(w).padStart(3,"0"))}var k=Math.max(0,Math.floor(g));if(k!==st){var j=st,P=performance.now(),M=function(e){var t=Math.min(1,(e-P)/50),a=1-Math.pow(1-t,4),i=Math.round(j+(k-j)*a);s.score=i,s.metersFloatEl&&(s.metersFloatEl.textContent=String(i).padStart(3,"0")),t<1?requestAnimationFrame(M):st=k};requestAnimationFrame(M)}}}])}(),st=0,it=d(function e(){l(this,e),this.gameStarting=!1,this.pause=!1,this.visible=!0,this.showGamePopup=!1}),nt=function(){return d(function e(){l(this,e),this.gameInit=!1,this.yandexPlayer={id:0,player:null},this.levelsStatus=[[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0]],this.levelCoopMode="coop",this.allLevels=10,this.table={updateDate:11147,levelsStatusContest:[0,0,0,0,0,0,0,0,0,0],player:{levels:[0,0,0],bonusHat:[!1,!1,!1],bonusHeart:[0,0,0]},hor:[[{pos:0,name:"ÐœÐ¾Ð¹ Ñ€ÐµÐºÐ¾Ñ€Ð´",rec:0},{pos:1,name:"",rec:0},{pos:2,name:"",rec:0},{pos:3,name:"",rec:0}],[{pos:0,name:"ÐœÐ¾Ð¹ Ñ€ÐµÐºÐ¾Ñ€Ð´",rec:0},{pos:1,name:"",rec:0},{pos:2,name:"",rec:0},{pos:3,name:"",rec:0}],[{pos:0,name:"ÐœÐ¾Ð¹ Ñ€ÐµÐºÐ¾Ñ€Ð´",rec:0},{pos:1,name:"",rec:0},{pos:2,name:"",rec:0},{pos:3,name:"",rec:0}]],vert:[[{pos:0,name:"ÐœÐ¾Ð¹ Ñ€ÐµÐºÐ¾Ñ€Ð´",rec:0},{pos:1,name:"",rec:0},{pos:2,name:"",rec:0},{pos:3,name:"",rec:0}],[{pos:0,name:"ÐœÐ¾Ð¹ Ñ€ÐµÐºÐ¾Ñ€Ð´",rec:0},{pos:1,name:"",rec:0},{pos:2,name:"",rec:0},{pos:3,name:"",rec:0}],[{pos:0,name:"ÐœÐ¾Ð¹ Ñ€ÐµÐºÐ¾Ñ€Ð´",rec:0},{pos:1,name:"",rec:0},{pos:2,name:"",rec:0},{pos:3,name:"",rec:0}]]},this.masTables=[],this.mainScore=0,this.localStorageKey="gameData",this.disableSelection=function(){document.querySelectorAll(".levels_block, .status_chip, .levels_block_number").forEach(function(e){e.style.userSelect="none",e.style.webkitUserSelect="none",e.style.webkitTapHighlightColor="transparent",e.draggable=!1})},this.leaderboardsPartIds=["ocean1","ocean2","ocean3","space1","space2","space3"],this.leaderboardPlacement={ocean1:{group:"hor",row:0},ocean2:{group:"hor",row:1},ocean3:{group:"hor",row:2},space1:{group:"vert",row:0},space2:{group:"vert",row:1},space3:{group:"vert",row:2}}},[{key:"clearData",value:(m=r(i().m(function e(){return i().w(function(e){for(;;)switch(e.n){case 0:localStorage.clear();case 1:return e.a(2)}},e)})),function(){return m.apply(this,arguments)})},{key:"getMineLabel",value:function(){return Ge("leaderboard.mine","ÐœÐ¾Ð¹ Ñ€ÐµÐºÐ¾Ñ€Ð´")}},{key:"refreshMineLabels",value:function(){var e=this,t=this.getMineLabel(),a=new Set(["ÐœÐ¾Ð¹ Ñ€ÐµÐºÐ¾Ñ€Ð´","My record"]),s=function(e){if(e){e[0]&&(e[0].name=t);for(var s=1;s<=3;s++){var i=e[s];i&&((!0===i.isMe||a.has(i.name))&&(i.name=t,i.isMe=!0))}}};["hor","vert"].forEach(function(t){if(e.table[t])for(var a=0;a<3;a++)s(e.table[t][a])}),this.processDataAfterLoad()}},{key:"loadLevels",value:(u=r(i().m(function e(a){var s,n,o,r,l,h=this;return i().w(function(e){for(;;)switch(e.n){case 0:if(s=document.querySelector(".levels_blocks")){e.n=1;break}return e.a(2);case 1:s.classList.add("levels_blocks--reenter"),s.innerHTML="",n=document.createDocumentFragment(),o=function(e){switch(e){case"completed":return{modifierClass:"levels_block--completed",labelText:Ge("levels.status.completed","ÐŸÑ€Ð¾Ð¹Ð´ÐµÐ½"),ariaState:Ge("levels.status.completedAria","ÑƒÑ€Ð¾Ð²ÐµÐ½ÑŒ Ð¿Ñ€Ð¾Ð¹Ð´ÐµÐ½")};case"available":return{modifierClass:"levels_block--available",labelText:Ge("levels.status.available","Ð”Ð¾ÑÑ‚ÑƒÐ¿ÐµÐ½"),ariaState:Ge("levels.status.availableAria","ÑƒÑ€Ð¾Ð²ÐµÐ½ÑŒ Ð´Ð¾ÑÑ‚ÑƒÐ¿ÐµÐ½")};default:return{modifierClass:"levels_block--locked",labelText:Ge("levels.status.locked","Ð—Ð°ÐºÑ€Ñ‹Ñ‚"),ariaState:Ge("levels.status.lockedAria","ÑƒÑ€Ð¾Ð²ÐµÐ½ÑŒ Ð·Ð°ÐºÑ€Ñ‹Ñ‚")}}},r=i().m(function e(){var t,s,r,d,p,c,u,m,b,g,f,y;return i().w(function(e){for(;;)switch(e.n){case 0:t=h.levelsStatus[a][l],s=o(t),r=s.modifierClass,d=s.labelText,p=s.ariaState,c=9===l,(u=document.createElement("div")).className="levels_block ".concat(r).concat(c?" levels_block--super":""),u.setAttribute("data-level",String(l+1)),u.setAttribute("role","button"),u.setAttribute("tabindex","locked"===t?"-1":"0"),u.setAttribute("aria-label","Ð£Ñ€Ð¾Ð²ÐµÐ½ÑŒ ".concat(l+1,", ").concat(p).concat(c?", Ð±Ð¾Ð½ÑƒÑÐ½Ñ‹Ð¹ ÑƒÑ€Ð¾Ð²ÐµÐ½ÑŒ":"")),m=Math.min(60+40*l,600),u.style.setProperty("--show-delay","".concat(m,"ms")),(b=document.createElement("div")).className="levels_block_number",b.textContent=String(l+1),c&&((g=document.createElement("div")).className="level_reward_icon",g.innerHTML="+â¤ï¸",u.appendChild(g)),(f=document.createElement("div")).className="levels_block_status",(y=document.createElement("span")).className="status_chip ".concat("completed"===t?"status_chip--completed":"available"===t?"status_chip--available":"status_chip--locked"),y.setAttribute("data-i18n","levels.status.".concat(t)),y.textContent=d,f.appendChild(y),u.append(b,f),u.addEventListener("click",function(){"locked"!==t&&(document.querySelectorAll(".levels_block").forEach(function(e){return e.classList.remove("active")}),u.classList.add("active"))}),u.addEventListener("keydown",function(e){"locked"!==t&&("Enter"!==e.key&&" "!==e.key||(e.preventDefault(),u.click()))}),n.appendChild(u);case 1:return e.a(2)}},e)}),l=0;case 2:if(!(l<this.levelsStatus[a].length)){e.n=4;break}return e.d(t(r()),3);case 3:l++,e.n=2;break;case 4:s.append(n),requestAnimationFrame(function(){s.classList.remove("levels_blocks--reenter"),s.querySelectorAll(".levels_block").forEach(function(e){e.classList.add("levels_block--enter"),e.classList.contains("levels_block--super")&&e.addEventListener("animationend",function(t){"level-tile-in"===t.animationName&&e.classList.add("levels_block--enter-done")})})}),this.disableSelection();case 5:return e.a(2)}},e,this)})),function(e){return u.apply(this,arguments)})},{key:"loadLevelsContest",value:(c=r(i().m(function e(){var a,s,n,o,r=this;return i().w(function(e){for(;;)switch(e.n){case 0:if(a=document.querySelector(".levels_blocks_contest")){e.n=1;break}return e.a(2);case 1:a.classList.add("levels_blocks--reenter"),a.innerHTML="",s=document.createDocumentFragment(),n=i().m(function e(){var t,a,n,l,h,d,p,c,u;return i().w(function(e){for(;;)switch(e.n){case 0:n=o+1,l=null!==(t=null===(a=r.table.levelsStatusContest)||void 0===a?void 0:a[o])&&void 0!==t?t:0,(h=document.createElement("div")).className="levels_block levels_block--contest",h.setAttribute("data-level",n),h.setAttribute("role","button"),h.setAttribute("tabindex","0"),h.setAttribute("aria-label","Ð£Ñ€Ð¾Ð²ÐµÐ½ÑŒ ".concat(n,", Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ðµ ").concat(l)),d=Math.min(60+40*o,600),h.style.setProperty("--show-delay","".concat(d,"ms")),l&&h.classList.add("level_player".concat(l)),(p=document.createElement("div")).className="levels_block_number",p.textContent=String(n),(c=document.createElement("div")).className="levels_block_status",l?(c.setAttribute("data-i18n","contest.player".concat(l)),c.textContent=Ge("contest.player".concat(l))):c.textContent="",u=l?Ge("contest.player".concat(l)):"",c.textContent=u,h.append(p,c),h.addEventListener("click",function(){document.querySelectorAll(".levels_block").forEach(function(e){return e.classList.remove("active")}),h.classList.add("active")}),h.addEventListener("keydown",function(e){"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),h.click())}),s.append(h);case 1:return e.a(2)}},e)}),o=0;case 2:if(!(o<this.allLevels)){e.n=4;break}return e.d(t(n()),3);case 3:o++,e.n=2;break;case 4:a.append(s),requestAnimationFrame(function(){a.classList.remove("levels_blocks--reenter"),a.querySelectorAll(".levels_block").forEach(function(e){e.classList.add("levels_block--enter")})}),this.disableSelection();case 5:return e.a(2)}},e,this)})),function(){return c.apply(this,arguments)})},{key:"replayLevelsEnterAnimation",value:function(){var e=document.querySelector(".levels_blocks");e&&Array.from(e.querySelectorAll(".levels_block")).forEach(function(e){e.classList.remove("levels_block--enter"),e.offsetWidth,e.classList.add("levels_block--enter")})}},{key:"processDataAfterLoad",value:function(){var e=this,t=function(t){var a,s,i=e.getMineLabel(),n=[t[1],t[2],t[3]].map(function(e,t){return e?{pos:e.pos,name:e.name,rec:e.rec}:{pos:t+1,name:"",rec:0}}),o=n.some(function(e){return e&&e.name===i}),r=Number(null==t||null===(a=t[0])||void 0===a?void 0:a.rec)||0,l=(null==t||null===(s=t[3])||void 0===s?void 0:s.name)===i&&Number(t[3].rec)||0,h=Math.max(r,l);if(o)return n;var d,p={pos:(null==t||null===(d=t[3])||void 0===d?void 0:d.name)===i&&t[3].pos||0,name:i,rec:h};return[n[0],n[1],n[2],p]};this.masTables=[[t(this.table.hor[0]),t(this.table.hor[1]),t(this.table.hor[2])],[t(this.table.vert[0]),t(this.table.vert[1]),t(this.table.vert[2])]];for(var a=0;a<3;a++)for(var s=0;s<this.allLevels;s++)s<this.table.player.levels[a]?this.levelsStatus[a][s]="completed":s==this.table.player.levels[a]?this.levelsStatus[a][s]="available":this.levelsStatus[a][s]="locked"}},{key:"initYandexPlayer",value:(p=r(i().m(function e(){var t,a,s,n=arguments;return i().w(function(e){for(;;)switch(e.p=e.n){case 0:if(t=(n.length>0&&void 0!==n[0]?n[0]:{}).force,a=void 0!==t&&t,e.p=1,this.yandexPlayer.player&&!a){e.n=3;break}return e.n=2,ysdk.getPlayer();case 2:this.yandexPlayer.player=e.v;case 3:return e.n=4,this.yandexPlayer.player.isAuthorized();case 4:this.yandexPlayer.isAuthorized=e.v,e.n=6;break;case 5:e.p=5,e.v,this.yandexPlayer.isAuthorized=!1;case 6:(s=document.querySelector(".autoriz"))&&(this.yandexPlayer.isAuthorized&&console.log("Ð°Ð²Ñ‚Ð¾Ñ€Ð¸Ð·Ð¾Ð²Ð°Ð»Ð¸ÑÑŒ"),s.classList.toggle("hidden_screen",!0===this.yandexPlayer.isAuthorized),!0===this.yandexPlayer.isAuthorized&&(s.setAttribute("aria-hidden","true"),s.style.display="none"));case 7:return e.a(2)}},e,this,[[1,5]])})),function(){return p.apply(this,arguments)})},{key:"loadTableFromCloud",value:(h=r(i().m(function t(){var a,s;return i().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.n=1,this.initYandexPlayer();case 1:return t.p=1,t.n=2,this.yandexPlayer.player.getData(["table"]);case 2:if(!(a=t.v)||!a.table||"object"!==e(a.table)){t.n=3;break}this.table=a.table,t.n=4;break;case 3:return console.log("ÐŸÐµÑ€Ð²Ñ‹Ð¹ Ð²Ñ…Ð¾Ð´: ÑÐ¾Ð·Ð´Ð°Ñ‘Ð¼ Ð½Ð¾Ð²ÑƒÑŽ table"),this.table=this.createDefaultTable(),t.n=4,this.saveTableToCloud();case 4:t.n=6;break;case 5:t.p=5,s=t.v,console.warn("Cloud load failed:",s),this.table=this.createDefaultTable();case 6:this.processDataAfterLoad();case 7:return t.a(2)}},t,this,[[1,5]])})),function(){return h.apply(this,arguments)})},{key:"createDefaultTable",value:function(){return{updateDate:Date.now(),player:{levels:[0,0,0],bonusHat:[!1,!1,!1],bonusHeart:[0,0,0]},levelsStatusContest:[0,0,0,0,0,0,0,0,0,0],hor:[[{pos:0,name:this.getMineLabel(),rec:0},{},{},{}],[{pos:0,name:this.getMineLabel(),rec:0},{},{},{}],[{pos:0,name:this.getMineLabel(),rec:0},{},{},{}]],vert:[[{pos:0,name:this.getMineLabel(),rec:0},{},{},{}],[{pos:0,name:this.getMineLabel(),rec:0},{},{},{}],[{pos:0,name:this.getMineLabel(),rec:0},{},{},{}]]}}},{key:"saveTableToCloud",value:(o=r(i().m(function e(){var t,a,s,n=arguments;return i().w(function(e){for(;;)switch(e.p=e.n){case 0:return t=(n.length>0&&void 0!==n[0]?n[0]:{}).flush,a=void 0!==t&&t,e.n=1,this.initYandexPlayer();case 1:return e.p=1,e.n=2,this.yandexPlayer.player.setData({table:this.table},a);case 2:e.n=4;break;case 3:e.p=3,s=e.v,console.warn("Cloud save failed:",s);case 4:return e.a(2)}},e,this,[[1,3]])})),function(){return o.apply(this,arguments)})},{key:"ensureRowsForLeaderboards",value:function(){var e=this,t=function(){return[{pos:0,name:e.getMineLabel(),rec:0},{pos:1,name:"",rec:0},{pos:2,name:"",rec:0},{pos:3,name:"",rec:0}]};this.table.hor||(this.table.hor=[t(),t(),t()]),this.table.vert||(this.table.vert=[t(),t(),t()]);for(var a=0;a<3;a++)Array.isArray(this.table.hor[a])&&4===this.table.hor[a].length||(this.table.hor[a]=t()),Array.isArray(this.table.vert[a])&&4===this.table.vert[a].length||(this.table.vert[a]=t())}},{key:"applyLocalMyBestToTop3",value:function(){var e,t=this;null!==(e=this.yandexPlayer)&&void 0!==e&&e.isAuthorized||["hor","vert"].forEach(function(e){for(var a=0;a<3;a++){var s,i,n=null===(s=t.table)||void 0===s||null===(s=s[e])||void 0===s?void 0:s[a];if(n){var o=Number(null==n||null===(i=n[0])||void 0===i?void 0:i.rec)||0;o>0&&t.updateLocalTop3(e,a,o)}}})}},{key:"loadLeaderboardsTop3",value:(n=r(i().m(function e(t){var s,n,o,l,h=this;return i().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,this.initYandexPlayer();case 1:return this.ensureRowsForLeaderboards(),n=!!this.yandexPlayer.isAuthorized,o=n&&null!==(s=this.yandexPlayer.player)&&void 0!==s&&s.getUniqueID?this.yandexPlayer.player.getUniqueID():null,l=function(){var e=r(i().m(function e(s){var r,l,d,p,c,u,m,b,g,f,y,v,x,_,w,k,j,P,M,D,C;return i().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,t.leaderboards.getEntries(s,{quantityTop:3,includeUser:!1,quantityAround:0});case 1:if(r=e.v,l=(r.entries||[]).map(function(e){var t,a;return{uid:(null===(t=e.player)||void 0===t?void 0:t.uniqueID)||null,name:(null===(a=e.player)||void 0===a?void 0:a.publicName)||"Anon",rec:"number"==typeof e.score?e.score:0,pos:e.rank||0}}),d=null,!(D=n)){e.n=3;break}return e.n=2,t.isAvailableMethod("leaderboards.getPlayerEntry");case 2:D=e.v;case 3:if(!D){e.n=7;break}return e.p=4,e.n=5,t.leaderboards.getPlayerEntry(s);case 5:d=e.v,e.n=7;break;case 6:e.p=6,e.v,d=null;case 7:if(p=[],n&&d&&o?(c=d.rank||0,u="number"==typeof d.score?d.score:0,l.some(function(e){return e.uid===o})?p=l.slice(0,3).map(function(e){return{pos:e.pos,name:e.uid===o?h.getMineLabel():e.name,rec:e.rec,isMe:e.uid===o}}):(m=l.filter(function(e){return e.uid!==o}).slice(0,2).map(function(e){return{pos:e.pos,name:e.name,rec:e.rec}}),b={pos:c,name:h.getMineLabel(),rec:u,isMe:!0},p=[].concat(a(m),[b])),(g=h.leaderboardPlacement[s])&&(f="hor"===g.group?h.table.hor[g.row]:h.table.vert[g.row])&&f[0]&&(f[0].rec=u)):p=l.slice(0,3).map(function(e){return{pos:e.pos,name:e.name,rec:e.rec}}),y=h.leaderboardPlacement[s]){e.n=8;break}return e.a(2);case 8:for(v="hor"===y.group?h.table.hor[y.row]:h.table.vert[y.row],x=1;x<=3;x++)_=p[x-1]||{pos:x,name:"",rec:0},v[x]={pos:_.pos,name:_.name,rec:_.rec,isMe:!!_.isMe};n&&!p.some(function(e){return e.isMe||(null==e?void 0:e.name)===h.getMineLabel()})&&d&&o&&(w=d.rank||0,k="number"==typeof d.score?d.score:0,v[3]={pos:w,name:h.getMineLabel(),rec:k}),e.n=11;break;case 9:if(e.p=9,C=e.v,console.warn("Leaderboard ".concat(s," load failed:"),C),j=h.leaderboardPlacement[s]){e.n=10;break}return e.a(2);case 10:for(P="hor"===j.group?h.table.hor[j.row]:h.table.vert[j.row],M=1;M<=3;M++)P[M]={pos:M,name:"",rec:0};case 11:return e.a(2)}},e,null,[[4,6],[0,9]])}));return function(t){return e.apply(this,arguments)}}(),e.n=2,Promise.all(this.leaderboardsPartIds.map(l));case 2:this.refreshMineLabels(),this.applyLocalMyBestToTop3(),this.processDataAfterLoad();case 3:return e.a(2)}},e,this)})),function(e){return n.apply(this,arguments)})},{key:"submitMyScore",value:(s=r(i().m(function e(t,s,n){var o,l,h,d=this;return i().w(function(e){for(;;)switch(e.p=e.n){case 0:return o=Number(n)||0,e.p=1,e.n=2,t.isAvailableMethod("leaderboards.setScore");case 2:if(e.v){e.n=3;break}return e.a(2);case 3:l=this.getMineLabel(),this.mainScore=[].concat(a(this.table.hor),a(this.table.vert)).reduce(function(e,t){var a,s,i=Number(null==t||null===(a=t[0])||void 0===a?void 0:a.rec)||0,n=(null==t||null===(s=t[3])||void 0===s?void 0:s.name)===l&&Number(t[3].rec)||0;return e+Math.max(i,n)},0),setTimeout(r(i().m(function e(){var a;return i().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,t.leaderboards.setScore(s,o);case 1:e.n=3;break;case 2:e.p=2,a=e.v,console.warn("setScore (part) failed:",a);case 3:return e.a(2)}},e,null,[[0,2]])})),0),setTimeout(r(i().m(function e(){var a;return i().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,t.leaderboards.setScore("main",d.mainScore);case 1:e.n=3;break;case 2:e.p=2,a=e.v,console.warn("setScore (main) failed:",a);case 3:return e.a(2)}},e,null,[[0,2]])})),1200),e.n=5;break;case 4:e.p=4,h=e.v,console.warn("Submit score failed:",h);case 5:return e.a(2)}},e,this,[[1,4]])})),function(e,t,a){return s.apply(this,arguments)})},{key:"updateLocalTop3",value:function(e,t,a){var s,i=this.getMineLabel(),n=null===(s=this.table)||void 0===s||null===(s=s[e])||void 0===s?void 0:s[t];if(n){var o=function(e,t){var a,s;return{pos:null!==(a=null==e?void 0:e.pos)&&void 0!==a?a:t,name:null!==(s=null==e?void 0:e.name)&&void 0!==s?s:"",rec:Number(null==e?void 0:e.rec)||0,isMe:!(null==e||!e.isMe)||(null==e?void 0:e.name)===i}},r=Number(a)||0;n[0]=n[0]||{pos:0,name:i,rec:0},n[0].name=i,n[0].rec=Math.max(Number(n[0].rec)||0,r);var l,h=[o(n[1],1),o(n[2],2),o(n[3],3)],d=h.findIndex(function(e){return e.isMe}),p=Math.max(r,Number(n[0].rec)||0);if(d>=0)h[d].name=i,h[d].isMe=!0,h[d].rec=Math.max(h[d].rec,p),h=h.sort(function(e,t){return t.rec-e.rec}).slice(0,3);else if(p>((null===(l=h[2])||void 0===l?void 0:l.rec)||0))h.push({pos:0,name:i,rec:p,isMe:!0}),h=h.sort(function(e,t){return t.rec-e.rec}).slice(0,3);else{var c,u=h.filter(function(e){return!e.isMe}).sort(function(e,t){return t.rec-e.rec});h=[u[0]||{pos:1,name:"",rec:0},u[1]||{pos:2,name:"",rec:0},{pos:(null===(c=n[3])||void 0===c?void 0:c.pos)||0,name:i,rec:p,isMe:!0}]}for(var m=1;m<=3;m++){var b=h[m-1]||{pos:m,name:"",rec:0};n[m]={pos:b.pos,name:b.name,rec:b.rec,isMe:!!b.isMe}}this.processDataAfterLoad()}}}]);var s,n,o,h,p,c,u,m}(),ot=function(){return d(function e(){l(this,e),this.plane={texture:null,material:null},this.planeGrass={texture:null,material:null},this.mks={texture:null,material:null},this.angryBirdModel,this.boostHatModel,this.boostHatPropeller,this.boostHatMesh},[{key:"loadTexture",value:(a=r(i().m(function e(){var t,a,n,o,r,l;return i().w(function(e){for(;;)switch(e.n){case 0:return t=new se,e.n=1,Promise.all([t.loadAsync("textures/plane.jpg"),t.loadAsync("textures/grass.jpg"),t.loadAsync("textures/mks.png")]);case 1:a=e.v,n=s(a,3),o=n[0],r=n[1],l=n[2],this.plane.texture=o,this.plane.material=new C({map:o,transparent:!0,opacity:1}),this.planeGrass.texture=r,this.planeGrass.material=new C({map:r}),this.mks.texture=l,this.mks.material=new y({map:l,transparent:!0,opacity:0});case 2:return e.a(2)}},e,this)})),function(){return a.apply(this,arguments)})},{key:"loadModels",value:(t=r(i().m(function e(){var t,a=this;return i().w(function(e){for(;;)switch(e.n){case 0:return t=new S,e.n=1,t.loadAsync("models/bird/bird.glb").then(function(e){var t=e.scene,s=e.animations;t.scale.x=2,t.scale.y=2,t.scale.z=2,t.position.y=0,t.rotation.y=-Math.PI/3,a.angryBirdModel=t,a.angryBirdModel.userData.mixer=new ce(a.angryBirdModel),a.angryBirdModel.userData.action=a.angryBirdModel.userData.mixer.clipAction(s[0]),a.angryBirdModel.userData.action.play(),a.angryBirdModel.userData.clock=new I,a.angryBirdModel.traverse(function(e){(e.isMesh||e.isSkinnedMesh)&&(e.castShadow=!1,e.receiveShadow=!1,e.geometry&&!e.geometry.boundingSphere&&e.geometry.computeBoundingSphere())});var i=a.angryBirdModel.children[0].children[0].material;i.emissive.set(16777215),i.emissiveIntensity=.1});case 1:return e.a(2)}},e)})),function(){return t.apply(this,arguments)})},{key:"loadBoostsModel",value:(e=r(i().m(function e(){var t,a=this;return i().w(function(e){for(;;)switch(e.n){case 0:return t=new S,e.n=1,t.loadAsync("models/boosts/hat.glb").then(function(e){var t=e.scene;a.boostHatModel=t,a.boostHatPropeller=a.boostHatModel.children[0].children[1],a.boostHatMesh=a.boostHatModel.children[0].children[0].children[0];var s=a.boostHatPropeller.children[0].material;s.emissive.set(16777215),s.emissiveIntensity=0,a.boostHatModel.rotation.x=Math.PI/17,a.boostHatModel.rotation.y=Math.PI/2,a.boostHatModel.position.y=2,a.boostHatModel.position.x=-40,a.boostHatModel.scale.x=.035,a.boostHatModel.scale.y=.035,a.boostHatModel.scale.z=.035,a.boostHatModel.userData.fly=!1,a.boostHatModel.userData.num=0});case 1:return e.a(2)}},e)})),function(){return e.apply(this,arguments)})}]);var e,t,a}();document.addEventListener("contextmenu",function(e){return e.preventDefault(),!1},{capture:!0}),document.addEventListener("selectstart",function(e){return e.preventDefault(),!1},{capture:!0}),document.addEventListener("dragstart",function(e){return e.preventDefault(),!1},{capture:!0}),document.addEventListener("touchstart",function(e){e.touches.length>1&&e.preventDefault()},{passive:!1}),document.addEventListener("touchstart",function(e){Ze=setTimeout(function(){e.preventDefault()},500)},{passive:!1}),document.addEventListener("touchend",function(){clearTimeout(Ze)}),document.addEventListener("touchmove",function(){clearTimeout(Ze)}),document.addEventListener("dblclick",function(e){return e.preventDefault(),!1},{capture:!0}),(navigator.userAgent.includes("YaBrowser")||navigator.userAgent.includes("Yandex"))&&document.addEventListener("touchstart",function(e){e.preventDefault()},{passive:!1});var rt,lt=new I,ht=null,dt=null,pt=null,ct=null,ut=null,mt=null,bt=null,gt=null,ft=null,yt=null,vt=!1,xt=!1,_t=new it,wt=new ue;wt.background=new L(13230580);var kt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.scene,a=e.maxParticles,s=void 0===a?800:a,i=e.gravity,n=void 0===i?-7.8:i,o=e.drag,r=void 0===o?2:o,l=e.texture,d=void 0===l?null:l,c=e.pointSize,g=void 0===c?.66:c,y=e.blending,v=void 0===y?m:y;if(!t)throw new Error("createSplashSystem: scene is required");var x=d||function(){var e=64,t=document.createElement("canvas");t.width=t.height=e;var a=t.getContext("2d"),s=a.createRadialGradient(32,32,0,32,32,32);s.addColorStop(0,"rgba(255,255,255,1)"),s.addColorStop(1,"rgba(255,255,255,0)"),a.fillStyle=s,a.fillRect(0,0,e,e);var i=new f(t);return i.anisotropy=1,i.needsUpdate=!0,i}(),_=new Float32Array(3*s),w=new Float32Array(3*s),k=new Float32Array(s),j=new Float32Array(s),P=new Float32Array(s),M=new Uint8Array(s),D=new h;D.setAttribute("position",new p(_,3)),D.setAttribute("aSize",new p(P,1));var C=new u({map:x,size:g,transparent:!0,depthWrite:!1,blending:v,vertexColors:!1,sizeAttenuation:!0}),S=new b(D,C);S.userData.persistent=!0,S.frustumCulled=!1,S.position.set(0,-20,0),t.add(S);var z=0;function L(){for(var e=0;e<s;e++){var t=(z+e)%s;if(!M[t])return z=(t+1)%s,t}return-1}function A(e,t,a,s,i){var n=3*t;e[n]=a,e[n+1]=s,e[n+2]=i}var E={trigger:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s=a.count,i=void 0===s?42:s,n=a.spread,o=void 0===n?.35:n,r=a.up,l=void 0===r?3:r,h=a.horiz,d=void 0===h?2.2:h,p=a.ttl,c=void 0===p?[.35,.8]:p,u=a.sizeJitter,m=void 0===u?.5:u,b=Math.max(1,Math.floor(i*t)),g=0;g<b;g++){var f=L();if(-1===f)break;var y=Math.sqrt(Math.random())*o,v=Math.random()*Math.PI*2,x=y*Math.cos(v),C=y*Math.sin(v),S=Math.sqrt(Math.random()),z=Math.cos(v)*d*S*(.6+.4*Math.random()),E=Math.sin(v)*d*S*(.6+.4*Math.random()),T=l*(.6+.4*Math.random()),B=c[0]+Math.random()*(c[1]-c[0]),H=1*(1-m/2+Math.random()*m);A(_,f,e.x+x,e.y,e.z+C),A(w,f,z*t,T*t,E*t),k[f]=B,j[f]=0,P[f]=H,M[f]=1}D.attributes.position.needsUpdate=!0,D.attributes.aSize.needsUpdate=!0},update:function(e){if(!(e<=0)){for(var t=n,a=Math.max(0,r),i=!1,o=0;o<s;o++)if(M[o])if(i=!0,j[o]+=e,j[o]>=k[o]){M[o]=0;var l=3*o;_[l]=1e9,_[l+1]=1e9,_[l+2]=1e9}else{var h=3*o;w[h+1]+=t*e;var d=w[h],p=w[h+1],c=w[h+2],u=Math.max(0,1-a*e);w[h]=d*u,w[h+1]=p*u,w[h+2]=c*u,_[h]+=w[h]*e,_[h+1]+=w[h+1]*e,_[h+2]+=w[h+2]*e}i&&(D.attributes.position.needsUpdate=!0);for(var m=0,b=0,f=0;f<s;f++)M[f]&&(m++,b+=1-j[f]/k[f]);var y=m?.25+b/m*.75:1;C.size=g*y}},get object3D(){return S},dispose:function(){t.remove(S),D.dispose(),C.dispose(),d||x.dispose()}};return E}({scene:wt}),jt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.scene,a=e.size,s=void 0===a?1.5:a,i=e.ttl,n=void 0===i?.9:i,o=new g(1,1),r=function(){var e=document.createElement("canvas");e.width=e.height=64;var t=e.getContext("2d");return t.clearRect(0,0,64,64),t.strokeStyle="rgba(255,255,255,0.9)",t.lineWidth=3,t.beginPath(),t.arc(32,32,20,0,2*Math.PI),t.stroke(),new f(e)}(),l=new y({map:r,transparent:!0,depthWrite:!1}),h=new v(o,l);h.visible=!1,h.userData.persistent=!0,t.add(h);var d=0,p=!1,c=new x;return{trigger:function(e){c.copy(e),d=0,p=!0,h.visible=!0},update:function(e,t){if(p){if((d+=e)>=n)return p=!1,void(h.visible=!1);h.position.set(c.x,c.y+.01,c.z),h.rotation.set(-Math.PI/2,0,0);var a=d/n,i=s*(1+1.6*a);h.scale.setScalar(i),l.opacity=1-a}},dispose:function(){t.remove(h),o.dispose(),l.dispose(),r.dispose()},mesh:h}}({scene:wt}),Pt=new me(25,window.innerWidth/window.innerHeight,.1,2e3);Pt.position.y=2;var Mt=O.degToRad(25),Dt=2*Math.atan(Math.tan(Mt/2)*(16/9)),Ct=function(){var e=window.matchMedia||window.msMatchMedia;return!!e&&e("(pointer:coarse)").matches}();function St(){return zt.apply(this,arguments)}function zt(){return(zt=r(i().m(function e(){var t,a;return i().w(function(e){for(;;)switch(e.p=e.n){case 0:if(!window.RAPIER){e.n=1;break}return e.a(2,window.RAPIER);case 1:return e.p=1,e.n=2,_e(function(){return o.import("./@dimforge-legacy-D3ziBopn.js")},0,o.meta.url);case 2:return t=e.v,e.a(2,t);case 3:if(e.p=3,a=e.v,console.warn("ÐÐµ ÑƒÐ´Ð°Ð»Ð¾ÑÑŒ Ð¸Ð¼Ð¿Ð¾Ñ€Ñ‚Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ @dimforge/rapier3d ÐºÐ°Ðº Ð¼Ð¾Ð´ÑƒÐ»ÑŒ",a),!window.RAPIER){e.n=4;break}return e.a(2,window.RAPIER);case 4:throw a;case 5:return e.a(2)}},e,null,[[1,3]])}))).apply(this,arguments)}function Lt(){var e,t=.01*((null===(e=window.visualViewport)||void 0===e?void 0:e.height)||window.innerHeight);document.documentElement.style.setProperty("--vh","".concat(t,"px"))}Lt(),window.addEventListener("resize",Lt),window.addEventListener("orientationchange",Lt),null===(n=window.visualViewport)||void 0===n||n.addEventListener("resize",Lt),new be;var At,Et=new ge({antialias:!1});function Tt(){var e=document.body.offsetWidth,t=document.body.offsetHeight,a=e/t,s=2*Math.atan(Math.tan(Dt/2)/a),i=O.degToRad(4),n=O.degToRad(90);s=O.clamp(s,i,n),Pt.fov=O.radToDeg(s),Pt.aspect=a,Pt.updateProjectionMatrix(),Et.setSize(e,t)}Et.setPixelRatio(Math.min(window.devicePixelRatio,1)),Et.setSize(window.innerWidth,window.innerHeight),document.body.appendChild(Et.domElement),Et.shadowMap.enabled=!0,Et.shadowMap.type=fe,Et.outputColorSpace=ye,Et.toneMapping=ve,Et.toneMappingExposure=1.05,window.addEventListener("resize",Tt),Tt();var Bt=document.querySelector(".loader_line");function Ht(){return Rt.apply(this,arguments)}function Rt(){return(Rt=r(i().m(function e(){return i().w(function(e){for(;;)switch(e.n){case 0:return pa(!0),ft=new nt,Ne(function(){return ft.refreshMineLabels()},At.environment.i18n.lang.toLowerCase()),yt=new ot,e.n=1,yt.loadModels();case 1:return e.n=2,yt.loadBoostsModel();case 2:return Bt.setAttribute("style","width:30%"),e.n=3,yt.loadTexture();case 3:return e.n=4,It();case 4:return Bt.setAttribute("style","width:30%"),ut=new Ke,e.n=5,ut.loadAudio();case 5:return Bt.setAttribute("style","width:60%"),e.n=6,ft.loadTableFromCloud();case 6:return e.n=7,ft.loadLeaderboardsTop3(At);case 7:return e.n=8,ft.loadLevels(0);case 8:return e.n=9,ft.loadLevelsContest();case 9:Bt.setAttribute("style","width:100%"),(ht=new et(Vt,_t,ut,ft)).init(),At.features.LoadingAPI.ready(),At.features.GameplayAPI.stop(),pa(!1),Bt.setAttribute("style","width:0%");case 10:return e.a(2)}},e)}))).apply(this,arguments)}function Ft(){return(Ft=r(i().m(function e(t){var a;return i().w(function(e){for(;;)switch(e.p=e.n){case 0:return At=t,window.ysdk=t,e.p=1,e.n=2,Ht();case 2:e.n=4;break;case 3:e.p=3,a=e.v,pa(!1),window.showInitError?window.showInitError(a):console.error("Init error",a);case 4:return e.a(2)}},e,null,[[1,3]])}))).apply(this,arguments)}function It(){return Nt.apply(this,arguments)}function Nt(){return(Nt=r(i().m(function e(){return i().w(function(e){for(;;)switch(e.n){case 0:["images/back-win.jpg","images/back-loose.jpg","images/back-dead.jpg","images/main.jpg"].forEach(function(e){var t=new Image;t.decoding="async",t.src=e});case 1:return e.a(2)}},e)}))).apply(this,arguments)}function Gt(e){return qt.apply(this,arguments)}function qt(){return(qt=r(i().m(function e(t){var a,s;return i().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,St();case 1:for(a=e.v,$e=new a.World(new a.Vector3(0,-9.81,0)),rt=new a.EventQueue(!0),pt=new We($e,a),gt=new at(Pt,ft),dt=new Xe(wt,Pt,Et,bt,Ct,ut),ct=new Ye(wt,ut,pt,Et,Pt,Ct,bt,dt,Vt,ft,_t,kt,jt,gt,ht,yt),s=0;s<t;s++)ct.players.push(new He(ft,wt,ut,ct,bt,Pt,_t,yt));(mt=new Je(ct,Ct,Et,Pt,bt,ut)).addKeyListeners();case 2:return e.a(2)}},e)}))).apply(this,arguments)}function Ut(){return Yt.apply(this,arguments)}function Yt(){return(Yt=r(i().m(function e(){return i().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,dt.loadWorld();case 1:ut.musicOn&&ut.backAudio.play(),ut.musicOn&&ut.oceanAudio.play();case 2:return e.a(2)}},e)}))).apply(this,arguments)}function Wt(e){return Ot.apply(this,arguments)}function Ot(){return(Ot=r(i().m(function e(t){return i().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,ct.createLevel(t);case 1:return e.n=2,ct.loadPlayers();case 2:return e.n=3,ct.loadEnvironments();case 3:ct.objs.grassPlanes.data.length>0&&ct.objs.grassPlanes.data.forEach(function(e,t){ct.objs.grassPlanes.data[t].userData.collide.setCollisionGroups(je([0],[1]))}),ct.players.length>0&&ct.players.forEach(function(e,t){ct.players[t].player.userData.collider.setCollisionGroups(je([1],[0,1]))});case 4:return e.a(2)}},e)}))).apply(this,arguments)}function Vt(e,t){return Kt.apply(this,arguments)}function Kt(){return Kt=r(i().m(function e(t,a){var s,n=arguments;return i().w(function(e){for(;;)switch(e.n){case 0:return s=n.length>2&&void 0!==n[2]&&n[2],Jt(),ht.toggleLoader(!0),bt=new tt,e.n=1,Gt(t);case 1:return Bt.setAttribute("style","width:30%"),ct.gameNum=a,e.n=2,Ut();case 2:return Bt.setAttribute("style","width:60%"),e.n=3,Wt(s);case 3:Bt.setAttribute("style","width:90%"),"hor"===bt.gameDir?gt.loadRecsToHud(0,ct.players.length-1):gt.loadRecsToHud(1,ct.players.length-1),bt.dataLoaded=!0,_t.gameStarting=!0,ft.gameInit=!0,Bt.setAttribute("style","width:100%"),setTimeout(function(){ht.toggleLoader(!1),Bt.setAttribute("style","width:0%")},1e3);case 4:return e.a(2)}},e)})),Kt.apply(this,arguments)}function Jt(){Pt.position.y=2,Pt.position.x=0,Et.toneMappingExposure=1.05,null!=mt&&mt.removedKeyListeners(),dt=null,pt=null,ct=null,mt=null,bt=null,gt=null}function Xt(e){if(_t.gameStarting&&document.querySelector(".menu_in_game").classList.contains("hidden_screen")&&bt.dataLoaded&&ct.showScreen("menu_in_game"),ft.gameInit&&_t.gameStarting&&!ct.levelsMode&&document.querySelector(".hud").classList.contains("hidden_screen")&&bt.dataLoaded?(ht.showScreen("hud"),ht.hideScreen("level_hud_wrap")):ft.gameInit||document.querySelector(".hud").classList.contains("hidden_screen")||(ht.hideScreen("hud"),ht.showScreen("level_hud_wrap")),ft.gameInit&&_t.gameStarting&&ct.levelsMode&&!document.querySelector(".player_panel_rec").classList.contains("hidden_screen")?document.querySelectorAll(".player_panel_rec").forEach(function(e,t,a){e.classList.add("hidden_screen")}):ft.gameInit&&_t.gameStarting&&!ct.levelsMode&&document.querySelector(".player_panel_rec").classList.contains("hidden_screen")&&document.querySelectorAll(".player_panel_rec").forEach(function(e,t,a){e.classList.remove("hidden_screen")}),_t.gameStarting?(kt.update(da),jt.update(da),vt||(At.features.GameplayAPI.start(),vt=!0,xt=!1)):xt||(At.features.GameplayAPI.stop(),xt=!0,vt=!1),bt.dataLoaded&&_t.gameStarting){ct.players.forEach(function(e,t,a){e.playerMove()}),dt.updateLighting(),ct.levelAnimate(Pt),ct.cameraMove(Pt,e);for(var t=0,a=pt.dynamicBodies.length;t<a;t++)pt.dynamicBodies[t][0].position.copy(pt.dynamicBodies[t][1].translation()),pt.dynamicBodies[t][0].quaternion.copy(pt.dynamicBodies[t][1].rotation());pt.updateInstancedTransforms(),$e.step(rt),_t.gameStarting&&Et.render(wt,Pt)}}var Qt,Zt,$t,ea,ta,aa,sa,ia,na,oa,ra,la,ha=0,da=1/60;function pa(e){var t=document.querySelector(".loader_screen");t&&(e?t.classList.remove("hidden_screen"):t.classList.add("hidden_screen"))}Et.setAnimationLoop(function(){if(null!=bt){var e=lt.getDelta();for(e>.1&&(e=.1),ha+=e;ha>=da;)Xt(da),ha-=da}}),document.addEventListener("visibilitychange",function(){ut&&("visible"===document.visibilityState?(_t.pause||_t.showGamePopup||(_t.gameStarting=!0,ut.togglePauseAll(!_t.gameStarting)),_t.visible=!0):(_t.pause||_t.showGamePopup?_t.pause||ut.togglePauseAll(!_t.gameStarting):(_t.gameStarting=!1,ut.togglePauseAll(!_t.gameStarting)),_t.visible=!1))}),document.querySelector(".autoriz_btn").addEventListener("click",r(i().m(function e(){return i().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,At.auth.openAuthDialog();case 1:e.n=3;break;case 2:e.p=2,e.v;case 3:return e.n=4,ft.initYandexPlayer({force:!0});case 4:return e.n=5,ft.loadTableFromCloud();case 5:return e.n=6,ft.loadLeaderboardsTop3(At);case 6:return e.a(2)}},e,null,[[0,2]])}))),document.querySelector(".pause_btn_wrap").addEventListener("click",function(){!_t.pause&&_t.gameStarting&&(_t.pause=!_t.pause,_t.pause&&(ct.showPopupInGame(),_t.gameStarting=!1,ut.togglePauseAll(!_t.gameStarting),ct.showScreen("popup_game_btn_close")))}),document.querySelector(".popup_game_btn_close").addEventListener("click",function(){(_t.pause||_t.gameStarting)&&(_t.pause=!_t.pause,_t.gameStarting=!0,ut.togglePauseAll(!_t.gameStarting),dt.rain&&!ut.rainAudio.isPlaying&&ut.rainAudio.play(),ut.oceanAudio.isPlaying||ut.oceanAudio.play(),ct.hideScreen("popup_in_game"),ct.hideScreen("popup_game_btn_close"))}),document.querySelector(".sound_btn_wrap").addEventListener("click",function(){var e=ut.isMuted();ut.toggleMute(!e),document.querySelector(".volume-icon__input").classList.toggle("volume_off")}),Qt=[".free_game_screen",".levels_game_screen",".levels_game_screen_contest",".main_screen"],Zt=null,$t=null,ea=null,ta=!1,aa=0,sa=0,ia=function(){var e=function(){for(var e=0,t=Qt;e<t.length;e++){var a=t[e],s=document.querySelector(a);if(s&&!s.classList.contains("hidden_screen"))return s}return null}();e!==Zt&&(Zt&&Zt.removeEventListener("scroll",na,{passive:!0}),ea&&(ea.removeEventListener("mousedown",oa),ea.removeEventListener("touchstart",oa)),$t=(Zt=e)?Zt.querySelector(".scroll-progress"):null,ea=$t?$t.querySelector(".scroll-progress__bar"):null,Zt&&Zt.addEventListener("scroll",na,{passive:!0}),ea&&(ea.addEventListener("mousedown",oa),ea.addEventListener("touchstart",oa)),na())},na=function(){if(Zt&&$t&&ea){var e=Zt.clientHeight,t=Zt.scrollHeight,a=Zt.scrollTop;if(t<=e+1)$t.classList.remove("visible");else{$t.classList.add("visible");var s=$t.getBoundingClientRect().height,i=Math.max(e/t*s,24),n=t-e,o=n>0?a/n*(s-i):0;ea.style.height="".concat(i,"px"),ea.style.top="".concat(o,"px")}}},oa=function(e){Zt&&ea&&(ta=!0,aa=e.touches?e.touches[0].clientY:e.clientY,sa=Zt.scrollTop,document.body.style.userSelect="none",e.preventDefault())},ra=function(e){if(ta&&Zt&&ea&&$t){var t=(e.touches?e.touches[0].clientY:e.clientY)-aa,a=$t.getBoundingClientRect().height,s=Zt.clientHeight,i=(Zt.scrollHeight-s)/Math.max(1,a-ea.offsetHeight);Zt.scrollTop=sa+t*i}},la=function(){ta=!1,document.body.style.userSelect=""},window.addEventListener("resize",function(){ia(),na()}),window.addEventListener("mousemove",ra,{passive:!1}),window.addEventListener("touchmove",ra,{passive:!1}),window.addEventListener("mouseup",la),window.addEventListener("touchend",la),new MutationObserver(function(){ia()}).observe(document.body,{attributes:!0,subtree:!0,attributeFilter:["class"]}),ia();var ca=document.querySelector(".popup_in_game_wrap");if(ca){var ua=0;ca.addEventListener("touchstart",function(e){e.touches&&0!==e.touches.length&&(ua=e.touches[0].clientY,ca.scrollTop)},{passive:!0}),ca.addEventListener("touchmove",function(e){if(e.touches&&0!==e.touches.length)if(ca.scrollHeight>ca.clientHeight){var t=e.touches[0].clientY-ua,a=ca.scrollTop<=0,s=ca.scrollTop+ca.clientHeight>=ca.scrollHeight-1;(a&&t>0||s&&t<0)&&e.preventDefault()}else e.preventDefault()},{passive:!1})}var ma=document.querySelector(".popup_in_game");ma&&ma.addEventListener("touchmove",function(e){e.target.closest(".popup_in_game_wrap")||e.preventDefault()},{passive:!1});var ba=document.querySelector(".loader_screen");ba&&ba.addEventListener("touchmove",function(e){e.preventDefault()},{passive:!1}),function(){function e(e){var t=document.body||document.documentElement;if(t){var a=document.getElementById("debug-error-overlay");a||((a=document.createElement("div")).id="debug-error-overlay",a.className="debug_error_overlay",t.appendChild(a)),a.textContent=e}}window.showInitError=function(t){var a="Init error";t&&(t.message?a+=": "+t.message:a+=": "+String(t)),"loading"===document.readyState?document.addEventListener("DOMContentLoaded",function(){e(a)},{once:!0}):e(a)},window.addEventListener("error",function(e){if(e){var t=[];e.message&&t.push(e.message),e.filename&&t.push("at "+e.filename+":"+e.lineno+":"+e.colno),e.error&&e.error.stack&&t.push(e.error.stack),window.showInitError(t.join("\n"))}}),window.addEventListener("unhandledrejection",function(e){if(e){var t=e.reason||"unhandledrejection";t.stack?window.showInitError(t.stack):window.showInitError(String(t))}}),window.initSDK=function(){"undefined"!=typeof YaGames?YaGames.init().then(function(e){window.ysdk=e,function(e){Ft.apply(this,arguments)}(e)}).catch(function(e){window.showInitError(e)}):window.showInitError("YaGames is not defined")},"complete"===document.readyState?window.initSDK():window.addEventListener("load",function(){window.initSDK()})}()}}})}();
